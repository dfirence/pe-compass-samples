{"pe_name":"mstsc.exe","pe_type":523,"pe_size":1543680,"pe_subsystem":2,"pe_subsystem_caption":"The Windows Graphical User Interface (GUI) Subsystem","pe_path":"pe-samples/lolbas/mstsc.exe","pe_timedate_stamp":3930433737,"pe_timedate_human":"2094-07-20T03:08:57.000Z","ImageDLLImports":[{"name":"advapi32.dll","imports":42,"functions":["CreateWellKnownSid","CredDeleteW","CredFree","CredGetSessionTypes","CredIsMarshaledCredentialW","CredReadDomainCredentialsW","CredReadW","CredUnmarshalCredentialW","CredWriteDomainCredentialsW","CredWriteW","CryptAcquireContextW","CryptGenRandom","CryptReleaseContext","EventActivityIdControl","EventRegister","EventSetInformation","EventUnregister","EventWriteTransfer","GetTraceEnableFlags","GetTraceEnableLevel","GetTraceLoggerHandle","IsTextUnicode","OpenProcessToken","RegCloseKey","RegCreateKeyExW","RegCreateKeyTransactedW","RegDeleteKeyValueW","RegDeleteTreeW","RegDeleteValueW","RegEnumKeyExW","RegEnumValueW","RegGetValueW","RegOpenKeyExA","RegOpenKeyExW","RegQueryInfoKeyW","RegQueryValueExA","RegQueryValueExW","RegSetValueExW","RegisterTraceGuidsW","SystemFunction036","TraceMessage","UnregisterTraceGuids"]},{"name":"kernel32.dll","imports":152,"functions":["CancelThreadpoolIo","CancelWaitableTimer","CloseHandle","CloseThreadpool","CloseThreadpoolCleanupGroup","CloseThreadpoolCleanupGroupMembers","CloseThreadpoolIo","CloseThreadpoolTimer","CloseThreadpoolWork","CompareStringEx","CompareStringOrdinal","CompareStringW","CreateDirectoryW","CreateEventW","CreateFileMappingW","CreateFileW","CreateMutexExW","CreateProcessW","CreateSemaphoreExW","CreateSemaphoreW","CreateThread","CreateThreadpool","CreateThreadpoolCleanupGroup","CreateThreadpoolIo","CreateThreadpoolTimer","CreateThreadpoolWork","CreateTimerQueueTimer","CreateWaitableTimerExW","DebugBreak","DelayLoadFailureHook","DeleteCriticalSection","DeleteFileW","DisconnectNamedPipe","EnterCriticalSection","ExpandEnvironmentStringsA","ExpandEnvironmentStringsW","FindClose","FindFirstFileW","FindNextFileW","FindResourceExW","FindResourceW","FormatMessageW","FreeLibrary","FreeLibraryAndExitThread","GetACP","GetCommandLineW","GetComputerNameW","GetCurrentDirectoryW","GetCurrentProcess","GetCurrentProcessId","GetCurrentThreadId","GetDateFormatW","GetExitCodeThread","GetFileAttributesExW","GetFileAttributesW","GetFileSize","GetFullPathNameW","GetLastError","GetLocalTime","GetLocaleInfoW","GetModuleFileNameA","GetModuleFileNameW","GetModuleHandleExA","GetModuleHandleExW","GetModuleHandleW","GetOverlappedResult","GetProcAddress","GetProcessHeap","GetProcessId","GetStartupInfoA","GetStartupInfoW","GetSystemDefaultUILanguage","GetSystemDirectoryW","GetSystemInfo","GetSystemTime","GetSystemTimeAsFileTime","GetTempPathW","GetTickCount","GetTickCount64","GetTimeFormatW","GetUserDefaultUILanguage","GetVersionExA","GetVersionExW","GlobalFree","HeapAlloc","HeapFree","HeapSetInformation","InitializeCriticalSection","InitializeCriticalSectionAndSpinCount","IsDebuggerPresent","LCMapStringEx","LeaveCriticalSection","LoadLibraryA","LoadLibraryExA","LoadLibraryExW","LoadLibraryW","LoadResource","LocalAlloc","LocalFree","LockResource","MapViewOfFile","MulDiv","MultiByteToWideChar","OpenSemaphoreW","OpenThread","OutputDebugStringA","OutputDebugStringW","ProcessIdToSessionId","QueryPerformanceCounter","QueryPerformanceFrequency","QueueUserWorkItem","RaiseException","ReadFile","ReleaseMutex","ReleaseSemaphore","RemoveDirectoryW","ResetEvent","ResolveDelayLoadedAPI","SearchPathW","SetEvent","SetFilePointer","SetLastError","SetThreadpoolThreadMaximum","SetThreadpoolThreadMinimum","SetThreadpoolTimer","SetUnhandledExceptionFilter","SetWaitableTimer","SizeofResource","Sleep","StartThreadpoolIo","SubmitThreadpoolWork","SwitchToThread","SystemTimeToFileTime","TerminateProcess","TerminateThread","TlsAlloc","TlsFree","TlsGetValue","TlsSetValue","TrySubmitThreadpoolCallback","UnhandledExceptionFilter","UnmapViewOfFile","VerSetConditionMask","VerifyVersionInfoW","WaitForMultipleObjects","WaitForSingleObject","WaitForSingleObjectEx","WaitForThreadpoolIoCallbacks","WideCharToMultiByte","WriteFile","lstrcmpW","lstrcmpiW"]},{"name":"gdi32.dll","imports":31,"functions":["BitBlt","CombineRgn","CreateCompatibleBitmap","CreateCompatibleDC","CreateDCW","CreateFontIndirectW","CreatePalette","CreateRectRgn","CreateRectRgnIndirect","CreateSolidBrush","DeleteDC","DeleteObject","EqualRgn","FillRgn","GetDIBColorTable","GetDeviceCaps","GetObjectW","GetRgnBox","GetStockObject","OffsetRgn","PatBlt","RealizePalette","SelectObject","SelectPalette","SetBkMode","SetMapMode","SetRectRgn","SetTextColor","StretchBlt","TranslateCharsetInfo","UpdateColors"]},{"name":"user32.dll","imports":124,"functions":["AdjustWindowRectEx","AllowSetForegroundWindow","AppendMenuW","BeginPaint","CharLowerW","CharNextW","CharUpperW","CheckDlgButton","CheckMenuItem","CheckRadioButton","CopyRect","CreateDialogIndirectParamW","CreateDialogParamW","CreateMenu","CreateWindowExW","DefDlgProcW","DefWindowProcW","DeleteMenu","DestroyIcon","DestroyWindow","DialogBoxParamW","DispatchMessageW","DrawIcon","DrawIconEx","DrawTextW","EnableMenuItem","EnableWindow","EndDialog","EndPaint","EnumDisplayDevicesW","EnumDisplayMonitors","EnumDisplaySettingsExW","EqualRect","FillRect","GetClassInfoExW","GetClassInfoW","GetClientRect","GetCursorPos","GetDC","GetDesktopWindow","GetDlgItem","GetDlgItemTextW","GetFocus","GetKeyboardLayout","GetMenu","GetMenuItemCount","GetMenuItemInfoW","GetMessageW","GetMonitorInfoW","GetSystemMenu","GetSystemMetrics","GetTitleBarInfo","GetWindow","GetWindowDC","GetWindowLongPtrW","GetWindowLongW","GetWindowPlacement","GetWindowRect","InsertMenuItemW","InsertMenuW","IntersectRect","InvalidateRect","IsChild","IsDialogMessageW","IsDlgButtonChecked","IsIconic","IsRectEmpty","IsWindow","IsWindowEnabled","IsWindowVisible","IsZoomed","KillTimer","LoadAcceleratorsW","LoadCursorW","LoadIconW","LoadImageW","LoadStringW","LockWindowUpdate","MapDialogRect","MapWindowPoints","MessageBoxW","ModifyMenuW","MonitorFromWindow","MoveWindow","MsgWaitForMultipleObjectsEx","OffsetRect","PeekMessageW","PostMessageW","PostQuitMessage","PostThreadMessageW","PtInRect","RedrawWindow","RegisterClassExW","RegisterClassW","RegisterWindowMessageW","ReleaseDC","ScreenToClient","SendDlgItemMessageW","SendInput","SendMessageW","SetCursor","SetDlgItemTextW","SetFocus","SetForegroundWindow","SetMenuItemInfoW","SetProcessDPIAware","SetRect","SetTimer","SetWindowLongPtrW","SetWindowLongW","SetWindowPlacement","SetWindowPos","SetWindowRgn","SetWindowTextW","ShowWindow","ShowWindowAsync","SubtractRect","SystemParametersInfoA","SystemParametersInfoW","TranslateAcceleratorW","TranslateMessage","UnregisterClassA","UnregisterClassW","UpdateWindow"]},{"name":"msvcrt.dll","imports":70,"functions":["??0exception@@QEAA@AEBV0@@Z","??0exception@@QEAA@XZ","??1exception@@UEAA@XZ","??1type_info@@UEAA@XZ","?terminate@@YAXXZ","_CxxThrowException","_XcptFilter","__C_specific_handler","__CxxFrameHandler3","__dllonexit","__getmainargs","__set_app_type","__setusermatherr","_acmdln","_amsg_exit","_callnewh","_cexit","_commode","_errno","_exit","_fmode","_initterm","_ismbblead","_itow_s","_lock","_ltow_s","_onexit","_purecall","_unlock","_vsnprintf","_vsnprintf_s","_vsnwprintf","_wcsicmp","_wcslwr","_wcsnicmp","_wtoi","_wtol","bsearch","exit","free","iswdigit","iswspace","malloc","memcmp","memcpy","memcpy_s","memmove","memset","pow","realloc","swscanf_s","toupper","towlower","towupper","wcscat_s","wcschr","wcscmp","wcscpy_s","wcscspn","wcsncat_s","wcsncmp","wcsncpy_s","wcsnlen","wcsrchr","wcsstr","wcstok","wcstok_s","wcstol","wcstombs_s","wcstoul"]},{"name":"ole32.dll","imports":17,"functions":["CLSIDFromString","CoCreateGuid","CoCreateInstance","CoInitialize","CoInitializeEx","CoRegisterClassObject","CoRevokeClassObject","CoTaskMemAlloc","CoTaskMemFree","CoTaskMemRealloc","CoUninitialize","CreateItemMoniker","GetRunningObjectTable","IIDFromString","OleInitialize","OleUninitialize","StringFromGUID2"]},{"name":"oleaut32.dll","imports":0,"functions":[]},{"name":"shell32.dll","imports":8,"functions":["SHAddToRecentDocs","SHFileOperationW","SHGetDesktopFolder","SHGetFileInfoW","SHGetMalloc","SHGetPathFromIDListW","SHGetSpecialFolderLocation","ShellExecuteExW"]},{"name":"comctl32.dll","imports":6,"functions":["ImageList_Create","ImageList_Destroy","ImageList_GetImageCount","ImageList_LoadImageW","ImageList_ReplaceIcon","InitCommonControlsEx"]},{"name":"comdlg32.dll","imports":3,"functions":["GetFileTitleW","GetOpenFileNameW","GetSaveFileNameW"]},{"name":"shlwapi.dll","imports":10,"functions":["PathAppendW","PathCanonicalizeW","PathFindExtensionW","PathFindFileNameW","PathRemoveFileSpecW","PathStripPathW","SHStrDupW","StrStrIW","UrlCombineW","UrlCreateFromPathW"]},{"name":"crypt32.dll","imports":20,"functions":["CertCloseStore","CertDuplicateCertificateChain","CertDuplicateCertificateContext","CertFindExtension","CertFreeCertificateChain","CertFreeCertificateContext","CertGetCertificateChain","CertGetCertificateContextProperty","CertOpenStore","CertVerifyCertificateChainPolicy","CryptBinaryToStringW","CryptDecodeObject","CryptMsgClose","CryptMsgOpenToDecode","CryptMsgUpdate","CryptProtectData","CryptSignMessage","CryptStringToBinaryW","CryptUnprotectData","CryptVerifyDetachedMessageSignature"]},{"name":"winhttp.dll","imports":18,"functions":["WinHttpAddRequestHeaders","WinHttpCloseHandle","WinHttpConnect","WinHttpCrackUrl","WinHttpCreateUrl","WinHttpGetIEProxyConfigForCurrentUser","WinHttpGetProxyForUrl","WinHttpOpen","WinHttpOpenRequest","WinHttpQueryDataAvailable","WinHttpQueryHeaders","WinHttpQueryOption","WinHttpReadData","WinHttpReceiveResponse","WinHttpSendRequest","WinHttpSetOption","WinHttpSetStatusCallback","WinHttpSetTimeouts"]},{"name":"credui.dll","imports":4,"functions":["CredPackAuthenticationBufferW","CredUIParseUserNameW","CredUIPromptForWindowsCredentialsW","CredUnPackAuthenticationBufferW"]},{"name":"secur32.dll","imports":6,"functions":["FreeContextBuffer","GetUserNameExW","LsaConnectUntrusted","LsaDeregisterLogonProcess","LsaLookupAuthenticationPackage","QuerySecurityPackageInfoW"]},{"name":"cryptui.dll","imports":1,"functions":["CryptUIDlgViewCertificateW"]},{"name":"ntdll.dll","imports":5,"functions":["RtlCaptureContext","RtlInitString","RtlLookupFunctionEntry","RtlNtStatusToDosError","RtlVirtualUnwind"]},{"name":"cfgmgr32.dll","imports":4,"functions":["CM_Get_Child","CM_Get_DevNode_Registry_PropertyW","CM_Get_Parent","CM_Get_Sibling"]},{"name":"wininet.dll","imports":7,"functions":["HttpOpenRequestW","HttpSendRequestExW","InternetCloseHandle","InternetConnectW","InternetCrackUrlW","InternetOpenW","InternetSetStatusCallbackW"]},{"name":"version.dll","imports":3,"functions":["GetFileVersionInfoSizeW","GetFileVersionInfoW","VerQueryValueW"]},{"name":"ws2_32.dll","imports":12,"functions":["FreeAddrInfoExW","FreeAddrInfoW","GetAddrInfoExW","GetAddrInfoW","GetNameInfoW","WSAAddressToStringW","WSAEventSelect","WSAIoctl","WSARecv","WSASend","WSASocketW","WSAStringToAddressW"]},{"name":"rpcrt4.dll","imports":7,"functions":["I_RpcExceptionFilter","NdrClientCall3","RpcBindingFree","RpcBindingFromStringBindingW","RpcBindingSetAuthInfoExW","RpcStringBindingComposeW","RpcStringFreeW"]},{"name":"netapi32.dll","imports":2,"functions":["NetApiBufferFree","NetGetJoinInformation"]},{"name":"winmm.dll","imports":3,"functions":["timeGetTime","timeKillEvent","timeSetEvent"]},{"name":"ktmw32.dll","imports":2,"functions":["CommitTransaction","CreateTransaction"]},{"name":"iphlpapi.dll","imports":3,"functions":["CreateSortedAddressPairs","FreeMibTable","GetAdaptersAddresses"]}],"ImageDLLExports":{"exports":0,"functions":[]},"ImageHashSignatures":{"sha2":"bf45fe2983c4e089b6bb2de88cf25218465a0343f491e580beb1021d6e41670e","ssdeep":"24576:t1h+4DCd1MiEvi6wMUQ5/qOHTTinTysuJb3Ov2nh7uRXXGIGdcI1Sdp1v302TKGg:nh+4DCnMiEvi6wM5dqOHP0TY93Ov2nhW"},"scan":{"intentions":16,"uniq_apis_matched":1,"results":[{"intent":"Implements Features For User CLI Experience","tag":"Expert Input:IBO.0001 - Accepts CommandLine Arguments","inputs":3,"matches":1,"apis":["__getmainargs"]},{"intent":"Discover Network Settings On The Target System","tag":"Discovery:T1016 - System Network Configuration Discovery","inputs":41,"matches":1,"apis":["GetAdaptersAddresses"]},{"intent":"Implement Features To Communicate via NamedPipes","tag":"Expert Input:IBO.0004 - Implement Named Pipes","inputs":12,"matches":1,"apis":["DisconnectNamedPipe"]},{"intent":"Query And Discover Windows Registry Configuration Settings","tag":"Discovery:T1012 - Query Registry","inputs":11,"matches":4,"apis":["RegGetValueW","RegQueryInfoKeyW","RegQueryValueExA","RegQueryValueExW"]},{"intent":"Implements Features To Work With The TCP Network Protocol","tag":"Expert Input:IBO.00012 - Network TCP Sockets","inputs":11,"matches":1,"apis":["FreeAddrInfoExW"]},{"intent":"Implements Delayed Loads of DLL Resources","tag":"Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime","inputs":2,"matches":2,"apis":["DelayLoadFailureHook","ResolveDelayLoadedAPI"]},{"intent":"Implements Features To Enumerate The Windows Registry","tag":"Expert Input:IBO.0009 - Enumerate The Windows Registry","inputs":6,"matches":2,"apis":["RegEnumKeyExW","RegEnumValueW"]},{"intent":"Implements Features To Execute or Spawn New Processes On The Target System","tag":"Expert Input:IBO.0002 - Spawn New Process","inputs":7,"matches":2,"apis":["CreateProcessw","ShellExecuteExW"]},{"intent":"Implements Features To Transmit/Receive Data Over The Network","tag":"Expert Input:IBO.00011 - Network Socket Send/Receive","inputs":16,"matches":2,"apis":["WSARecv","WSASend"]},{"intent":"Manipulate Windows Tokens","tag":"Defense Evasion:T1134 - Access Token Manipulation","inputs":10,"matches":1,"apis":["OpenProcessToken"]},{"intent":"Implements Features To Create/Manipulate The Windows Registry","tag":"Expert Input:IBO.0008 - Create/Manipulate The Windows Registry","inputs":33,"matches":6,"apis":["RegCreateKeyExW","RegCreateKeyTransactedW","RegDeleteValueW","RegOpenKeyExA","RegOpenKeyExW","RegSetValueExW"]},{"intent":"Implements Features To Conduct DNS Queries","tag":"Expert Input:IBO.00014 - Network Layer-7 DNS Usage","inputs":31,"matches":3,"apis":["GetAddrInfoExW","GetAddrInfoW","GetNameInfoW"]},{"intent":"Initiate Network Connections Over HTTP, HTTPS To Download Content On The Target System","tag":"Command And Control:T1105 - Ingress Tool Transfer","inputs":21,"matches":8,"apis":["HttpOpenRequestW","HttpSendRequestExW","InternetConnectW","InternetCrackUrlW","WinHttpConnect","WinHttpGetProxyForUrl","WinHttpOpenRequest","WinHttpSendRequest"]},{"intent":"Implements Features To Discover Network Proxy Configuration","tag":"Expert Input:IBO.00015 - Network Layer-7 HTTP","inputs":2,"matches":1,"apis":["WinHttpGetIEProxyConfigForCurrentUser"]},{"intent":"Enumerate Files or Directories on the Target System","tag":"Discovery:T1083 - File and Directory Discovery","inputs":5,"matches":1,"apis":["FindFirstFileW"]},{"intent":"Delete Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity","tag":"Defense Evasion:T1070.004 - File Deletion","inputs":2,"matches":1,"apis":["DeleteFileW"]}]}}