{
  "name": "af0e455f640b621c50d5c11efc3c8649691a9a661fa1bcf658aae48c007ff3c4",
  "path": "/Users/dfirence/Documents/my_code/r5-weapons/weapons/master_dump_from_eset/af0e455f640b621c50d5c11efc3c8649691a9a661fa1bcf658aae48c007ff3c4",
  "size": 276480,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 2,
  "subsystem_caption": "The Windows Graphical User Interface (GUI) Subsystem",
  "libs": [
    "advapi32.dll",
    "kernel32.dll",
    "msvcrt.dll",
    "netapi32.dll",
    "ntdll.dll",
    "psapi.dll"
  ],
  "imports": [
    {
      "lib": "advapi32.dll",
      "count": 25,
      "functions": [
        "AddAccessAllowedAce",
        "AdjustTokenPrivileges",
        "ConvertSidToStringSidA",
        "ConvertStringSecurityDescriptorToSecurityDescriptorA",
        "CreateProcessAsUserA",
        "CryptAcquireContextA",
        "CryptGenRandom",
        "DuplicateTokenEx",
        "ImpersonateNamedPipeClient",
        "InitializeAcl",
        "LogonUserA",
        "LookupAccountNameA",
        "LookupPrivilegeValueA",
        "MakeAbsoluteSD",
        "OpenProcessToken",
        "OpenThreadToken",
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegOpenKeyExA",
        "RegQueryValueExA",
        "RegQueryValueExW",
        "RegSetValueExA",
        "RegSetValueExW",
        "RevertToSelf",
        "SetFileSecurityA"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 89,
      "functions": [
        "CallNamedPipeA",
        "CancelIo",
        "CloseHandle",
        "ConnectNamedPipe",
        "CopyFileA",
        "CreateDirectoryA",
        "CreateEventA",
        "CreateFileA",
        "CreateFileMappingA",
        "CreateFileW",
        "CreateMutexA",
        "CreateNamedPipeA",
        "CreateRemoteThread",
        "CreateSemaphoreA",
        "CreateToolhelp32Snapshot",
        "DeleteCriticalSection",
        "DeleteFileA",
        "EnterCriticalSection",
        "FindClose",
        "FindFirstFileA",
        "FindNextFileA",
        "FlushFileBuffers",
        "FormatMessageA",
        "FreeLibrary",
        "GetComputerNameA",
        "GetCurrentProcess",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "GetDiskFreeSpaceExA",
        "GetEnvironmentVariableA",
        "GetExitCodeThread",
        "GetFileSize",
        "GetLastError",
        "GetLocalTime",
        "GetModuleHandleA",
        "GetOverlappedResult",
        "GetPrivateProfileSectionA",
        "GetPrivateProfileStringA",
        "GetProcAddress",
        "GetProcessHeap",
        "GetTempFileNameA",
        "GetTempPathA",
        "GetTickCount",
        "GetVersionExA",
        "HeapAlloc",
        "HeapDestroy",
        "HeapFree",
        "InitializeCriticalSection",
        "LeaveCriticalSection",
        "LoadLibraryA",
        "LocalFree",
        "MapViewOfFile",
        "Module32FirstW",
        "Module32NextW",
        "MoveFileA",
        "MoveFileExA",
        "MultiByteToWideChar",
        "OpenProcess",
        "PeekNamedPipe",
        "Process32First",
        "Process32Next",
        "ReadFile",
        "ReleaseMutex",
        "ReleaseSemaphore",
        "SetEvent",
        "SetFilePointer",
        "SetHandleInformation",
        "SetLastError",
        "SetNamedPipeHandleState",
        "Sleep",
        "TerminateProcess",
        "TerminateThread",
        "TransactNamedPipe",
        "TryEnterCriticalSection",
        "UnmapViewOfFile",
        "VirtualAllocEx",
        "WaitForMultipleObjects",
        "WaitForMultipleObjectsEx",
        "WaitForSingleObject",
        "WaitNamedPipeA",
        "WriteFile",
        "WritePrivateProfileStringA",
        "WriteProcessMemory",
        "lstrcatA",
        "lstrcmpiA",
        "lstrcmpiW",
        "lstrcpyW",
        "lstrlenA",
        "lstrlenW"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 32,
      "functions": [
        "__iob_func",
        "_beginthreadex",
        "_close",
        "_endthreadex",
        "_errno",
        "_filelength",
        "_initterm",
        "_localtime64",
        "_lrotl",
        "_read",
        "_strdup",
        "_time64",
        "_tzset",
        "_vscprintf",
        "_wopen",
        "exit",
        "fclose",
        "ferror",
        "fflush",
        "fopen",
        "fprintf",
        "fread",
        "free",
        "fseek",
        "ftell",
        "fwrite",
        "malloc",
        "rand",
        "rewind",
        "strtok",
        "vfprintf",
        "wcstok"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 56,
      "functions": [
        "RtlInitUnicodeString",
        "RtlNtStatusToDosError",
        "RtlQueryRegistryValues",
        "VerSetConditionMask",
        "ZwAllocateVirtualMemory",
        "ZwClose",
        "ZwCreateFile",
        "ZwCreateSection",
        "ZwFreeVirtualMemory",
        "ZwMapViewOfSection",
        "ZwOpenThread",
        "ZwQueryInformationProcess",
        "ZwQueryInformationThread",
        "ZwQuerySystemInformation",
        "ZwReadVirtualMemory",
        "ZwTerminateThread",
        "ZwUnmapViewOfSection",
        "ZwWaitForSingleObject",
        "__C_specific_handler",
        "__chkstk",
        "_itoa",
        "_memicmp",
        "_strcmpi",
        "_stricmp",
        "_strlwr",
        "_ultoa",
        "_vsnprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "abs",
        "atoi",
        "mbstowcs",
        "memcmp",
        "memcpy",
        "memset",
        "qsort",
        "sprintf",
        "strchr",
        "strcmp",
        "strcpy",
        "strlen",
        "strncat",
        "strncmp",
        "strncpy",
        "strpbrk",
        "strrchr",
        "strstr",
        "strtoul",
        "toupper",
        "wcscat",
        "wcschr",
        "wcscpy",
        "wcslen",
        "wcsncat",
        "wcsncpy",
        "wcsrchr"
      ]
    },
    {
      "lib": "netapi32.dll",
      "count": 2,
      "functions": [
        "NetApiBufferFree",
        "NetGetDCName"
      ]
    },
    {
      "lib": "psapi.dll",
      "count": 2,
      "functions": [
        "EnumProcesses",
        "GetModuleBaseNameA"
      ]
    }
  ],
  "exports": {
    "count": 2,
    "functions": [
      "ModStart",
      "ModStop"
    ]
  },
  "hashes": {
    "sha2": "af0e455f640b621c50d5c11efc3c8649691a9a661fa1bcf658aae48c007ff3c4",
    "ssdeep": "3072:RHbVrwqYQI0DZDCJycWgvPLTgTww3uREgYWt3eRoU19f3bUMUjWjFT:RKqYQfCJyc9vPLbwCUWAoM9vUj"
  },
  "intent": {
    "intentions": 11,
    "uniq_apis_matched": 24,
    "results": [
      {
        "intent": "Enumerates Running Processes/Applications",
        "tag": "Discovery:T1057 - Process Discovery",
        "component": "Processes",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "CreateToolHelp32Snapshot",
          "EnumProcesses"
        ]
      },
      {
        "intent": "Can Execute or Spawn New Processes On The Target System As Another User Identity",
        "tag": "Expert Input:IBO.0003 - Spawn New Process As Different User",
        "component": "Processes",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "CreateProcessAsUserA"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 2,
        "apis": [
          "RegQueryValueExA",
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Can Manipulate Access Control Mechanisms",
        "tag": "Expert Input:IBO.00021 - Windows Access Control Lists",
        "component": "Privileges",
        "inputs": 15,
        "matches": 2,
        "apis": [
          "AddAccessAllowedAce",
          "InitializeAcl"
        ]
      },
      {
        "intent": "Can Communicate via NamedPipes",
        "tag": "Expert Input:IBO.0004 - Implement Named Pipes",
        "component": "Processes",
        "inputs": 13,
        "matches": 7,
        "apis": [
          "CallNamedPipeA",
          "ConnectNamedPipe",
          "CreateNamedPipeA",
          "ImpersonateNamedPipeClient",
          "PeekNamedPipe",
          "SetNamedPipeHandleState",
          "TransactNamedPipe"
        ]
      },
      {
        "intent": "Can Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      },
      {
        "intent": "Can Delete Files From Filesystem (Disk)",
        "tag": "Expert Input:IBO.00034 - File Deletion",
        "component": "Filesystem",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DeleteFileA"
        ]
      },
      {
        "intent": "Can Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 4,
        "apis": [
          "RegCreateKeyExW",
          "RegOpenKeyExA",
          "RegSetValueExA",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "AdjustTokenPrivileges"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileA"
        ]
      },
      {
        "intent": "Discovers Configuration Attributes of the Windows Enterprise Domain",
        "tag": "Reconnaissance:T1590.001 - Domain Properties (Windows Enterprise)",
        "component": "---",
        "inputs": 24,
        "matches": 1,
        "apis": [
          "NetGetDCName"
        ]
      }
    ]
  }
}