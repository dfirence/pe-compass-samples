{"pe_name":"nltest.exe","pe_type":523,"pe_size":545280,"pe_subsystem":3,"pe_subsystem_caption":"The Windows Character (Console UI) Subsystem","pe_path":"pe-samples/lolbas/nltest.exe","pe_timedate_stamp":3249072771,"pe_timedate_human":"2072-12-16T00:12:51.000Z","ImageDLLImports":[{"name":"msvcrt.dll","imports":35,"functions":["?terminate@@YAXXZ","_XcptFilter","__C_specific_handler","__getmainargs","__iob_func","__set_app_type","__setusermatherr","_amsg_exit","_cexit","_commode","_exit","_fmode","_initterm","_stricmp","_strnicmp","_vsnprintf","_vsnwprintf","_wsetlocale","exit","fprintf","fwprintf","iswctype","memcpy","memset","printf","qsort","sprintf_s","strcat_s","strchr","strcpy_s","strncpy_s","strtol","strtoul","wcscat_s","wcscpy_s"]},{"name":"ntdsapi.dll","imports":4,"functions":["DsBindW","DsFreeDomainControllerInfoW","DsGetDomainControllerInfoW","DsUnBindW"]},{"name":"logoncli.dll","imports":22,"functions":["DsAddressToSiteNamesExA","DsDeregisterDnsHostRecordsA","DsEnumerateDomainTrustsA","DsGetDcCloseW","DsGetDcNameA","DsGetDcNameW","DsGetDcNameWithAccountW","DsGetDcNextA","DsGetDcOpenA","DsGetDcSiteCoverageA","DsGetForestTrustInformationW","DsGetSiteNameA","I_NetGetDCList","I_NetLogonControl","I_NetLogonControl2","I_NetlogonComputeClientDigest","I_NetlogonComputeClientSignature","I_NetlogonComputeServerDigest","I_NetlogonComputeServerSignature","I_NetlogonGetTrustRid","NetGetDCName","NetLogonGetTimeServiceParentDomain"]},{"name":"rpcrt4.dll","imports":5,"functions":["RpcStringFreeA","RpcStringFreeW","UuidFromStringA","UuidToStringA","UuidToStringW"]},{"name":"ws2_32.dll","imports":4,"functions":["WSAAddressToStringA","WSAStringToAddressA","freeaddrinfo","getaddrinfo"]},{"name":"ntdll.dll","imports":17,"functions":["RtlAllocateHeap","RtlAnsiStringToUnicodeString","RtlCaptureContext","RtlCompareUnicodeString","RtlConvertSidToUnicodeString","RtlFreeHeap","RtlFreeUnicodeString","RtlInitAnsiString","RtlInitString","RtlInitUnicodeString","RtlLengthSid","RtlLookupFunctionEntry","RtlOemStringToUnicodeString","RtlSystemTimeToLocalTime","RtlTimeToTimeFields","RtlVirtualUnwind","RtlxAnsiStringToUnicodeSize"]},{"name":"netutils.dll","imports":3,"functions":["NetApiBufferAllocate","NetApiBufferFree","NetpwNameCompare"]},{"name":"kernel32.dll","imports":43,"functions":["CloseHandle","CreateEventW","CreateFileW","CreateMailslotA","CreateThread","DeleteCriticalSection","EnterCriticalSection","FreeLibrary","GetComputerNameW","GetConsoleOutputCP","GetCurrentProcess","GetCurrentProcessId","GetCurrentThreadId","GetLastError","GetLocalTime","GetModuleHandleW","GetOverlappedResult","GetProcAddress","GetProcessHeap","GetStdHandle","GetSystemTimeAsFileTime","GetTickCount","HeapAlloc","HeapFree","InitializeCriticalSection","LeaveCriticalSection","LoadLibraryExW","LocalAlloc","LocalFree","MultiByteToWideChar","QueryPerformanceCounter","ReadFile","SetEvent","SetMailslotInfo","SetThreadUILanguage","SetUnhandledExceptionFilter","Sleep","TerminateProcess","UnhandledExceptionFilter","WaitForMultipleObjects","WaitForSingleObject","WideCharToMultiByte","WriteFile"]},{"name":"advapi32.dll","imports":27,"functions":["AbortSystemShutdownW","AllocateAndInitializeSid","CryptAcquireContextA","CryptAcquireContextW","CryptGenRandom","CryptReleaseContext","EqualSid","FreeSid","GetAce","GetAclInformation","GetSecurityDescriptorDacl","InitiateSystemShutdownExW","LsaClose","LsaFreeMemory","LsaOpenPolicy","LsaQueryForestTrustInformation","RegCloseKey","RegConnectRegistryW","RegGetKeySecurity","RegOpenKeyExA","RegQueryValueExA","RegQueryValueExW","RegSetKeySecurity","RegSetValueExA","SystemFunction025","SystemFunction027","TraceMessage"]},{"name":"user32.dll","imports":1,"functions":["LoadStringW"]}],"ImageDLLExports":{"exports":0,"functions":[]},"ImageHashSignatures":{"sha2":"cd3ed960ca8f0920e2d875a2327d4150c670f815f7a260da4585708b254760db","ssdeep":"6144:/6G55EdAuMT8hYxjpOtUoieJnHe0+pQQz5JndBXlqg:S7ycYxjpVQZKQwdBI"},"scan":{"intentions":10,"uniq_apis_matched":1,"results":[{"intent":"Enumerate Available Windows Domain Trusts","tag":"Discovery:T1482 - Domain Trust Discovery","inputs":6,"matches":2,"apis":["DsEnumerateDomainTrustsA","DsGetForestTrustInformationW"]},{"intent":"Conduct System Reboots Resulting In Loss of Attack Evidence Present in System Memory","tag":"Impact:T1529 - System Shutdown/Reboot","inputs":6,"matches":1,"apis":["InitiateSystemShutdownExW"]},{"intent":"Discover Configuration Attributes/Descriptions of the Windows Enterprise Domain","tag":"Reconnaissance/T1590.001 - Domain Properties (Windows Enterprise)","inputs":20,"matches":6,"apis":["DsAddressToSiteNamesExA","DsGetDcNameA","DsGetDcNameW","DsGetDcNextA","DsGetDomainControllerInfoW","DsGetSiteNameA"]},{"intent":"Implements Features To Create/Manipulate The Windows Registry","tag":"Expert Input:IBO.0008 - Create/Manipulate The Windows Registry","inputs":33,"matches":2,"apis":["RegOpenKeyExA","RegSetValueExA"]},{"intent":"Implements Features To Conduct DNS Queries","tag":"Expert Input:IBO.00014 - Network Layer-7 DNS Usage","inputs":31,"matches":1,"apis":["getaddrinfo"]},{"intent":"Implements Features To Work With The TCP Network Protocol","tag":"Expert Input:IBO.00012 - Network TCP Sockets","inputs":11,"matches":1,"apis":["freeaddrinfo"]},{"intent":"Query And Discover Windows Registry Configuration Settings","tag":"Discovery:T1012 - Query Registry","inputs":11,"matches":2,"apis":["RegQueryValueExA","RegQueryValueExW"]},{"intent":"Implements Features For User CLI Experience","tag":"Expert Input:IBO.0001 - Accepts CommandLine Arguments","inputs":3,"matches":1,"apis":["__getmainargs"]},{"intent":"Implements Features To Remotely Connect To A Target System And Access Its Windows Registry","tag":"Expert Input:IBO.00010 - Connect To Remote Windows Registry","inputs":2,"matches":1,"apis":["RegConnectRegistryW"]},{"intent":"Implements Features To Communicate via MailSlots","tag":"Expert Input:IBO.0005 - Implement MailSlots","inputs":2,"matches":1,"apis":["CreateMailslotA"]}]}}