{
  "name": "poqexec.exe",
  "path": "\\\\?\\C:\\Windows\\WinSxS\\x86_microsoft-windows-servicingstack_31bf3856ad364e35_10.0.19041.1310_none_21f7509cc42a62cf\\poqexec.exe",
  "size": 391168,
  "type": "win-pe",
  "is_64": false,
  "is_lib": false,
  "is_dotnet": true,
  "has_imports": true,
  "has_exports": false,
  "subsystem": 1,
  "subsystem_caption": "Device Drivers And Native Windows processes",
  "libs": [
    "ntdll.dll"
  ],
  "imports": [
    {
      "lib": "ntdll.dll",
      "count": 142,
      "functions": [
        "DbgPrint",
        "DbgPrintEx",
        "LdrGetDllHandle",
        "LdrGetProcedureAddress",
        "LdrLoadDll",
        "LdrUnloadDll",
        "NtAdjustPrivilegesToken",
        "NtClose",
        "NtCommitTransaction",
        "NtCreateEvent",
        "NtCreateFile",
        "NtCreateIoCompletion",
        "NtCreateKey",
        "NtCreateKeyTransacted",
        "NtCreateTransaction",
        "NtDelayExecution",
        "NtDeleteFile",
        "NtDeleteKey",
        "NtDeleteValueKey",
        "NtDisplayString",
        "NtDrawText",
        "NtDuplicateObject",
        "NtDuplicateToken",
        "NtEnumerateKey",
        "NtEnumerateValueKey",
        "NtFlushBuffersFile",
        "NtFlushKey",
        "NtFsControlFile",
        "NtLoadKey",
        "NtOpenFile",
        "NtOpenKey",
        "NtOpenKeyEx",
        "NtOpenKeyTransactedEx",
        "NtOpenProcess",
        "NtOpenProcessToken",
        "NtOpenThreadToken",
        "NtQueryAttributesFile",
        "NtQueryDirectoryFile",
        "NtQueryInformationFile",
        "NtQueryInformationProcess",
        "NtQueryInformationToken",
        "NtQueryKey",
        "NtQueryObject",
        "NtQueryPerformanceCounter",
        "NtQuerySecurityObject",
        "NtQuerySystemInformation",
        "NtQuerySystemTime",
        "NtQueryValueKey",
        "NtQueryVolumeInformationFile",
        "NtReadFile",
        "NtRemoveIoCompletion",
        "NtRollbackTransaction",
        "NtSetCachedSigningLevel",
        "NtSetEvent",
        "NtSetInformationFile",
        "NtSetInformationThread",
        "NtSetIoCompletion",
        "NtSetSecurityObject",
        "NtSetValueKey",
        "NtShutdownSystem",
        "NtTerminateProcess",
        "NtUnloadKey",
        "NtWaitForMultipleObjects",
        "NtWriteFile",
        "NtYieldExecution",
        "RtlAddAccessAllowedAceEx",
        "RtlAddAce",
        "RtlAllocateHeap",
        "RtlCaptureContext",
        "RtlConvertSidToUnicodeString",
        "RtlCopySid",
        "RtlCopyUnicodeString",
        "RtlCreateAcl",
        "RtlCreateEnvironmentEx",
        "RtlCreateSecurityDescriptor",
        "RtlCreateUnicodeStringFromAsciiz",
        "RtlDeleteCriticalSection",
        "RtlDeleteSecurityObject",
        "RtlDestroyEnvironment",
        "RtlDosPathNameToNtPathName_U",
        "RtlDowncaseUnicodeChar",
        "RtlDuplicateUnicodeString",
        "RtlEnterCriticalSection",
        "RtlEqualUnicodeString",
        "RtlExpandEnvironmentStrings_U",
        "RtlFindAceByType",
        "RtlFindMessage",
        "RtlFormatMessage",
        "RtlFreeHeap",
        "RtlFreeUnicodeString",
        "RtlGetAce",
        "RtlGetControlSecurityDescriptor",
        "RtlGetCurrentTransaction",
        "RtlGetDaclSecurityDescriptor",
        "RtlGetGroupSecurityDescriptor",
        "RtlGetLengthWithoutLastFullDosOrNtPathElement",
        "RtlGetOwnerSecurityDescriptor",
        "RtlGetSaclSecurityDescriptor",
        "RtlInitUnicodeString",
        "RtlInitializeCriticalSection",
        "RtlLeaveCriticalSection",
        "RtlLengthSecurityDescriptor",
        "RtlLengthSid",
        "RtlMakeSelfRelativeSD",
        "RtlNewSecurityObjectEx",
        "RtlNormalizeProcessParams",
        "RtlNtStatusToDosError",
        "RtlQueryEnvironmentVariable_U",
        "RtlQueryInformationAcl",
        "RtlRaiseStatus",
        "RtlReAllocateHeap",
        "RtlSetCurrentTransaction",
        "RtlSetDaclSecurityDescriptor",
        "RtlSetGroupSecurityDescriptor",
        "RtlSetHeapInformation",
        "RtlSetOwnerSecurityDescriptor",
        "RtlSetSaclSecurityDescriptor",
        "RtlSetSystemBootStatus",
        "RtlTimeToTimeFields",
        "RtlUnhandledExceptionFilter",
        "RtlUpcaseUnicodeChar",
        "RtlValidAcl",
        "RtlValidSid",
        "RtlpApplyLengthFunction",
        "TpSimpleTryPost",
        "_alldiv",
        "_allshl",
        "_aulldiv",
        "_aullrem",
        "_aullshr",
        "_snprintf_s",
        "_wcstoui64",
        "iswspace",
        "memcmp",
        "memcpy",
        "memcpy_s",
        "memmove",
        "memset",
        "sprintf_s",
        "strncmp",
        "wcscpy_s",
        "wcstoul"
      ]
    }
  ],
  "hashes": {
    "sha2": "38dd837216199f9b58a55b52f6d96b7eb8602036acb2fe888988e69cf1e8a033",
    "ssdeep": "6144:AW5uKmKkeyy33PInY24RQHMt/N+MP7ikF4e1a9ZpHBufqnPCOjvCa4aOnUWkQokT:AW5seyy339WsJN+MP7ikD1c3BufqnPCl"
  },
  "intent": {
    "intentions": 2,
    "uniq_apis_matched": 2,
    "results": [
      {
        "intent": "Steals Tokens To Impersonate Windows Identities",
        "tag": "Privilege Escalation:T1134.001 - Token Impersonation/Theft",
        "component": "Privileges",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "NtDuplicateToken"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "NtAdjustPrivilegesToken"
        ]
      }
    ]
  }
}