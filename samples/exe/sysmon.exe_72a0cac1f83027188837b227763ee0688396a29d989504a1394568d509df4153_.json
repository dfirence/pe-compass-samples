{
  "name": "sysmon.exe",
  "path": "\\\\?\\C:\\Windows\\Sysmon.exe",
  "size": 3801488,
  "is_64": true,
  "is_lib": false,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": false,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "advapi32.dll",
    "comdlg32.dll",
    "crypt32.dll",
    "gdi32.dll",
    "kernel32.dll",
    "mpr.dll",
    "netapi32.dll",
    "ole32.dll",
    "oleaut32.dll",
    "rpcrt4.dll",
    "secur32.dll",
    "tdh.dll",
    "user32.dll",
    "userenv.dll",
    "version.dll",
    "ws2_32.dll",
    "wtsapi32.dll"
  ],
  "imports": [
    {
      "lib": "kernel32.dll",
      "count": 179,
      "functions": [
        "AcquireSRWLockExclusive",
        "AcquireSRWLockShared",
        "CloseHandle",
        "CompareStringW",
        "ConnectNamedPipe",
        "CopyFileW",
        "CreateDirectoryW",
        "CreateEventW",
        "CreateFileMappingW",
        "CreateFileW",
        "CreateMutexW",
        "CreateProcessW",
        "CreateThread",
        "CreateToolhelp32Snapshot",
        "DecodePointer",
        "DeleteCriticalSection",
        "DeleteFileW",
        "DeviceIoControl",
        "DuplicateHandle",
        "EncodePointer",
        "EnterCriticalSection",
        "EnumSystemLocalesW",
        "ExitProcess",
        "ExitThread",
        "ExpandEnvironmentStringsW",
        "FileTimeToSystemTime",
        "FindClose",
        "FindFirstFileExA",
        "FindFirstFileExW",
        "FindFirstFileW",
        "FindNextFileA",
        "FindNextFileW",
        "FindResourceW",
        "FlushFileBuffers",
        "FormatMessageW",
        "FreeConsole",
        "FreeEnvironmentStringsW",
        "FreeLibrary",
        "FreeLibraryAndExitThread",
        "GetACP",
        "GetCPInfo",
        "GetCommandLineA",
        "GetCommandLineW",
        "GetComputerNameW",
        "GetConsoleCP",
        "GetConsoleMode",
        "GetConsoleScreenBufferInfo",
        "GetCurrentDirectoryW",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "GetDateFormatW",
        "GetDriveTypeW",
        "GetEnvironmentStringsW",
        "GetExitCodeProcess",
        "GetFileAttributesW",
        "GetFileSizeEx",
        "GetFileType",
        "GetFullPathNameA",
        "GetFullPathNameW",
        "GetLastError",
        "GetLocaleInfoW",
        "GetLogicalDriveStringsW",
        "GetModuleFileNameA",
        "GetModuleFileNameW",
        "GetModuleHandleExW",
        "GetModuleHandleW",
        "GetNumberOfConsoleInputEvents",
        "GetOEMCP",
        "GetOverlappedResult",
        "GetProcAddress",
        "GetProcessHeap",
        "GetStartupInfoW",
        "GetStdHandle",
        "GetStringTypeW",
        "GetSystemDirectoryW",
        "GetSystemInfo",
        "GetSystemTime",
        "GetSystemTimeAsFileTime",
        "GetTempFileNameW",
        "GetTempPathW",
        "GetTickCount",
        "GetTimeFormatW",
        "GetTimeZoneInformation",
        "GetUserDefaultLCID",
        "GetVersion",
        "GetVersionExW",
        "GetWindowsDirectoryW",
        "GlobalLock",
        "GlobalSize",
        "GlobalUnlock",
        "HeapAlloc",
        "HeapFree",
        "HeapReAlloc",
        "HeapSize",
        "InitializeCriticalSection",
        "InitializeCriticalSectionAndSpinCount",
        "InitializeSListHead",
        "InitializeSRWLock",
        "InterlockedFlushSList",
        "InterlockedPushEntrySList",
        "IsDebuggerPresent",
        "IsProcessorFeaturePresent",
        "IsValidCodePage",
        "IsValidLocale",
        "K32EnumProcesses",
        "K32GetMappedFileNameW",
        "K32GetModuleBaseNameW",
        "LCMapStringW",
        "LeaveCriticalSection",
        "LoadLibraryExW",
        "LoadLibraryW",
        "LoadResource",
        "LocalAlloc",
        "LocalFree",
        "LockResource",
        "MapViewOfFile",
        "Module32FirstW",
        "MultiByteToWideChar",
        "OpenProcess",
        "OutputDebugStringA",
        "OutputDebugStringW",
        "PeekConsoleInputA",
        "PeekNamedPipe",
        "Process32FirstW",
        "Process32NextW",
        "ProcessIdToSessionId",
        "QueryDosDeviceW",
        "QueryPerformanceCounter",
        "QueryPerformanceFrequency",
        "RaiseException",
        "ReadConsoleInputA",
        "ReadConsoleW",
        "ReadFile",
        "ReleaseMutex",
        "ReleaseSRWLockExclusive",
        "ReleaseSRWLockShared",
        "RemoveDirectoryW",
        "ResetEvent",
        "ResumeThread",
        "RtlCaptureContext",
        "RtlLookupFunctionEntry",
        "RtlPcToFileHeader",
        "RtlUnwind",
        "RtlUnwindEx",
        "RtlVirtualUnwind",
        "SetConsoleCtrlHandler",
        "SetConsoleMode",
        "SetCurrentDirectoryW",
        "SetEndOfFile",
        "SetEnvironmentVariableA",
        "SetEnvironmentVariableW",
        "SetEvent",
        "SetFileAttributesW",
        "SetFilePointerEx",
        "SetLastError",
        "SetStdHandle",
        "SetThreadPriority",
        "SetUnhandledExceptionFilter",
        "SizeofResource",
        "Sleep",
        "SwitchToThread",
        "SystemTimeToFileTime",
        "SystemTimeToTzSpecificLocalTime",
        "TerminateProcess",
        "TlsAlloc",
        "TlsFree",
        "TlsGetValue",
        "TlsSetValue",
        "UnhandledExceptionFilter",
        "UnmapViewOfFile",
        "WaitForMultipleObjects",
        "WaitForSingleObject",
        "WaitForSingleObjectEx",
        "WideCharToMultiByte",
        "WriteConsoleW",
        "WriteFile",
        "lstrlenW"
      ]
    },
    {
      "lib": "advapi32.dll",
      "count": 62,
      "functions": [
        "AdjustTokenPrivileges",
        "AllocateAndInitializeSid",
        "ChangeServiceConfig2W",
        "CloseServiceHandle",
        "CloseTrace",
        "ControlService",
        "ControlTraceW",
        "ConvertSidToStringSidW",
        "ConvertStringSecurityDescriptorToSecurityDescriptorW",
        "CopySid",
        "CreateProcessAsUserW",
        "CreateServiceW",
        "CryptAcquireContextW",
        "CryptGenRandom",
        "CryptReleaseContext",
        "DeleteService",
        "DeregisterEventSource",
        "DuplicateTokenEx",
        "EnableTraceEx2",
        "EqualSid",
        "FreeSid",
        "GetLengthSid",
        "GetSecurityDescriptorLength",
        "GetSidSubAuthority",
        "GetSidSubAuthorityCount",
        "GetTokenInformation",
        "ImpersonateLoggedOnUser",
        "InitializeSecurityDescriptor",
        "LogonUserW",
        "LookupAccountNameW",
        "LookupAccountSidW",
        "LookupPrivilegeValueW",
        "OpenProcessToken",
        "OpenSCManagerW",
        "OpenServiceW",
        "OpenTraceW",
        "ProcessTrace",
        "QueryServiceConfigW",
        "QueryServiceStatus",
        "RegCloseKey",
        "RegConnectRegistryW",
        "RegCreateKeyExW",
        "RegCreateKeyW",
        "RegDeleteKeyW",
        "RegDeleteValueW",
        "RegGetValueW",
        "RegNotifyChangeKeyValue",
        "RegOpenKeyExW",
        "RegOpenKeyW",
        "RegQueryValueExW",
        "RegSetValueExW",
        "RegisterEventSourceW",
        "RegisterServiceCtrlHandlerExW",
        "ReportEventW",
        "RevertToSelf",
        "SetEntriesInAclW",
        "SetFileSecurityW",
        "SetSecurityDescriptorDacl",
        "SetServiceStatus",
        "StartServiceCtrlDispatcherW",
        "StartServiceW",
        "StartTraceW"
      ]
    },
    {
      "lib": "rpcrt4.dll",
      "count": 9,
      "functions": [
        "I_RpcBindingInqLocalClientPID",
        "NdrClientCall2",
        "NdrServerCall2",
        "RpcBindingFromStringBindingW",
        "RpcServerRegisterIfEx",
        "RpcServerUnregisterIf",
        "RpcServerUseProtseqEpW",
        "RpcStringBindingComposeW",
        "RpcStringFreeW"
      ]
    },
    {
      "lib": "comdlg32.dll",
      "count": 1,
      "functions": [
        "PrintDlgW"
      ]
    },
    {
      "lib": "gdi32.dll",
      "count": 6,
      "functions": [
        "EndDoc",
        "EndPage",
        "GetDeviceCaps",
        "SetMapMode",
        "StartDocW",
        "StartPage"
      ]
    },
    {
      "lib": "netapi32.dll",
      "count": 2,
      "functions": [
        "NetApiBufferFree",
        "NetServerEnum"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 18,
      "functions": [
        "ORDINAL 12",
        "ORDINAL 149",
        "ORDINAL 150",
        "ORDINAL 16",
        "ORDINAL 19",
        "ORDINAL 2",
        "ORDINAL 20",
        "ORDINAL 200",
        "ORDINAL 201",
        "ORDINAL 202",
        "ORDINAL 23",
        "ORDINAL 24",
        "ORDINAL 25",
        "ORDINAL 4",
        "ORDINAL 6",
        "ORDINAL 7",
        "ORDINAL 8",
        "ORDINAL 9"
      ]
    },
    {
      "lib": "userenv.dll",
      "count": 1,
      "functions": [
        "ExpandEnvironmentStringsForUserW"
      ]
    },
    {
      "lib": "mpr.dll",
      "count": 2,
      "functions": [
        "WNetAddConnection2W",
        "WNetCancelConnection2W"
      ]
    },
    {
      "lib": "ws2_32.dll",
      "count": 7,
      "functions": [
        "ORDINAL 115",
        "ORDINAL 12",
        "ORDINAL 15",
        "ORDINAL 52",
        "ORDINAL 57",
        "ORDINAL 9",
        "getnameinfo"
      ]
    },
    {
      "lib": "crypt32.dll",
      "count": 4,
      "functions": [
        "CertDuplicateCertificateContext",
        "CertGetCertificateChain",
        "CertGetNameStringW",
        "CryptFindOIDInfo"
      ]
    },
    {
      "lib": "wtsapi32.dll",
      "count": 4,
      "functions": [
        "WTSEnumerateSessionsW",
        "WTSFreeMemory",
        "WTSQuerySessionInformationW",
        "WTSQueryUserToken"
      ]
    },
    {
      "lib": "ole32.dll",
      "count": 7,
      "functions": [
        "CoCreateInstance",
        "CoInitializeEx",
        "CoInitializeSecurity",
        "CoSetProxyBlanket",
        "CoUninitialize",
        "IIDFromString",
        "StringFromGUID2"
      ]
    },
    {
      "lib": "tdh.dll",
      "count": 2,
      "functions": [
        "TdhGetEventInformation",
        "TdhGetEventMapInformation"
      ]
    },
    {
      "lib": "secur32.dll",
      "count": 2,
      "functions": [
        "LsaFreeReturnBuffer",
        "LsaGetLogonSessionData"
      ]
    },
    {
      "lib": "version.dll",
      "count": 5,
      "functions": [
        "GetFileVersionInfoExW",
        "GetFileVersionInfoSizeExW",
        "GetFileVersionInfoSizeW",
        "GetFileVersionInfoW",
        "VerQueryValueW"
      ]
    },
    {
      "lib": "user32.dll",
      "count": 26,
      "functions": [
        "ChangeClipboardChain",
        "CloseClipboard",
        "CreateWindowExW",
        "DefWindowProcW",
        "DialogBoxIndirectParamW",
        "DispatchMessageW",
        "EndDialog",
        "GetClipboardData",
        "GetClipboardOwner",
        "GetClipboardSequenceNumber",
        "GetDlgItem",
        "GetMessageW",
        "GetPriorityClipboardFormat",
        "GetSysColorBrush",
        "GetWindowThreadProcessId",
        "InflateRect",
        "LoadCursorW",
        "MessageBoxW",
        "OpenClipboard",
        "RegisterClassW",
        "SendMessageW",
        "SetClipboardViewer",
        "SetCursor",
        "SetWindowTextW",
        "TranslateMessage",
        "UnregisterClassW"
      ]
    }
  ],
  "hashes": {
    "sha2": "72a0cac1f83027188837b227763ee0688396a29d989504a1394568d509df4153",
    "ssdeep": "49152:y1enVP1ZHbB/Um1nJqGy0hX8VO4R0u++Ji3EtqeYXyUGTg1:9tZH5UYU613ExU"
  },
  "intent": {
    "intentions": 18,
    "uniq_apis_matched": 40,
    "results": [
      {
        "intent": "Enumerates Running Processes/Applications",
        "tag": "Discovery:T1057 - Process Discovery",
        "component": "Processes",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "CreateToolHelp32Snapshot"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 7,
        "apis": [
          "RegCreateKeyExW",
          "RegCreateKeyW",
          "RegDeleteKeyW",
          "RegDeleteValueW",
          "RegOpenKeyExW",
          "RegOpenKeyW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "AdjustTokenPrivileges"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate System Services",
        "tag": "Expert Input:IBO.0007 - Create/Manipulate System Services",
        "component": "Services",
        "inputs": 19,
        "matches": 8,
        "apis": [
          "CloseServiceHandle",
          "ControlService",
          "CreateServiceW",
          "DeleteService",
          "RegisterServiceCtrlHandlerExW",
          "SetServiceStatus",
          "StartServiceCtrlDispatcherW",
          "StartServiceW"
        ]
      },
      {
        "intent": "Has Ability To Execute or Spawn New Processes On The Target System As Another User Identity",
        "tag": "Expert Input:IBO.0003 - Spawn New Process As Different User",
        "component": "Processes",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "CreateProcessAsUserW"
        ]
      },
      {
        "intent": "Has Ability To Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "OpenProcessToken"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 2,
        "apis": [
          "RegGetValueW",
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Has Ability To Manipulate Access Control Mechanisms",
        "tag": "Expert Input:IBO.00021 - Windows Access Control Lists",
        "component": "Privileges",
        "inputs": 15,
        "matches": 1,
        "apis": [
          "SetSecurityDescriptorDacl"
        ]
      },
      {
        "intent": "Collects information through the Clipboard Buffers From Desktop Environment",
        "tag": "Collection:T1115 - Clipboard Data",
        "component": "---",
        "inputs": 4,
        "matches": 3,
        "apis": [
          "GetClipboardData",
          "GetClipboardSequenceNumber",
          "OpenClipboard"
        ]
      },
      {
        "intent": "Discovers Time Configuration Settings On The Target System",
        "tag": "Discovery:T1124 - System Time Discovery",
        "component": "---",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "GetTimeZoneInformation"
        ]
      },
      {
        "intent": "Deletes Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity",
        "tag": "Defense Evasion:T1070.004 - File Deletion",
        "component": "Filesystem",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DeleteFileW"
        ]
      },
      {
        "intent": "Has Ability To Enumerate/Discover System Services And Their Configuration Data",
        "tag": "Expert Input:IBO.0006 - Enumerate System Services",
        "component": "Services",
        "inputs": 28,
        "matches": 4,
        "apis": [
          "OpenSCManagerW",
          "OpenServiceW",
          "QueryServiceConfigW",
          "QueryServiceStatus"
        ]
      },
      {
        "intent": "Has Ability To Execute or Spawn New Processes On The Target System",
        "tag": "Expert Input:IBO.0002 - Spawn New Process",
        "component": "Processes",
        "inputs": 7,
        "matches": 1,
        "apis": [
          "CreateProcessw"
        ]
      },
      {
        "intent": "Has Ability To Conduct DNS Queries",
        "tag": "Expert Input:IBO.00014 - Network Layer-7 DNS Usage",
        "component": "Networking",
        "inputs": 31,
        "matches": 1,
        "apis": [
          "getnameinfo"
        ]
      },
      {
        "intent": "Steals Tokens To Impersonate Windows Identities",
        "tag": "Privilege Escalation:T1134.001 - Token Impersonation/Theft",
        "component": "Privileges",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "ImpersonateLoggedOnUser"
        ]
      },
      {
        "intent": "Has Ability To Communicate via NamedPipes",
        "tag": "Expert Input:IBO.0004 - Implement Named Pipes",
        "component": "Processes",
        "inputs": 13,
        "matches": 2,
        "apis": [
          "ConnectNamedPipe",
          "PeekNamedPipe"
        ]
      },
      {
        "intent": "Has Ability To Remotely Connect To A Target System And Access Its Windows Registry",
        "tag": "Expert Input:IBO.00010 - Connect To Remote Windows Registry",
        "component": "Networking",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "RegConnectRegistryW"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 3,
        "apis": [
          "FindFirstFileExA",
          "FindFirstFileExW",
          "FindFirstFileW"
        ]
      }
    ]
  }
}