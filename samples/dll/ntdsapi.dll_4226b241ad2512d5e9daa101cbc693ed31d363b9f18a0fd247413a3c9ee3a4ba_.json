{
  "name": "ntdsapi.dll",
  "path": "\\\\?\\C:\\Windows\\System32\\ntdsapi.dll",
  "size": 154112,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "api-ms-win-core-delayload-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-1.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-kernel32-legacy-l1-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-localization-l1-2-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-rtlsupport-l1-1-0.dll",
    "api-ms-win-core-string-l1-1-0.dll",
    "api-ms-win-core-synch-l1-1-0.dll",
    "api-ms-win-core-synch-l1-2-0.dll",
    "api-ms-win-core-synch-l1-2-1.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-security-activedirectoryclient-l1-1-0.dll",
    "api-ms-win-security-activedirectoryclient-l1-1-1.dll",
    "msvcrt.dll",
    "ntdll.dll",
    "rpcrt4.dll",
    "ws2_32.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-core-delayload-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    },
    {
      "lib": "api-ms-win-core-string-l1-1-0.dll",
      "count": 3,
      "functions": [
        "CompareStringW",
        "MultiByteToWideChar",
        "WideCharToMultiByte"
      ]
    },
    {
      "lib": "api-ms-win-security-activedirectoryclient-l1-1-0.dll",
      "count": 8,
      "functions": [
        "DsBindWithSpnExW",
        "DsCrackNamesW",
        "DsFreeDomainControllerInfoW",
        "DsFreeNameResultW",
        "DsFreePasswordCredentials",
        "DsGetDomainControllerInfoW",
        "DsMakePasswordCredentialsW",
        "DsUnBindW"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-1.dll",
      "count": 1,
      "functions": [
        "WaitForMultipleObjects"
      ]
    },
    {
      "lib": "ws2_32.dll",
      "count": 8,
      "functions": [
        "FreeAddrInfoW",
        "GetAddrInfoW",
        "GetNameInfoW",
        "ORDINAL 115",
        "ORDINAL 15",
        "WSALookupServiceBeginW",
        "WSALookupServiceEnd",
        "WSALookupServiceNextW"
      ]
    },
    {
      "lib": "api-ms-win-core-rtlsupport-l1-1-0.dll",
      "count": 3,
      "functions": [
        "RtlCaptureContext",
        "RtlLookupFunctionEntry",
        "RtlVirtualUnwind"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "TerminateProcess"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 25,
      "functions": [
        "_XcptFilter",
        "__C_specific_handler",
        "_amsg_exit",
        "_beginthreadex",
        "_endthreadex",
        "_initterm",
        "_itow",
        "_vsnprintf",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "free",
        "iswdigit",
        "iswxdigit",
        "malloc",
        "memchr",
        "memcpy",
        "memset",
        "strncmp",
        "towlower",
        "wcschr",
        "wcsncmp",
        "wcsstr",
        "wcstol",
        "wcstoul"
      ]
    },
    {
      "lib": "rpcrt4.dll",
      "count": 21,
      "functions": [
        "I_RpcExceptionFilter",
        "I_RpcGetExtendedError",
        "NDRCContextBinding",
        "Ndr64AsyncClientCall",
        "NdrClientCall3",
        "RpcBindingFree",
        "RpcBindingFromStringBindingW",
        "RpcBindingInqAuthInfoA",
        "RpcBindingSetAuthInfoExW",
        "RpcBindingSetOption",
        "RpcBindingToStringBindingW",
        "RpcEpResolveBinding",
        "RpcIfInqId",
        "RpcMgmtEpEltInqBegin",
        "RpcMgmtEpEltInqDone",
        "RpcMgmtEpEltInqNextW",
        "RpcSsDestroyClientContext",
        "RpcSsGetContextBinding",
        "RpcStringBindingComposeW",
        "RpcStringBindingParseW",
        "RpcStringFreeW"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 1,
      "functions": [
        "CloseHandle"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetComputerNameExW",
        "GetSystemTimeAsFileTime",
        "GetTickCount"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l1-1-0.dll",
      "count": 4,
      "functions": [
        "HeapAlloc",
        "HeapCreate",
        "HeapDestroy",
        "HeapFree"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-0.dll",
      "count": 2,
      "functions": [
        "InitOnceExecuteOnce",
        "Sleep"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 6,
      "functions": [
        "DbgPrint",
        "RtlIpv4AddressToStringExW",
        "RtlIpv4StringToAddressExW",
        "RtlIpv6AddressToStringExW",
        "RtlIpv6StringToAddressExW",
        "RtlNtStatusToDosError"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 2,
      "functions": [
        "DisableThreadLibraryCalls",
        "GetModuleHandleExW"
      ]
    },
    {
      "lib": "api-ms-win-core-kernel32-legacy-l1-1-0.dll",
      "count": 1,
      "functions": [
        "GetComputerNameW"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "api-ms-win-security-activedirectoryclient-l1-1-1.dll",
      "count": 3,
      "functions": [
        "DsFreeNgcKey",
        "DsReadNgcKeyW",
        "DsWriteNgcKeyW"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLastError",
        "RaiseException",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-1.dll",
      "count": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "lib": "api-ms-win-core-localization-l1-2-0.dll",
      "count": 2,
      "functions": [
        "GetACP",
        "GetUserDefaultLCID"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-1-0.dll",
      "count": 5,
      "functions": [
        "CreateEventA",
        "ResetEvent",
        "SetEvent",
        "WaitForMultipleObjectsEx",
        "WaitForSingleObject"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 3,
      "functions": [
        "LocalAlloc",
        "LocalFree",
        "LocalReAlloc"
      ]
    }
  ],
  "exports": {
    "count": 131,
    "functions": [
      "DsAddCloneDCW",
      "DsAddSidHistoryA",
      "DsAddSidHistoryW",
      "DsBindA",
      "DsBindByInstanceA",
      "DsBindByInstanceW",
      "DsBindToISTGA",
      "DsBindToISTGW",
      "DsBindW",
      "DsBindWithCredA",
      "DsBindWithCredW",
      "DsBindWithSpnA",
      "DsBindWithSpnExA",
      "DsBindWithSpnExW",
      "DsBindWithSpnExWWorker",
      "DsBindWithSpnW",
      "DsBindingSetTimeout",
      "DsClientMakeSpnForTargetServerA",
      "DsClientMakeSpnForTargetServerW",
      "DsCrackNamesA",
      "DsCrackNamesW",
      "DsCrackNamesWWorker",
      "DsCrackSpn2A",
      "DsCrackSpn2W",
      "DsCrackSpn3W",
      "DsCrackSpn4W",
      "DsCrackSpnA",
      "DsCrackSpnW",
      "DsCrackUnquotedMangledRdnA",
      "DsCrackUnquotedMangledRdnW",
      "DsFinishDemotionW",
      "DsFreeCloneDcResult",
      "DsFreeDomainControllerInfoA",
      "DsFreeDomainControllerInfoW",
      "DsFreeDomainControllerInfoWWorker",
      "DsFreeNameResultA",
      "DsFreeNameResultW",
      "DsFreeNameResultWWorker",
      "DsFreeNgcKey",
      "DsFreeNgcKeyWorker",
      "DsFreePasswordCredentials",
      "DsFreePasswordCredentialsWorker",
      "DsFreeSchemaGuidMapA",
      "DsFreeSchemaGuidMapW",
      "DsFreeSpnArrayA",
      "DsFreeSpnArrayW",
      "DsGetBindAddrW",
      "DsGetBindAnnotW",
      "DsGetBindInstGuid",
      "DsGetDomainControllerInfoA",
      "DsGetDomainControllerInfoW",
      "DsGetDomainControllerInfoWWorker",
      "DsGetRdnW",
      "DsGetSpnA",
      "DsGetSpnW",
      "DsInheritSecurityIdentityA",
      "DsInheritSecurityIdentityW",
      "DsInitDemotionW",
      "DsIsMangledDnA",
      "DsIsMangledDnW",
      "DsIsMangledRdnValueA",
      "DsIsMangledRdnValueW",
      "DsListDomainsInSiteA",
      "DsListDomainsInSiteW",
      "DsListInfoForServerA",
      "DsListInfoForServerW",
      "DsListRolesA",
      "DsListRolesW",
      "DsListServersForDomainInSiteA",
      "DsListServersForDomainInSiteW",
      "DsListServersInSiteA",
      "DsListServersInSiteW",
      "DsListSitesA",
      "DsListSitesW",
      "DsLogEntry",
      "DsMakePasswordCredentialsA",
      "DsMakePasswordCredentialsW",
      "DsMakePasswordCredentialsWWorker",
      "DsMakeSpnA",
      "DsMakeSpnW",
      "DsMapSchemaGuidsA",
      "DsMapSchemaGuidsW",
      "DsQuerySitesByCostA",
      "DsQuerySitesByCostW",
      "DsQuerySitesFree",
      "DsQuoteRdnValueA",
      "DsQuoteRdnValueW",
      "DsReadNgcKeyA",
      "DsReadNgcKeyW",
      "DsReadNgcKeyWWorker",
      "DsRemoveDsDomainA",
      "DsRemoveDsDomainW",
      "DsRemoveDsServerA",
      "DsRemoveDsServerW",
      "DsReplicaAddA",
      "DsReplicaAddW",
      "DsReplicaConsistencyCheck",
      "DsReplicaDelA",
      "DsReplicaDelW",
      "DsReplicaDemotionW",
      "DsReplicaFreeInfo",
      "DsReplicaGetInfo2W",
      "DsReplicaGetInfoW",
      "DsReplicaModifyA",
      "DsReplicaModifyW",
      "DsReplicaSyncA",
      "DsReplicaSyncAllA",
      "DsReplicaSyncAllW",
      "DsReplicaSyncW",
      "DsReplicaUpdateRefsA",
      "DsReplicaUpdateRefsW",
      "DsReplicaVerifyObjectsA",
      "DsReplicaVerifyObjectsW",
      "DsServerRegisterSpnA",
      "DsServerRegisterSpnW",
      "DsUnBindA",
      "DsUnBindW",
      "DsUnBindWWorker",
      "DsUnquoteRdnValueA",
      "DsUnquoteRdnValueW",
      "DsWriteAccountSpnA",
      "DsWriteAccountSpnW",
      "DsWriteNgcKeyA",
      "DsWriteNgcKeyW",
      "DsWriteNgcKeyWWorker",
      "DsaopBind",
      "DsaopBindWithCred",
      "DsaopBindWithSpn",
      "DsaopExecuteScript",
      "DsaopPrepareScript",
      "DsaopUnBind"
    ]
  },
  "hashes": {
    "sha2": "4226b241ad2512d5e9daa101cbc693ed31d363b9f18a0fd247413a3c9ee3a4ba",
    "ssdeep": "3072:t1VeEvaHX2qVjIVRKXzcN+/aFH8NwZaWc52oq2yjOktx13U:t7TvamqA4INcaFH8NwZaWc52on4Oktv"
  },
  "intent": {
    "intentions": 3,
    "uniq_apis_matched": 6,
    "results": [
      {
        "intent": "Discovers Configuration Attributes of the Windows Enterprise Domain",
        "tag": "Reconnaissance:T1590.001 - Domain Properties (Windows Enterprise)",
        "component": "---",
        "inputs": 24,
        "matches": 2,
        "apis": [
          "DsBindWithSpnExW",
          "DsGetDomainControllerInfoW"
        ]
      },
      {
        "intent": "Can Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "---",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Can Conduct DNS Queries",
        "tag": "Expert Input:IBO.00014 - Network Layer-7 DNS Usage",
        "component": "Networking",
        "inputs": 31,
        "matches": 2,
        "apis": [
          "GetAddrInfoW",
          "GetNameInfoW"
        ]
      }
    ]
  }
}