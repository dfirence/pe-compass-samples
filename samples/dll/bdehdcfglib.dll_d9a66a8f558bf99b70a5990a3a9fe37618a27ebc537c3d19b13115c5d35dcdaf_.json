{
  "name": "bdehdcfglib.dll",
  "path": "\\\\?\\C:\\Windows\\System32\\BdeHdCfgLib.dll",
  "size": 105984,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 2,
  "subsystem_caption": "The Windows Graphical User Interface (GUI) Subsystem",
  "libs": [
    "advapi32.dll",
    "kernel32.dll",
    "msvcrt.dll",
    "ntdll.dll",
    "ole32.dll",
    "oleaut32.dll",
    "reagent.dll",
    "user32.dll"
  ],
  "imports": [
    {
      "lib": "ole32.dll",
      "count": 7,
      "functions": [
        "CoCreateInstance",
        "CoInitializeEx",
        "CoSetProxyBlanket",
        "CoTaskMemFree",
        "CoUninitialize",
        "CreateClassMoniker",
        "GetRunningObjectTable"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 52,
      "functions": [
        "CloseHandle",
        "CompareStringW",
        "CopyFileW",
        "CreateDirectoryExW",
        "CreateEventW",
        "CreateFileW",
        "CreateThread",
        "DeleteCriticalSection",
        "DeleteFileW",
        "DeviceIoControl",
        "EnterCriticalSection",
        "FindClose",
        "FindFirstFileW",
        "FindFirstVolumeW",
        "FindNextFileW",
        "FindNextVolumeW",
        "FindVolumeClose",
        "FormatMessageW",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "GetDriveTypeW",
        "GetLastError",
        "GetModuleHandleW",
        "GetProcessHeap",
        "GetSystemPowerStatus",
        "GetSystemTimeAsFileTime",
        "GetTickCount",
        "GetVersionExW",
        "GetVolumeInformationByHandleW",
        "GetVolumeNameForVolumeMountPointW",
        "GetVolumePathNamesForVolumeNameW",
        "HeapAlloc",
        "HeapFree",
        "InitializeCriticalSection",
        "K32GetModuleBaseNameW",
        "LeaveCriticalSection",
        "LocalFree",
        "QueryPerformanceCounter",
        "ReadFile",
        "RemoveDirectoryW",
        "SetEvent",
        "SetFileAttributesW",
        "SetFilePointer",
        "SetUnhandledExceptionFilter",
        "Sleep",
        "TerminateProcess",
        "UnhandledExceptionFilter",
        "VirtualAlloc",
        "VirtualFree",
        "WaitForSingleObject",
        "WriteFile"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 21,
      "functions": [
        "_XcptFilter",
        "__C_specific_handler",
        "_amsg_exit",
        "_beginthread",
        "_beginthreadex",
        "_callnewh",
        "_initterm",
        "_purecall",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "_wtoi",
        "free",
        "iswalpha",
        "iswdigit",
        "malloc",
        "memcpy",
        "memset",
        "wcschr",
        "wcsncmp",
        "wcsstr"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 9,
      "functions": [
        "ORDINAL 19",
        "ORDINAL 2",
        "ORDINAL 20",
        "ORDINAL 23",
        "ORDINAL 24",
        "ORDINAL 6",
        "ORDINAL 7",
        "ORDINAL 8",
        "ORDINAL 9"
      ]
    },
    {
      "lib": "user32.dll",
      "count": 2,
      "functions": [
        "GetSystemMetrics",
        "LoadStringW"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 11,
      "functions": [
        "NtClose",
        "NtOpenSymbolicLinkObject",
        "NtQuerySymbolicLinkObject",
        "NtQueryVolumeInformationFile",
        "RtlCaptureContext",
        "RtlCheckPortableOperatingSystem",
        "RtlInitUnicodeString",
        "RtlLookupFunctionEntry",
        "RtlNtStatusToDosError",
        "RtlVirtualUnwind",
        "WinSqmAddToStreamEx"
      ]
    },
    {
      "lib": "advapi32.dll",
      "count": 20,
      "functions": [
        "AdjustTokenPrivileges",
        "AllocateAndInitializeSid",
        "CheckTokenMembership",
        "ConvertStringSecurityDescriptorToSecurityDescriptorW",
        "EventRegister",
        "EventUnregister",
        "EventWrite",
        "FreeSid",
        "GetNamedSecurityInfoW",
        "GetSecurityDescriptorDacl",
        "InitiateShutdownW",
        "LookupPrivilegeValueW",
        "OpenProcessToken",
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegGetValueW",
        "RegOpenKeyExW",
        "RegSetKeyValueW",
        "RegSetValueExW",
        "SetNamedSecurityInfoW"
      ]
    },
    {
      "lib": "reagent.dll",
      "count": 4,
      "functions": [
        "WinRE_Generalize",
        "WinReGetConfig",
        "WinReGetWIMInfo",
        "WinReInstall"
      ]
    }
  ],
  "exports": {
    "count": 114,
    "functions": [
      "??0CBcdStore@@IEAA@XZ",
      "??0CBcdStore@@QEAA@$$QEAV0@@Z",
      "??0CBcdStore@@QEAA@AEBV0@@Z",
      "??0CBcdWmiWrapper@@IEAA@XZ",
      "??0CBcdWmiWrapper@@QEAA@AEBV0@@Z",
      "??0CBdeCfgLibraryLoader@@QEAA@AEBV0@@Z",
      "??0CBdeCfgLibraryLoader@@QEAA@XZ",
      "??0CDriveConfiguration@@QEAA@AEBV0@@Z",
      "??0CDriveConfiguration@@QEAA@XZ",
      "??1CBcdStore@@UEAA@XZ",
      "??1CBcdWmiWrapper@@MEAA@XZ",
      "??1CBdeCfgLibraryLoader@@QEAA@XZ",
      "??1CDriveConfiguration@@QEAA@XZ",
      "??4CBcdStore@@QEAAAEAV0@$$QEAV0@@Z",
      "??4CBcdStore@@QEAAAEAV0@AEBV0@@Z",
      "??4CBcdWmiWrapper@@QEAAAEAV0@AEBV0@@Z",
      "??4CBdeCfgLibraryLoader@@QEAAAEAV0@AEBV0@@Z",
      "??4CDriveConfiguration@@QEAAAEAV0@AEBV0@@Z",
      "??_7CBcdStore@@6B@",
      "??_7CBcdWmiWrapper@@6B@",
      "?ActionRequiresCreate@CDriveConfiguration@@QEAA_NXZ",
      "?ActionRequiresMerge@CDriveConfiguration@@QEAA_NXZ",
      "?ActionRequiresShrink@CDriveConfiguration@@QEAA_NXZ",
      "?CancelConfiguration@CDriveConfiguration@@QEAAJXZ",
      "?CancelConfigurationEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?CancelConfiguration_Thread@CDriveConfiguration@@AEAAJXZ",
      "?Cleanup@CDriveConfiguration@@AEAAXXZ",
      "?ConfigureDrive@CDriveConfiguration@@QEAAJXZ",
      "?CreateClass@CBcdStore@@SAJPEAPEAV1@@Z",
      "?CreateInParams@CBcdWmiWrapper@@IEAAJPEBGPEAPEAUIWbemClassObject@@@Z",
      "?DetectTargetDrive@CDriveConfiguration@@AEAAJPEAUIVdsVolume@@@Z",
      "?DriveConfigurationEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?ExecuteMethod@CBcdWmiWrapper@@IEAAJPEBGPEAUIWbemClassObject@@PEAPEAU2@@Z",
      "?ExportSystemStore@CBcdStore@@QEAAJPEBG@Z",
      "?GetActionType@CDriveConfiguration@@QEAA?AW4BDECFG_ACTION_TYPE@@XZ",
      "?GetConfigurationResult@CDriveConfiguration@@QEAAJXZ",
      "?GetInitializationResult@CDriveConfiguration@@QEAAJXZ",
      "?GetNamespace@CBcdWmiWrapper@@IEAAPEAUIWbemServices@@XZ",
      "?GetNewDriveLetter@CDriveConfiguration@@QEAAGXZ",
      "?GetNumberOfSteps@CDriveConfiguration@@QEAAKXZ",
      "?GetShrinkSize@CDriveConfiguration@@QEAA_KXZ",
      "?GetStepExecutionOrder@CDriveConfiguration@@QEAAKW4_BDECFG_STEP_ID@@@Z",
      "?GetTargetDiskNumber@CDriveConfiguration@@QEAAKXZ",
      "?GetTargetDriveLetter@CDriveConfiguration@@QEAAGXZ",
      "?GetTargetPartitionNumber@CDriveConfiguration@@QEAAKXZ",
      "?GetTargetPartitionSize@CDriveConfiguration@@QEAA_KXZ",
      "?ImportSystemStore@CBcdStore@@QEAAJPEBG@Z",
      "?Initialize@CDriveConfiguration@@QEAAJPEBU_BDECFG_PARAMS@@QEAU_BDECFG_SIZE_REQUIREMENTS@@PEAVIConfigurationProgress@@@Z",
      "?InitializeAndHoldLibrary@CBdeCfgLibraryLoader@@AEAAJXZ",
      "?InitializeAndHoldLibraryEntry@CBdeCfgLibraryLoader@@CAXPEAX@Z",
      "?InitializeAndHoldLibrary_Thread@CBdeCfgLibraryLoader@@AEAAJXZ",
      "?InitializeClass@CBcdWmiWrapper@@IEAAJPEBG@Z",
      "?InitializeEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?InitializeFromParams@CDriveConfiguration@@AEAAJPEAUIVdsVolume@@@Z",
      "?InitializeInstance@CBcdWmiWrapper@@IEAAJPEAUIWbemServices@@PEAUIWbemClassObject@@@Z",
      "?InitializeNamespace@CBcdWmiWrapper@@AEAAJXZ",
      "?Initialized@CDriveConfiguration@@QEAA_NXZ",
      "?IsMergeTargetWinRE@CDriveConfiguration@@QEAAJPEAH@Z",
      "?LibraryLoaded@CBdeCfgLibraryLoader@@QEAA_NXZ",
      "?Load@CBdeCfgLibraryLoader@@QEAAJXZ",
      "?OpenStore@CBcdStore@@QEAAJPEBGPEAPEAV1@@Z",
      "?QueryStepPercentComplete@CDriveConfiguration@@QEAAJPEAK@Z",
      "?RemapObjectDevices@CBcdStore@@QEAAJPEBG0@Z",
      "?SetConfigurationStep@CDriveConfiguration@@AEAAJW4_BDECFG_STEP_ID@@@Z",
      "?Thread_ConfigureDrive@CDriveConfiguration@@AEAAJXZ",
      "?Thread_Initialize@CDriveConfiguration@@AEAAJXZ",
      "?Unload@CBdeCfgLibraryLoader@@QEAAXXZ",
      "BdeCfgCalculateSizeRequirements",
      "BdeCfgCanCreateActivePartOnDisk",
      "BdeCfgCheckAndGetBootVolume",
      "BdeCfgCheckGPTRecoveryPartition",
      "BdeCfgCheckVolumeAsCandidate",
      "BdeCfgCleanupOldBootFiles",
      "BdeCfgCountGPTPartitions",
      "BdeCfgCreateWinREPartitionGPT",
      "BdeCfgDetectWinRESize",
      "BdeCfgDetectWinREVolumeName",
      "BdeCfgDisableWinRE",
      "BdeCfgFindBasicVolumeExtent",
      "BdeCfgFindCandidateVolumes",
      "BdeCfgFindGPTRecoveryPartitionCandidate",
      "BdeCfgFindLargestUnallocatedExtent",
      "BdeCfgFindRecoveryPartitionGPT",
      "BdeCfgFindVolumeWithName",
      "BdeCfgFindVolumeWithProp",
      "BdeCfgGetBootVolume",
      "BdeCfgGetDeviceNameFromVolume",
      "BdeCfgGetMaxShrinkSize",
      "BdeCfgGetNtfsVolumeSize",
      "BdeCfgGetVolumeDisk",
      "BdeCfgGetVolumeDriveLetter",
      "BdeCfgGetVolumeFromId",
      "BdeCfgInitialize",
      "BdeCfgIsDiskConfiguredForBitLocker",
      "BdeCfgIsElevated",
      "BdeCfgIsWinREOnOSVolume",
      "BdeCfgLoadErrorString",
      "BdeCfgLoadResourceString",
      "BdeCfgLogCandidateDrive",
      "BdeCfgLogClose",
      "BdeCfgLogCommandLineParams",
      "BdeCfgLogDetectedWinRE",
      "BdeCfgLogEnumExtent",
      "BdeCfgLogError",
      "BdeCfgLogFailedTarget",
      "BdeCfgLogFoundUnallocatedExtent",
      "BdeCfgLogInit",
      "BdeCfgLogWarning",
      "BdeCfgMigrateBootHive",
      "BdeCfgMoveWinRE",
      "BdeCfgRestart",
      "BdeCfgSecureFormatPartition",
      "BdeCfgShrinkSimpleVolume",
      "BdeCfgUninitialize"
    ]
  },
  "hashes": {
    "sha2": "d9a66a8f558bf99b70a5990a3a9fe37618a27ebc537c3d19b13115c5d35dcdaf",
    "ssdeep": "1536:HKysfgWgkNxt/9XJ4D53DdQzWMFYdFDAPc68gOtbAhJnt0nxPWv7ECsa6S2Zqrz:qX/UTkedAE68cJnt0nxuB6SGq"
  },
  "intent": {
    "intentions": 7,
    "uniq_apis_matched": 11,
    "results": [
      {
        "intent": "Deletes Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity",
        "tag": "Defense Evasion:T1070.004 - File Deletion",
        "component": "Filesystem",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DeleteFileW"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileW"
        ]
      },
      {
        "intent": "Has Ability To Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "CheckTokenMembership",
          "OpenProcessToken"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 1,
        "apis": [
          "RegGetValueW"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 4,
        "apis": [
          "RegCreateKeyExW",
          "RegOpenKeyExW",
          "RegSetKeyValueW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Coordinates System Reboots Resulting In Loss of Attack Evidence Present in System Memory",
        "tag": "Impact:T1529 - System Shutdown/Reboot",
        "component": "---",
        "inputs": 6,
        "matches": 1,
        "apis": [
          "InitiateShutdownW"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "AdjustTokenPrivileges"
        ]
      }
    ]
  }
}