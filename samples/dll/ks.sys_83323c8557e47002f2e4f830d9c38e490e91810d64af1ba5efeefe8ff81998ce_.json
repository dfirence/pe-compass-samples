{
  "name": "ks.sys",
  "path": "\\\\?\\C:\\Windows\\System32\\drivers\\ks.sys",
  "size": 449024,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 1,
  "subsystem_caption": "Device Drivers And Native Windows processes",
  "libs": [
    "hal.dll",
    "ksecdd.sys",
    "ntoskrnl.exe"
  ],
  "imports": [
    {
      "lib": "hal.dll",
      "count": 1,
      "functions": [
        "KeQueryPerformanceCounter"
      ]
    },
    {
      "lib": "ntoskrnl.exe",
      "count": 214,
      "functions": [
        "EtwRegister",
        "EtwWriteTransfer",
        "ExAcquireFastMutex",
        "ExAcquireFastMutexUnsafe",
        "ExAcquireResourceExclusiveLite",
        "ExAcquireResourceSharedLite",
        "ExAcquireRundownProtection",
        "ExAcquireSpinLockShared",
        "ExAllocatePoolWithQuotaTag",
        "ExAllocatePoolWithTag",
        "ExDeleteNPagedLookasideList",
        "ExDeletePagedLookasideList",
        "ExDeleteResourceLite",
        "ExEventObjectType",
        "ExFreePool",
        "ExFreePoolWithTag",
        "ExGetPreviousMode",
        "ExInitializeNPagedLookasideList",
        "ExInitializePagedLookasideList",
        "ExInitializeResourceLite",
        "ExInitializeRundownProtection",
        "ExInterlockedInsertHeadList",
        "ExInterlockedInsertTailList",
        "ExInterlockedRemoveHeadList",
        "ExQueryDepthSList",
        "ExQueueWorkItem",
        "ExRaiseStatus",
        "ExReleaseFastMutex",
        "ExReleaseFastMutexUnsafe",
        "ExReleaseResourceLite",
        "ExReleaseRundownProtection",
        "ExReleaseSpinLockShared",
        "ExSemaphoreObjectType",
        "ExSubscribeWnfStateChange",
        "ExUnsubscribeWnfStateChange",
        "ExWaitForRundownProtectionRelease",
        "ExpInterlockedPopEntrySList",
        "ExpInterlockedPushEntrySList",
        "IoAcquireCancelSpinLock",
        "IoAcquireRemoveLockEx",
        "IoAllocateDriverObjectExtension",
        "IoAllocateIrp",
        "IoAllocateMdl",
        "IoAllocateWorkItem",
        "IoAttachDeviceToDeviceStack",
        "IoBuildDeviceIoControlRequest",
        "IoBuildSynchronousFsdRequest",
        "IoCancelIrp",
        "IoCreateDevice",
        "IoCreateFile",
        "IoDeleteDevice",
        "IoDetachDevice",
        "IoFileObjectType",
        "IoFreeIrp",
        "IoFreeMdl",
        "IoFreeWorkItem",
        "IoGetCurrentProcess",
        "IoGetDeviceAttachmentBaseRef",
        "IoGetDeviceInterfaceAlias",
        "IoGetDeviceInterfacePropertyData",
        "IoGetDeviceInterfaces",
        "IoGetDeviceObjectPointer",
        "IoGetDeviceProperty",
        "IoGetDevicePropertyData",
        "IoGetDriverObjectExtension",
        "IoGetFileObjectGenericMapping",
        "IoGetInitiatorProcess",
        "IoGetRelatedDeviceObject",
        "IoInitializeRemoveLockEx",
        "IoInvalidateDeviceRelations",
        "IoIsWdmVersionAvailable",
        "IoOpenDeviceInterfaceRegistryKey",
        "IoOpenDeviceRegistryKey",
        "IoQueueWorkItem",
        "IoRegisterDeviceInterface",
        "IoReleaseCancelSpinLock",
        "IoReleaseRemoveLockAndWaitEx",
        "IoReleaseRemoveLockEx",
        "IoSetDeviceInterfacePropertyData",
        "IoSetDeviceInterfaceState",
        "IoWMIRegistrationControl",
        "IofCallDriver",
        "IofCompleteRequest",
        "KeAcquireSpinLockAtDpcLevel",
        "KeAcquireSpinLockRaiseToDpc",
        "KeBugCheckEx",
        "KeCancelTimer",
        "KeClearEvent",
        "KeEnterCriticalRegion",
        "KeFlushIoBuffers",
        "KeFlushQueuedDpcs",
        "KeInitializeDpc",
        "KeInitializeEvent",
        "KeInitializeMutex",
        "KeInitializeSpinLock",
        "KeInitializeTimer",
        "KeInitializeTimerEx",
        "KeInsertQueueDpc",
        "KeLeaveCriticalRegion",
        "KeLowerIrql",
        "KeQuerySystemTimePrecise",
        "KeQueryTimeIncrement",
        "KeReadStateEvent",
        "KeReadStateMutex",
        "KeReleaseMutex",
        "KeReleaseSemaphore",
        "KeReleaseSpinLock",
        "KeReleaseSpinLockFromDpcLevel",
        "KeRemoveQueueDpc",
        "KeResetEvent",
        "KeSetEvent",
        "KeSetImportanceDpc",
        "KeSetTimer",
        "KeSetTimerEx",
        "KeSynchronizeExecution",
        "KeWaitForSingleObject",
        "KfRaiseIrql",
        "KseQueryDeviceFlags",
        "LdrAccessResource",
        "LdrFindResource_U",
        "Mm64BitPhysicalAddress",
        "MmAddVerifierThunks",
        "MmAllocatePagesForMdl",
        "MmFreePagesFromMdl",
        "MmGetSystemRoutineAddress",
        "MmIsDriverVerifying",
        "MmIsVerifierEnabled",
        "MmLockPagableDataSection",
        "MmMapLockedPagesSpecifyCache",
        "MmProbeAndLockPages",
        "MmUnlockPages",
        "MmUnmapLockedPages",
        "ObOpenObjectByPointer",
        "ObReferenceObjectByHandle",
        "ObfDereferenceObject",
        "ObfReferenceObject",
        "PoCallDriver",
        "PoRegisterPowerSettingCallback",
        "PoRegisterSystemState",
        "PoRequestPowerIrp",
        "PoSetPowerState",
        "PoStartNextPowerIrp",
        "PoUnregisterPowerSettingCallback",
        "PoUnregisterSystemState",
        "ProbeForRead",
        "ProbeForWrite",
        "PsAttachSiloToCurrentThread",
        "PsDereferencePrimaryToken",
        "PsDetachSiloFromCurrentThread",
        "PsGetHostSilo",
        "PsGetProcessId",
        "PsGetProcessSessionId",
        "PsGetThreadProcess",
        "PsLookupProcessByProcessId",
        "PsReferencePrimaryToken",
        "RtlAddAccessAllowedAceEx",
        "RtlAppendUnicodeStringToString",
        "RtlAppendUnicodeToString",
        "RtlCheckTokenMembership",
        "RtlCompareMemory",
        "RtlCompareUnicodeString",
        "RtlConvertSidToUnicodeString",
        "RtlCopySid",
        "RtlCopyUnicodeString",
        "RtlEqualSid",
        "RtlFreeUnicodeString",
        "RtlGUIDFromString",
        "RtlInitUnicodeString",
        "RtlInitializeSid",
        "RtlIntegerToUnicodeString",
        "RtlLengthRequiredSid",
        "RtlLengthSid",
        "RtlMapGenericMask",
        "RtlQueryPackageClaims",
        "RtlQueryRegistryValues",
        "RtlSelfRelativeToAbsoluteSD",
        "RtlStringFromGUID",
        "RtlSubAuthoritySid",
        "RtlValidSid",
        "RtlWriteRegistryValue",
        "SeAccessCheck",
        "SeAppendPrivileges",
        "SeAssignSecurity",
        "SeCaptureSubjectContext",
        "SeExports",
        "SeFreePrivileges",
        "SeLockSubjectContext",
        "SeOpenObjectAuditAlarm",
        "SeQueryInformationToken",
        "SeQuerySecurityDescriptorInfo",
        "SeReleaseSubjectContext",
        "SeSetSecurityDescriptorInfo",
        "SeSinglePrivilegeCheck",
        "SeUnlockSubjectContext",
        "ZwClose",
        "ZwCreateKey",
        "ZwDeleteKey",
        "ZwDeleteValueKey",
        "ZwEnumerateKey",
        "ZwEnumerateValueKey",
        "ZwNotifyChangeKey",
        "ZwOpenEvent",
        "ZwOpenKey",
        "ZwPowerInformation",
        "ZwQueryKey",
        "ZwQuerySecurityObject",
        "ZwQueryValueKey",
        "ZwSetSecurityObject",
        "ZwSetValueKey",
        "ZwUpdateWnfStateData",
        "__C_specific_handler",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp"
      ]
    },
    {
      "lib": "ksecdd.sys",
      "count": 7,
      "functions": [
        "BCryptCloseAlgorithmProvider",
        "BCryptCreateHash",
        "BCryptDestroyHash",
        "BCryptFinishHash",
        "BCryptGetProperty",
        "BCryptHashData",
        "BCryptOpenAlgorithmProvider"
      ]
    }
  ],
  "exports": {
    "count": 237,
    "functions": [
      "??0CBaseUnknown@@QEAA@AEBU_GUID@@PEAUIUnknown@@@Z",
      "??0CBaseUnknown@@QEAA@PEAUIUnknown@@@Z",
      "??1CBaseUnknown@@UEAA@XZ",
      "??_FCBaseUnknown@@QEAAXXZ",
      "?IndirectedAddRef@CBaseUnknown@@UEAAKXZ",
      "?IndirectedQueryInterface@CBaseUnknown@@UEAAJAEBU_GUID@@PEAPEAX@Z",
      "?IndirectedRelease@CBaseUnknown@@UEAAKXZ",
      "?NonDelegatedAddRef@CBaseUnknown@@UEAAKXZ",
      "?NonDelegatedQueryInterface@CBaseUnknown@@UEAAJAEBU_GUID@@PEAPEAX@Z",
      "?NonDelegatedRelease@CBaseUnknown@@UEAAKXZ",
      "DllInitialize",
      "KoCreateInstance",
      "KoDeviceInitialize",
      "KoDriverInitialize",
      "KoRelease",
      "KsAcquireCachedMdl",
      "KsAcquireControl",
      "KsAcquireDevice",
      "KsAcquireDeviceSecurityLock",
      "KsAcquireResetValue",
      "KsAddDevice",
      "KsAddEvent",
      "KsAddIrpToCancelableQueue",
      "KsAddItemToObjectBag",
      "KsAddObjectCreateItemToDeviceHeader",
      "KsAddObjectCreateItemToObjectHeader",
      "KsAllocateDefaultClock",
      "KsAllocateDefaultClockEx",
      "KsAllocateDeviceHeader",
      "KsAllocateExtraData",
      "KsAllocateObjectBag",
      "KsAllocateObjectCreateItem",
      "KsAllocateObjectHeader",
      "KsCacheMedium",
      "KsCancelIo",
      "KsCancelRoutine",
      "KsCompletePendingRequest",
      "KsCopyObjectBagItems",
      "KsCreateAllocator",
      "KsCreateBusEnumObject",
      "KsCreateClock",
      "KsCreateDefaultAllocator",
      "KsCreateDefaultAllocatorEx",
      "KsCreateDefaultClock",
      "KsCreateDefaultSecurity",
      "KsCreateDevice",
      "KsCreateFilterFactory",
      "KsCreatePin",
      "KsCreateTopologyNode",
      "KsDecrementCountedWorker",
      "KsDefaultAddEventHandler",
      "KsDefaultDeviceIoCompletion",
      "KsDefaultDispatchPnp",
      "KsDefaultDispatchPower",
      "KsDefaultForwardIrp",
      "KsDereferenceBusObject",
      "KsDereferenceSoftwareBusObject",
      "KsDeviceGetBusData",
      "KsDeviceRegisterAdapterObject",
      "KsDeviceRegisterThermalDispatch",
      "KsDeviceSetBusData",
      "KsDisableEvent",
      "KsDiscardEvent",
      "KsDispatchFastIoDeviceControlFailure",
      "KsDispatchFastReadFailure",
      "KsDispatchInvalidDeviceRequest",
      "KsDispatchIrp",
      "KsDispatchQuerySecurity",
      "KsDispatchSetSecurity",
      "KsDispatchSpecificMethod",
      "KsDispatchSpecificProperty",
      "KsEnableEvent",
      "KsEnableEventWithAllocator",
      "KsFastMethodHandler",
      "KsFastPropertyHandler",
      "KsFilterAcquireProcessingMutex",
      "KsFilterAddTopologyConnections",
      "KsFilterAttemptProcessing",
      "KsFilterCreateNode",
      "KsFilterCreatePinFactory",
      "KsFilterFactoryAddCreateItem",
      "KsFilterFactoryGetSymbolicLink",
      "KsFilterFactorySetDeviceClassesState",
      "KsFilterFactoryUpdateCacheData",
      "KsFilterGetAndGate",
      "KsFilterGetChildPinCount",
      "KsFilterGetFirstChildPin",
      "KsFilterRegisterPowerCallbacks",
      "KsFilterReleaseProcessingMutex",
      "KsForwardAndCatchIrp",
      "KsForwardIrp",
      "KsFreeDefaultClock",
      "KsFreeDeviceHeader",
      "KsFreeEventList",
      "KsFreeObjectBag",
      "KsFreeObjectCreateItem",
      "KsFreeObjectCreateItemsByContext",
      "KsFreeObjectHeader",
      "KsGenerateDataEvent",
      "KsGenerateEvent",
      "KsGenerateEventList",
      "KsGenerateEvents",
      "KsGenerateThermalEvent",
      "KsGetBusEnumIdentifier",
      "KsGetBusEnumParentFDOFromChildPDO",
      "KsGetBusEnumPnpDeviceObject",
      "KsGetDefaultClockState",
      "KsGetDefaultClockTime",
      "KsGetDevice",
      "KsGetDeviceForDeviceObject",
      "KsGetFilterFromIrp",
      "KsGetFirstChild",
      "KsGetImageNameAndResourceId",
      "KsGetNextSibling",
      "KsGetNodeIdFromIrp",
      "KsGetObjectFromFileObject",
      "KsGetObjectTypeFromFileObject",
      "KsGetObjectTypeFromIrp",
      "KsGetOuterUnknown",
      "KsGetParent",
      "KsGetPinFromIrp",
      "KsHandleSizedListQuery",
      "KsIncrementCountedWorker",
      "KsInitializeDevice",
      "KsInitializeDeviceProfile",
      "KsInitializeDriver",
      "KsInstallBusEnumInterface",
      "KsIsBusEnumChildDevice",
      "KsIsCurrentProcessFrameServer",
      "KsLoadResource",
      "KsMapModuleName",
      "KsMergeAutomationTables",
      "KsMethodHandler",
      "KsMethodHandlerWithAllocator",
      "KsMoveIrpsOnCancelableQueue",
      "KsNullDriverUnload",
      "KsPersistDeviceProfile",
      "KsPinAcquireProcessingMutex",
      "KsPinAttachAndGate",
      "KsPinAttachOrGate",
      "KsPinAttemptProcessing",
      "KsPinDataIntersection",
      "KsPinGetAndGate",
      "KsPinGetAvailableByteCount",
      "KsPinGetConnectedFilterInterface",
      "KsPinGetConnectedPinDeviceObject",
      "KsPinGetConnectedPinFileObject",
      "KsPinGetConnectedPinInterface",
      "KsPinGetCopyRelationships",
      "KsPinGetFirstCloneStreamPointer",
      "KsPinGetLeadingEdgeStreamPointer",
      "KsPinGetNextSiblingPin",
      "KsPinGetParentFilter",
      "KsPinGetReferenceClockInterface",
      "KsPinGetTrailingEdgeStreamPointer",
      "KsPinPropertyHandler",
      "KsPinRegisterFrameReturnCallback",
      "KsPinRegisterHandshakeCallback",
      "KsPinRegisterIrpCompletionCallback",
      "KsPinRegisterPowerCallbacks",
      "KsPinReleaseProcessingMutex",
      "KsPinSetPinClockTime",
      "KsPinSubmitFrame",
      "KsPinSubmitFrameMdl",
      "KsProbeStreamIrp",
      "KsProcessPinUpdate",
      "KsPropertyHandler",
      "KsPropertyHandlerWithAllocator",
      "KsPublishDeviceProfile",
      "KsQueryDevicePnpObject",
      "KsQueryInformationFile",
      "KsQueryObjectAccessMask",
      "KsQueryObjectCreateItem",
      "KsQueueWorkItem",
      "KsReadFile",
      "KsRecalculateStackDepth",
      "KsReferenceBusObject",
      "KsReferenceSoftwareBusObject",
      "KsRegisterAggregatedClientUnknown",
      "KsRegisterCountedWorker",
      "KsRegisterFilterWithNoKSPins",
      "KsRegisterWorker",
      "KsReleaseCachedMdl",
      "KsReleaseControl",
      "KsReleaseDevice",
      "KsReleaseDeviceSecurityLock",
      "KsReleaseIrpOnCancelableQueue",
      "KsRemoveBusEnumInterface",
      "KsRemoveIrpFromCancelableQueue",
      "KsRemoveItemFromObjectBag",
      "KsRemoveSpecificIrpFromCancelableQueue",
      "KsServiceBusEnumCreateRequest",
      "KsServiceBusEnumPnpRequest",
      "KsSetDefaultClockState",
      "KsSetDefaultClockTime",
      "KsSetDevicePnpAndBaseObject",
      "KsSetInformationFile",
      "KsSetMajorFunctionHandler",
      "KsSetPowerDispatch",
      "KsSetTargetDeviceObject",
      "KsSetTargetState",
      "KsStreamIo",
      "KsStreamPointerAdvance",
      "KsStreamPointerAdvanceOffsets",
      "KsStreamPointerAdvanceOffsetsAndUnlock",
      "KsStreamPointerCancelTimeout",
      "KsStreamPointerClone",
      "KsStreamPointerDelete",
      "KsStreamPointerGetIrp",
      "KsStreamPointerGetMdl",
      "KsStreamPointerGetNextClone",
      "KsStreamPointerLock",
      "KsStreamPointerScheduleTimeout",
      "KsStreamPointerSetStatusCode",
      "KsStreamPointerUnlock",
      "KsSynchronousIoControlDevice",
      "KsTerminateDevice",
      "KsTopologyPropertyHandler",
      "KsUnregisterWorker",
      "KsUnserializeObjectPropertiesFromRegistry",
      "KsUpdateCameraStreamingConsent",
      "KsValidateAllocatorCreateRequest",
      "KsValidateAllocatorFramingEx",
      "KsValidateClockCreateRequest",
      "KsValidateConnectRequest",
      "KsValidateTopologyNodeCreateRequest",
      "KsWriteFile",
      "KsiDefaultClockAddMarkEvent",
      "KsiPropertyDefaultClockGetCorrelatedPhysicalTime",
      "KsiPropertyDefaultClockGetCorrelatedTime",
      "KsiPropertyDefaultClockGetFunctionTable",
      "KsiPropertyDefaultClockGetPhysicalTime",
      "KsiPropertyDefaultClockGetResolution",
      "KsiPropertyDefaultClockGetState",
      "KsiPropertyDefaultClockGetTime",
      "KsiQueryObjectCreateItemsPresent",
      "_KsEdit"
    ]
  },
  "hashes": {
    "sha2": "83323c8557e47002f2e4f830d9c38e490e91810d64af1ba5efeefe8ff81998ce",
    "ssdeep": "6144:G7xt34BnIZyUT890RAc/3EUX6b//icweP/AEEDRr5BGgfD+zBTDCdtGrRMM:G7xtXZP8GRe765bfD0BTCIRM"
  },
  "intent": {
    "intentions": 1,
    "uniq_apis_matched": 7,
    "results": [
      {
        "intent": "Can Conduct Cryptographic Operations",
        "tag": "Expert Input:IBO.0022 - Windows Cryptography Facilities",
        "component": "Crypto",
        "inputs": 71,
        "matches": 7,
        "apis": [
          "BCryptCloseAlgorithmProvider",
          "BCryptCreateHash",
          "BCryptDestroyHash",
          "BCryptFinishHash",
          "BCryptGetProperty",
          "BCryptHashData",
          "BCryptOpenAlgorithmProvider"
        ]
      }
    ]
  }
}