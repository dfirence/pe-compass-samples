{
  "pe_name": "BdeHdCfgLib.dll",
  "pe_type": 523,
  "pe_size": 105984,
  "pe_subsystem": 2,
  "pe_subsystem_caption": "The Windows graphical user interface (GUI) subsystem",
  "pe_path": "c:\\Windows\\WinSxS\\amd64_microsoft-windows-s..up-drivepreparation_31bf3856ad364e35_10.0.19041.1_none_56e294df085b0025\\BdeHdCfgLib.dll",
  "pe_timedate_stamp": 2906651098,
  "pe_timedate_human": "2062-02-08T19:04:58.000Z",
  "ImageDLLImports": [
    {
      "name": "msvcrt.dll",
      "imports": 21,
      "functions": [
        "_XcptFilter",
        "__C_specific_handler",
        "_amsg_exit",
        "_beginthread",
        "_beginthreadex",
        "_callnewh",
        "_initterm",
        "_purecall",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "_wtoi",
        "free",
        "iswalpha",
        "iswdigit",
        "malloc",
        "memcpy",
        "memset",
        "wcschr",
        "wcsncmp",
        "wcsstr"
      ]
    },
    {
      "name": "ntdll.dll",
      "imports": 11,
      "functions": [
        "NtClose",
        "NtOpenSymbolicLinkObject",
        "NtQuerySymbolicLinkObject",
        "NtQueryVolumeInformationFile",
        "RtlCaptureContext",
        "RtlCheckPortableOperatingSystem",
        "RtlInitUnicodeString",
        "RtlLookupFunctionEntry",
        "RtlNtStatusToDosError",
        "RtlVirtualUnwind",
        "WinSqmAddToStreamEx"
      ]
    },
    {
      "name": "advapi32.dll",
      "imports": 20,
      "functions": [
        "AdjustTokenPrivileges",
        "AllocateAndInitializeSid",
        "CheckTokenMembership",
        "ConvertStringSecurityDescriptorToSecurityDescriptorW",
        "EventRegister",
        "EventUnregister",
        "EventWrite",
        "FreeSid",
        "GetNamedSecurityInfoW",
        "GetSecurityDescriptorDacl",
        "InitiateShutdownW",
        "LookupPrivilegeValueW",
        "OpenProcessToken",
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegGetValueW",
        "RegOpenKeyExW",
        "RegSetKeyValueW",
        "RegSetValueExW",
        "SetNamedSecurityInfoW"
      ]
    },
    {
      "name": "kernel32.dll",
      "imports": 52,
      "functions": [
        "CloseHandle",
        "CompareStringW",
        "CopyFileW",
        "CreateDirectoryExW",
        "CreateEventW",
        "CreateFileW",
        "CreateThread",
        "DeleteCriticalSection",
        "DeleteFileW",
        "DeviceIoControl",
        "EnterCriticalSection",
        "FindClose",
        "FindFirstFileW",
        "FindFirstVolumeW",
        "FindNextFileW",
        "FindNextVolumeW",
        "FindVolumeClose",
        "FormatMessageW",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "GetDriveTypeW",
        "GetLastError",
        "GetModuleHandleW",
        "GetProcessHeap",
        "GetSystemPowerStatus",
        "GetSystemTimeAsFileTime",
        "GetTickCount",
        "GetVersionExW",
        "GetVolumeInformationByHandleW",
        "GetVolumeNameForVolumeMountPointW",
        "GetVolumePathNamesForVolumeNameW",
        "HeapAlloc",
        "HeapFree",
        "InitializeCriticalSection",
        "K32GetModuleBaseNameW",
        "LeaveCriticalSection",
        "LocalFree",
        "QueryPerformanceCounter",
        "ReadFile",
        "RemoveDirectoryW",
        "SetEvent",
        "SetFileAttributesW",
        "SetFilePointer",
        "SetUnhandledExceptionFilter",
        "Sleep",
        "TerminateProcess",
        "UnhandledExceptionFilter",
        "VirtualAlloc",
        "VirtualFree",
        "WaitForSingleObject",
        "WriteFile"
      ]
    },
    {
      "name": "user32.dll",
      "imports": 2,
      "functions": [
        "GetSystemMetrics",
        "LoadStringW"
      ]
    },
    {
      "name": "ole32.dll",
      "imports": 7,
      "functions": [
        "CoCreateInstance",
        "CoInitializeEx",
        "CoSetProxyBlanket",
        "CoTaskMemFree",
        "CoUninitialize",
        "CreateClassMoniker",
        "GetRunningObjectTable"
      ]
    },
    {
      "name": "oleaut32.dll",
      "imports": 0,
      "functions": []
    },
    {
      "name": "reagent.dll",
      "imports": 4,
      "functions": [
        "WinRE_Generalize",
        "WinReGetConfig",
        "WinReGetWIMInfo",
        "WinReInstall"
      ]
    }
  ],
  "ImageDLLExports": {
    "exports": 114,
    "functions": [
      "??0CBcdStore@@IEAA@XZ",
      "??0CBcdStore@@QEAA@$$QEAV0@@Z",
      "??0CBcdStore@@QEAA@AEBV0@@Z",
      "??0CBcdWmiWrapper@@IEAA@XZ",
      "??0CBcdWmiWrapper@@QEAA@AEBV0@@Z",
      "??0CBdeCfgLibraryLoader@@QEAA@AEBV0@@Z",
      "??0CBdeCfgLibraryLoader@@QEAA@XZ",
      "??0CDriveConfiguration@@QEAA@AEBV0@@Z",
      "??0CDriveConfiguration@@QEAA@XZ",
      "??1CBcdStore@@UEAA@XZ",
      "??1CBcdWmiWrapper@@MEAA@XZ",
      "??1CBdeCfgLibraryLoader@@QEAA@XZ",
      "??1CDriveConfiguration@@QEAA@XZ",
      "??4CBcdStore@@QEAAAEAV0@$$QEAV0@@Z",
      "??4CBcdStore@@QEAAAEAV0@AEBV0@@Z",
      "??4CBcdWmiWrapper@@QEAAAEAV0@AEBV0@@Z",
      "??4CBdeCfgLibraryLoader@@QEAAAEAV0@AEBV0@@Z",
      "??4CDriveConfiguration@@QEAAAEAV0@AEBV0@@Z",
      "??_7CBcdStore@@6B@",
      "??_7CBcdWmiWrapper@@6B@",
      "?ActionRequiresCreate@CDriveConfiguration@@QEAA_NXZ",
      "?ActionRequiresMerge@CDriveConfiguration@@QEAA_NXZ",
      "?ActionRequiresShrink@CDriveConfiguration@@QEAA_NXZ",
      "BdeCfgCalculateSizeRequirements",
      "BdeCfgCanCreateActivePartOnDisk",
      "BdeCfgCheckAndGetBootVolume",
      "BdeCfgCheckGPTRecoveryPartition",
      "BdeCfgCheckVolumeAsCandidate",
      "BdeCfgCleanupOldBootFiles",
      "BdeCfgCountGPTPartitions",
      "BdeCfgCreateWinREPartitionGPT",
      "BdeCfgDetectWinRESize",
      "BdeCfgDetectWinREVolumeName",
      "BdeCfgDisableWinRE",
      "BdeCfgFindBasicVolumeExtent",
      "BdeCfgFindCandidateVolumes",
      "BdeCfgFindGPTRecoveryPartitionCandidate",
      "BdeCfgFindLargestUnallocatedExtent",
      "BdeCfgFindRecoveryPartitionGPT",
      "BdeCfgFindVolumeWithName",
      "BdeCfgFindVolumeWithProp",
      "BdeCfgGetBootVolume",
      "BdeCfgGetDeviceNameFromVolume",
      "BdeCfgGetMaxShrinkSize",
      "BdeCfgGetNtfsVolumeSize",
      "BdeCfgGetVolumeDisk",
      "BdeCfgGetVolumeDriveLetter",
      "BdeCfgGetVolumeFromId",
      "BdeCfgInitialize",
      "BdeCfgIsDiskConfiguredForBitLocker",
      "BdeCfgIsElevated",
      "BdeCfgIsWinREOnOSVolume",
      "BdeCfgLoadErrorString",
      "BdeCfgLoadResourceString",
      "BdeCfgMigrateBootHive",
      "BdeCfgMoveWinRE",
      "BdeCfgRestart",
      "BdeCfgSecureFormatPartition",
      "BdeCfgShrinkSimpleVolume",
      "BdeCfgUninitialize",
      "?CancelConfiguration@CDriveConfiguration@@QEAAJXZ",
      "?CancelConfigurationEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?CancelConfiguration_Thread@CDriveConfiguration@@AEAAJXZ",
      "?Cleanup@CDriveConfiguration@@AEAAXXZ",
      "?ConfigureDrive@CDriveConfiguration@@QEAAJXZ",
      "?CreateClass@CBcdStore@@SAJPEAPEAV1@@Z",
      "?CreateInParams@CBcdWmiWrapper@@IEAAJPEBGPEAPEAUIWbemClassObject@@@Z",
      "?DetectTargetDrive@CDriveConfiguration@@AEAAJPEAUIVdsVolume@@@Z",
      "?DriveConfigurationEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?ExecuteMethod@CBcdWmiWrapper@@IEAAJPEBGPEAUIWbemClassObject@@PEAPEAU2@@Z",
      "?ExportSystemStore@CBcdStore@@QEAAJPEBG@Z",
      "?GetActionType@CDriveConfiguration@@QEAA?AW4BDECFG_ACTION_TYPE@@XZ",
      "?GetConfigurationResult@CDriveConfiguration@@QEAAJXZ",
      "?GetInitializationResult@CDriveConfiguration@@QEAAJXZ",
      "?GetNamespace@CBcdWmiWrapper@@IEAAPEAUIWbemServices@@XZ",
      "?GetNewDriveLetter@CDriveConfiguration@@QEAAGXZ",
      "?GetNumberOfSteps@CDriveConfiguration@@QEAAKXZ",
      "?GetShrinkSize@CDriveConfiguration@@QEAA_KXZ",
      "?GetStepExecutionOrder@CDriveConfiguration@@QEAAKW4_BDECFG_STEP_ID@@@Z",
      "?GetTargetDiskNumber@CDriveConfiguration@@QEAAKXZ",
      "?GetTargetDriveLetter@CDriveConfiguration@@QEAAGXZ",
      "?GetTargetPartitionNumber@CDriveConfiguration@@QEAAKXZ",
      "?GetTargetPartitionSize@CDriveConfiguration@@QEAA_KXZ",
      "?ImportSystemStore@CBcdStore@@QEAAJPEBG@Z",
      "?Initialize@CDriveConfiguration@@QEAAJPEBU_BDECFG_PARAMS@@QEAU_BDECFG_SIZE_REQUIREMENTS@@PEAVIConfigurationProgress@@@Z",
      "?InitializeAndHoldLibrary@CBdeCfgLibraryLoader@@AEAAJXZ",
      "?InitializeAndHoldLibraryEntry@CBdeCfgLibraryLoader@@CAXPEAX@Z",
      "?InitializeAndHoldLibrary_Thread@CBdeCfgLibraryLoader@@AEAAJXZ",
      "?InitializeClass@CBcdWmiWrapper@@IEAAJPEBG@Z",
      "?InitializeEntry@CDriveConfiguration@@CAXPEAX@Z",
      "?InitializeFromParams@CDriveConfiguration@@AEAAJPEAUIVdsVolume@@@Z",
      "?InitializeInstance@CBcdWmiWrapper@@IEAAJPEAUIWbemServices@@PEAUIWbemClassObject@@@Z",
      "?InitializeNamespace@CBcdWmiWrapper@@AEAAJXZ",
      "?Initialized@CDriveConfiguration@@QEAA_NXZ",
      "?IsMergeTargetWinRE@CDriveConfiguration@@QEAAJPEAH@Z",
      "?LibraryLoaded@CBdeCfgLibraryLoader@@QEAA_NXZ",
      "?Load@CBdeCfgLibraryLoader@@QEAAJXZ",
      "?OpenStore@CBcdStore@@QEAAJPEBGPEAPEAV1@@Z",
      "?QueryStepPercentComplete@CDriveConfiguration@@QEAAJPEAK@Z",
      "?RemapObjectDevices@CBcdStore@@QEAAJPEBG0@Z",
      "?SetConfigurationStep@CDriveConfiguration@@AEAAJW4_BDECFG_STEP_ID@@@Z",
      "?Thread_ConfigureDrive@CDriveConfiguration@@AEAAJXZ",
      "?Thread_Initialize@CDriveConfiguration@@AEAAJXZ",
      "?Unload@CBdeCfgLibraryLoader@@QEAAXXZ",
      "BdeCfgLogCandidateDrive",
      "BdeCfgLogClose",
      "BdeCfgLogCommandLineParams",
      "BdeCfgLogDetectedWinRE",
      "BdeCfgLogEnumExtent",
      "BdeCfgLogError",
      "BdeCfgLogFailedTarget",
      "BdeCfgLogFoundUnallocatedExtent",
      "BdeCfgLogInit",
      "BdeCfgLogWarning"
    ]
  },
  "ImageHashSignatures": {
    "sha2": "d9a66a8f558bf99b70a5990a3a9fe37618a27ebc537c3d19b13115c5d35dcdaf"
  },
  "scan": {
    "intentions": 7,
    "uniq_apis_matched": 12,
    "results": [
      {
        "intent": "Implements Features To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 4,
        "apis": [
          "RegCreateKeyExW",
          "RegOpenKeyExW",
          "RegSetKeyValueW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Query And Discover Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 1,
        "apis": [
          "RegGetValueW"
        ]
      },
      {
        "intent": "Enumerate Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileW"
        ]
      },
      {
        "intent": "Conduct System Reboots Resulting In Loss of Attack Evidence Present in System Memory",
        "tag": "Impact:T1529 - System Shutdown/Reboot",
        "component": "---",
        "inputs": 6,
        "matches": 1,
        "apis": [
          "InitiateShutdownW"
        ]
      },
      {
        "intent": "Manipulate Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 10,
        "matches": 3,
        "apis": [
          "AdjustTokenPrivileges",
          "CheckTokenMembership",
          "OpenProcessToken"
        ]
      },
      {
        "intent": "Inject DLLs into Processes to evade defenses",
        "tag": "Defense Evasion:T1055 - Dynamic-Link Library Injection",
        "component": "Processes",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "VirtualAlloc"
        ]
      },
      {
        "intent": "Delete Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity",
        "tag": "Defense Evasion:T1070.004 - File Deletion",
        "component": "Filesystem",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DeleteFileW"
        ]
      }
    ]
  }
}