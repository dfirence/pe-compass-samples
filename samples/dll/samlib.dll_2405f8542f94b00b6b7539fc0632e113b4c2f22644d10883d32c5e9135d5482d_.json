{
  "name": "samlib.dll",
  "path": "\\\\?\\C:\\Windows\\SysWOW64\\samlib.dll",
  "size": 93184,
  "type": "win-pe",
  "is_64": false,
  "is_lib": true,
  "is_dotnet": true,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "api-ms-win-core-debug-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-1.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-interlocked-l1-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-localization-l1-2-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-1.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-string-l1-1-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-crt-private-l1-1-0.dll",
    "api-ms-win-crt-runtime-l1-1-0.dll",
    "api-ms-win-crt-string-l1-1-0.dll",
    "api-ms-win-eventing-classicprovider-l1-1-0.dll",
    "api-ms-win-eventing-obsolete-l1-1-0.dll",
    "api-ms-win-security-base-l1-1-0.dll",
    "ntdll.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-crt-runtime-l1-1-0.dll",
      "count": 2,
      "functions": [
        "_initterm",
        "_initterm_e"
      ]
    },
    {
      "lib": "api-ms-win-security-base-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLengthSid",
        "IsValidSid",
        "IsWellKnownSid",
        "RevertToSelf"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetComputerNameExW",
        "GetLocalTime",
        "GetSystemTimeAsFileTime",
        "GetWindowsDirectoryW"
      ]
    },
    {
      "lib": "api-ms-win-crt-string-l1-1-0.dll",
      "count": 3,
      "functions": [
        "memset",
        "wcsncmp",
        "wcspbrk"
      ]
    },
    {
      "lib": "api-ms-win-core-debug-l1-1-0.dll",
      "count": 1,
      "functions": [
        "IsDebuggerPresent"
      ]
    },
    {
      "lib": "api-ms-win-eventing-classicprovider-l1-1-0.dll",
      "count": 5,
      "functions": [
        "GetTraceEnableFlags",
        "GetTraceEnableLevel",
        "GetTraceLoggerHandle",
        "TraceMessage",
        "UnregisterTraceGuids"
      ]
    },
    {
      "lib": "api-ms-win-crt-private-l1-1-0.dll",
      "count": 16,
      "functions": [
        "_except_handler4_common",
        "_o___std_type_info_destroy_list",
        "_o___stdio_common_vfwprintf",
        "_o__cexit",
        "_o__configure_narrow_argv",
        "_o__execute_onexit_table",
        "_o__initialize_narrow_environment",
        "_o__initialize_onexit_table",
        "_o__seh_filter_dll",
        "_o__wcsicmp",
        "_o__wcsnicmp",
        "_o__wfopen",
        "_o_fclose",
        "_o_fflush",
        "memcpy",
        "memmove"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 23,
      "functions": [
        "NtOpenThreadToken",
        "NtQueryInformationToken",
        "NtSetInformationThread",
        "RtlAllocateAndInitializeSid",
        "RtlCopySid",
        "RtlDeleteCriticalSection",
        "RtlEnterCriticalSection",
        "RtlEqualComputerName",
        "RtlEqualUnicodeString",
        "RtlFreeHeap",
        "RtlGetNtProductType",
        "RtlInitUnicodeString",
        "RtlInitializeCriticalSection",
        "RtlLeaveCriticalSection",
        "RtlLengthRequiredSid",
        "RtlLengthSid",
        "RtlMakeSelfRelativeSD",
        "RtlNtStatusToDosError",
        "RtlSubAuthorityCountSid",
        "RtlSubAuthoritySid",
        "RtlUnicodeStringToInteger",
        "RtlUpcaseUnicodeStringToOemString",
        "RtlValidSid"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 2,
      "functions": [
        "DisableThreadLibraryCalls",
        "GetModuleFileNameW"
      ]
    },
    {
      "lib": "api-ms-win-core-interlocked-l1-1-0.dll",
      "count": 1,
      "functions": [
        "InitializeSListHead"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 10,
      "functions": [
        "RegCloseKey",
        "RegCreateKeyExA",
        "RegCreateKeyExW",
        "RegDeleteKeyExA",
        "RegGetValueW",
        "RegOpenKeyExA",
        "RegOpenKeyExW",
        "RegQueryInfoKeyA",
        "RegQueryValueExW",
        "RegSetValueExA"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-1.dll",
      "count": 1,
      "functions": [
        "IsProcessorFeaturePresent"
      ]
    },
    {
      "lib": "api-ms-win-eventing-obsolete-l1-1-0.dll",
      "count": 1,
      "functions": [
        "RegisterTraceGuidsA"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-1.dll",
      "count": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "api-ms-win-core-localization-l1-2-0.dll",
      "count": 1,
      "functions": [
        "GetSystemPreferredUILanguages"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 1,
      "functions": [
        "CloseHandle"
      ]
    },
    {
      "lib": "api-ms-win-core-string-l1-1-0.dll",
      "count": 1,
      "functions": [
        "GetStringTypeW"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 8,
      "functions": [
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "TerminateProcess",
        "TlsAlloc",
        "TlsFree",
        "TlsGetValue",
        "TlsSetValue"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLastError",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    }
  ],
  "exports": {
    "count": 70,
    "functions": [
      "OnMachineUILanguageInit",
      "SamAddMemberToAlias",
      "SamAddMemberToGroup",
      "SamAddMultipleMembersToAlias",
      "SamChangePasswordUser",
      "SamChangePasswordUser2",
      "SamCloseHandle",
      "SamConnect",
      "SamConnectWithCreds",
      "SamCreateAliasInDomain",
      "SamCreateGroupInDomain",
      "SamCreateUser2InDomain",
      "SamCreateUserInDomain",
      "SamDeleteAlias",
      "SamDeleteGroup",
      "SamDeleteUser",
      "SamEnumerateAliasesInDomain",
      "SamEnumerateDomainsInSamServer",
      "SamEnumerateGroupsInDomain",
      "SamEnumerateUsersInDomain",
      "SamEnumerateUsersInDomain2",
      "SamFreeMemory",
      "SamGetAliasMembership",
      "SamGetCompatibilityMode",
      "SamGetDisplayEnumerationIndex",
      "SamGetGroupsForUser",
      "SamGetMembersInAlias",
      "SamGetMembersInGroup",
      "SamLookupDomainInSamServer",
      "SamLookupIdsInDomain",
      "SamLookupNamesInDomain",
      "SamLookupNamesInDomain2",
      "SamOpenAlias",
      "SamOpenDomain",
      "SamOpenGroup",
      "SamOpenUser",
      "SamPerformGenericOperation",
      "SamQueryDisplayInformation",
      "SamQueryInformationAlias",
      "SamQueryInformationDomain",
      "SamQueryInformationGroup",
      "SamQueryInformationUser",
      "SamQueryLocalizableAccountsInDomain",
      "SamQuerySecurityObject",
      "SamRegisterObjectChangeNotification",
      "SamRemoveMemberFromAlias",
      "SamRemoveMemberFromForeignDomain",
      "SamRemoveMemberFromGroup",
      "SamRemoveMultipleMembersFromAlias",
      "SamRidToSid",
      "SamSetInformationAlias",
      "SamSetInformationDomain",
      "SamSetInformationGroup",
      "SamSetInformationUser",
      "SamSetMemberAttributesOfGroup",
      "SamSetSecurityObject",
      "SamShutdownSamServer",
      "SamTestPrivateFunctionsDomain",
      "SamTestPrivateFunctionsUser",
      "SamUnregisterObjectChangeNotification",
      "SamValidatePassword",
      "SamiChangeKeys",
      "SamiChangePasswordUser",
      "SamiChangePasswordUser2",
      "SamiEncryptPasswords",
      "SamiLmChangePasswordUser",
      "SamiSetBootKeyInformation",
      "SamiSetDSRMPassword",
      "SamiSetDSRMPasswordOWF",
      "SamiSyncDSRMPasswordFromAccount"
    ]
  },
  "hashes": {
    "sha2": "2405f8542f94b00b6b7539fc0632e113b4c2f22644d10883d32c5e9135d5482d",
    "ssdeep": "1536:6C2fu5M/ai6WZD2hauOL6BhMelSruipLpUI6Zu3nCg/rC9AgK00c6aK:Yfu6SW2DOL6kpLF+u3nCgTCSgKTc"
  },
  "intent": {
    "intentions": 4,
    "uniq_apis_matched": 12,
    "results": [
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 3,
        "apis": [
          "RegGetValueW",
          "RegQueryInfoKeyA",
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Queries and Discovers General Attributes From The Target System",
        "tag": "Discovery:T1082 - System Information Discovery",
        "component": "---",
        "inputs": 3,
        "matches": 1,
        "apis": [
          "RtlGetNtProductType"
        ]
      },
      {
        "intent": "Can Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "Memory",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Can Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 6,
        "apis": [
          "RegCreateKeyExA",
          "RegCreateKeyExW",
          "RegDeleteKeyExA",
          "RegOpenKeyExA",
          "RegOpenKeyExW",
          "RegSetValueExA"
        ]
      }
    ]
  }
}