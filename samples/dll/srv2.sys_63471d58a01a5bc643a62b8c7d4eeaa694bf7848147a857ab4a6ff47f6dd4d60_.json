{
  "name": "srv2.sys",
  "path": "\\\\?\\C:\\Windows\\System32\\drivers\\srv2.sys",
  "size": 787968,
  "is_64": true,
  "is_lib": false,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": false,
  "subsystem": 1,
  "subsystem_caption": "Device Drivers And Native Windows processes",
  "libs": [
    "hal.dll",
    "ksecdd.sys",
    "ntoskrnl.exe",
    "srvnet.sys",
    "tdi.sys"
  ],
  "imports": [
    {
      "lib": "hal.dll",
      "count": 1,
      "functions": [
        "KeQueryPerformanceCounter"
      ]
    },
    {
      "lib": "ksecdd.sys",
      "count": 16,
      "functions": [
        "AcceptSecurityContext",
        "BCryptCloseAlgorithmProvider",
        "BCryptCreateHash",
        "BCryptDestroyHash",
        "BCryptDuplicateHash",
        "BCryptFinishHash",
        "BCryptGenRandom",
        "BCryptGetProperty",
        "BCryptHashData",
        "BCryptOpenAlgorithmProvider",
        "DeleteSecurityContext",
        "FreeContextBuffer",
        "ImpersonateSecurityContext",
        "MapSecurityError",
        "QueryContextAttributesW",
        "RevertSecurityContext"
      ]
    },
    {
      "lib": "ntoskrnl.exe",
      "count": 251,
      "functions": [
        "CcMdlWriteAbort",
        "DbgkWerCaptureLiveKernelDump",
        "EtwActivityIdControl",
        "EtwRegister",
        "EtwSetInformation",
        "EtwUnregister",
        "EtwWriteTransfer",
        "ExAcquirePushLockExclusiveEx",
        "ExAcquirePushLockSharedEx",
        "ExAcquireResourceExclusiveLite",
        "ExAcquireResourceSharedLite",
        "ExAcquireRundownProtection",
        "ExAcquireSpinLockExclusive",
        "ExAcquireSpinLockShared",
        "ExAcquireSpinLockSharedAtDpcLevel",
        "ExAllocatePoolWithTag",
        "ExAllocatePoolWithTagPriority",
        "ExAllocateTimer",
        "ExConvertExclusiveToSharedLite",
        "ExDeleteLookasideListEx",
        "ExDeleteResourceLite",
        "ExDeleteTimer",
        "ExFlushLookasideListEx",
        "ExFreePoolWithTag",
        "ExInitializeLookasideListEx",
        "ExInitializeResourceLite",
        "ExInitializeRundownProtection",
        "ExInterlockedAddUlong",
        "ExLocalTimeToSystemTime",
        "ExQueryDepthSList",
        "ExQueueWorkItem",
        "ExReleasePushLockEx",
        "ExReleasePushLockExclusiveEx",
        "ExReleasePushLockSharedEx",
        "ExReleaseResourceLite",
        "ExReleaseRundownProtection",
        "ExReleaseSpinLockExclusive",
        "ExReleaseSpinLockShared",
        "ExReleaseSpinLockSharedFromDpcLevel",
        "ExSetTimer",
        "ExTryAcquirePushLockExclusiveEx",
        "ExWaitForRundownProtectionRelease",
        "ExpInterlockedFlushSList",
        "ExpInterlockedPopEntrySList",
        "ExpInterlockedPushEntrySList",
        "FsRtlAllocateExtraCreateParameter",
        "FsRtlAllocateExtraCreateParameterList",
        "FsRtlDoesNameContainWildCards",
        "FsRtlFindExtraCreateParameter",
        "FsRtlFreeExtraCreateParameter",
        "FsRtlFreeExtraCreateParameterList",
        "FsRtlGetNextExtraCreateParameter",
        "FsRtlGetSupportedFeatures",
        "FsRtlInsertExtraCreateParameter",
        "FsRtlIsEcpAcknowledged",
        "FsRtlRemoveDotsFromPath",
        "FsRtlRemoveExtraCreateParameter",
        "InitializeSListHead",
        "InterlockedPushListSList",
        "IoAllocateIrp",
        "IoAllocateIrpEx",
        "IoAllocateMdl",
        "IoAllocateWorkItem",
        "IoBuildDeviceIoControlRequest",
        "IoBuildPartialMdl",
        "IoCancelIrp",
        "IoCheckEaBufferValidity",
        "IoCheckFunctionAccess",
        "IoCheckQuerySetFileInformation",
        "IoCheckQuerySetVolumeInformation",
        "IoCheckQuotaBufferValidity",
        "IoClearActivityIdThread",
        "IoCreateDevice",
        "IoCreateFile",
        "IoCreateFileEx",
        "IoCreateFileSpecifyDeviceObjectHint",
        "IoCreateNotificationEvent",
        "IoCreateSystemThread",
        "IoDeleteDevice",
        "IoFreeIrp",
        "IoFreeMdl",
        "IoFreeWorkItem",
        "IoGetActivityIdIrp",
        "IoGetBaseFileSystemDeviceObject",
        "IoGetCurrentProcess",
        "IoGetGenericIrpExtension",
        "IoGetRelatedDeviceObject",
        "IoGetRequestorProcess",
        "IoInitializeWorkItem",
        "IoQueueThreadIrp",
        "IoQueueWorkItem",
        "IoQueueWorkItemEx",
        "IoReuseIrp",
        "IoSetActivityIdThread",
        "IoSetFileOrigin",
        "IoSetIoPriorityHint",
        "IoSizeofWorkItem",
        "IoUninitializeWorkItem",
        "IoWMIRegistrationControl",
        "IofCallDriver",
        "IofCompleteRequest",
        "KeAcquireGuardedMutex",
        "KeAcquireInStackQueuedSpinLock",
        "KeAcquireInStackQueuedSpinLockAtDpcLevel",
        "KeAcquireSpinLockAtDpcLevel",
        "KeAcquireSpinLockRaiseToDpc",
        "KeAttachProcess",
        "KeBugCheckEx",
        "KeCancelTimer",
        "KeClearEvent",
        "KeDelayExecutionThread",
        "KeDetachProcess",
        "KeEnterCriticalRegion",
        "KeExpandKernelStackAndCalloutEx",
        "KeGetCurrentNodeNumber",
        "KeInitializeDpc",
        "KeInitializeEvent",
        "KeInitializeGuardedMutex",
        "KeInitializeSpinLock",
        "KeInitializeTimer",
        "KeIsExecutingDpc",
        "KeLeaveCriticalRegion",
        "KeLowerIrql",
        "KeQueryActiveProcessorCountEx",
        "KeQueryHighestNodeNumber",
        "KeQueryMaximumProcessorCountEx",
        "KeQueryNodeActiveAffinity",
        "KeQueryNodeMaximumProcessorCount",
        "KeQueryTimeIncrement",
        "KeQueryUnbiasedInterruptTime",
        "KeReleaseGuardedMutex",
        "KeReleaseInStackQueuedSpinLock",
        "KeReleaseInStackQueuedSpinLockFromDpcLevel",
        "KeReleaseSpinLock",
        "KeReleaseSpinLockFromDpcLevel",
        "KeResetEvent",
        "KeRevertToUserGroupAffinityThread",
        "KeSetCoalescableTimer",
        "KeSetEvent",
        "KeSetPriorityThread",
        "KeSetSystemGroupAffinityThread",
        "KeStackAttachProcess",
        "KeUnstackDetachProcess",
        "KeWaitForMultipleObjects",
        "KeWaitForSingleObject",
        "KfRaiseIrql",
        "LsaCallAuthenticationPackage",
        "LsaDeregisterLogonProcess",
        "LsaFreeReturnBuffer",
        "LsaLookupAuthenticationPackage",
        "LsaRegisterLogonProcess",
        "MmBuildMdlForNonPagedPool",
        "MmGetSystemRoutineAddress",
        "MmMapLockedPagesSpecifyCache",
        "MmMdlPageContentsState",
        "MmSizeOfMdl",
        "MmUnlockPages",
        "MmUnmapLockedPages",
        "NtClose",
        "NtFsControlFile",
        "NtOpenFile",
        "NtQueryEaFile",
        "NtQueryInformationFile",
        "NtQueryQuotaInformationFile",
        "NtQuerySecurityObject",
        "NtQueryVolumeInformationFile",
        "NtSetEaFile",
        "NtSetInformationFile",
        "NtSetInformationThread",
        "NtSetQuotaInformationFile",
        "NtSetSecurityObject",
        "NtSetVolumeInformationFile",
        "ObCloseHandle",
        "ObOpenObjectByPointer",
        "ObReferenceObjectByHandle",
        "ObReferenceObjectByHandleWithTag",
        "ObfDereferenceObject",
        "ObfReferenceObject",
        "PcwAddInstance",
        "PcwCloseInstance",
        "PcwCreateInstance",
        "PcwRegister",
        "PcwUnregister",
        "ProbeForRead",
        "PsAssignImpersonationToken",
        "PsDereferenceImpersonationToken",
        "PsDereferencePrimaryToken",
        "PsGetProcessServerSilo",
        "PsImpersonateClient",
        "PsIsHostSilo",
        "PsIsThreadImpersonating",
        "PsReferenceImpersonationToken",
        "PsRevertToSelf",
        "PsThreadType",
        "RtlAnsiStringToUnicodeString",
        "RtlAppendUnicodeStringToString",
        "RtlAppendUnicodeToString",
        "RtlCaptureStackBackTrace",
        "RtlCompareMemory",
        "RtlCopyUnicodeString",
        "RtlEqualSid",
        "RtlEqualUnicodeString",
        "RtlFreeUnicodeString",
        "RtlGetVersion",
        "RtlHashUnicodeString",
        "RtlInitAnsiString",
        "RtlInitString",
        "RtlInitUnicodeString",
        "RtlInt64ToUnicodeString",
        "RtlLengthRequiredSid",
        "RtlLengthSecurityDescriptor",
        "RtlLengthSid",
        "RtlMapGenericMask",
        "RtlNotifyFeatureUsage",
        "RtlOemStringToUnicodeString",
        "RtlQueryFeatureConfiguration",
        "RtlQueryFeatureConfigurationChangeStamp",
        "RtlRegisterFeatureConfigurationChangeNotification",
        "RtlTimeFieldsToTime",
        "RtlTimeToTimeFields",
        "RtlUnregisterFeatureConfigurationChangeNotification",
        "RtlUpcaseUnicodeChar",
        "RtlUpcaseUnicodeString",
        "RtlValidRelativeSecurityDescriptor",
        "SeCaptureSubjectContext",
        "SeExports",
        "SeFreePrivileges",
        "SeLockSubjectContext",
        "SeQueryAuthenticationIdToken",
        "SeQueryInformationToken",
        "SeReleaseSubjectContext",
        "SeSinglePrivilegeCheck",
        "SeUnlockSubjectContext",
        "ZwClose",
        "ZwCreateEvent",
        "ZwCreateFile",
        "ZwDuplicateObject",
        "ZwFsControlFile",
        "ZwOpenKey",
        "ZwQueryInformationFile",
        "ZwQueryValueKey",
        "ZwQueryVolumeInformationFile",
        "ZwQueryWnfStateData",
        "ZwReadFile",
        "ZwUpdateWnfStateData",
        "ZwWaitForSingleObject",
        "__C_specific_handler",
        "__chkstk",
        "_vsnwprintf",
        "_wcsnicmp",
        "strncmp"
      ]
    },
    {
      "lib": "srvnet.sys",
      "count": 135,
      "functions": [
        "SmbCompressionChainedDecompress",
        "SmbCompressionLegacyDecompress",
        "SmbCryptoCreateApplicationKey",
        "SmbCryptoCreateServerCipherKeys",
        "SmbCryptoCreateSigningKey",
        "SmbCryptoDecrypt",
        "SmbCryptoHashCreate",
        "SmbCryptoHashDestroy",
        "SmbCryptoHashFinish",
        "SmbCryptoHashGetOutputLength",
        "SmbCryptoHashGetRecommendedSaltSize",
        "SmbCryptoHashUpdate",
        "SmbCryptoKeyDereference",
        "SmbCryptoKeyTableCreate",
        "SmbCryptoKeyTableDestroy",
        "SmbCryptoKeyTableFind",
        "SmbCryptoKeyTableInsert",
        "SmbCryptoKeyTableRemove",
        "SmbCryptoReadCipherSuiteOrderPolicySetting",
        "SmbCryptoUpdatePreauthIntegrityHashValue",
        "SrvAdminAllowAnonymousAccess",
        "SrvAdminAllowClusterPipeAccess",
        "SrvAdminDeregisterFile",
        "SrvAdminDeregisterProvider",
        "SrvAdminDeregisterSession",
        "SrvAdminDeregisterTreeConnect",
        "SrvAdminDoesPipeAllowAnonymous",
        "SrvAdminDoesShareAllowAnonymous",
        "SrvAdminEvaluateServerAlias",
        "SrvAdminIsFsctlAllowedForSmb2",
        "SrvAdminIsScopedName",
        "SrvAdminIsScopedNameEx",
        "SrvAdminNodeGetNextId",
        "SrvAdminNodeGetSignature",
        "SrvAdminNodeInitialize",
        "SrvAdminNodeInvalidateFile",
        "SrvAdminNodeInvalidateSession",
        "SrvAdminNodeUninitialize",
        "SrvAdminNodeVerifySignature",
        "SrvAdminQueryResumeKeyTarget",
        "SrvAdminRefreshAllowedServerNameList",
        "SrvAdminRefreshFsctlPropertyList",
        "SrvAdminRefreshPipeList",
        "SrvAdminRegisterFile",
        "SrvAdminRegisterProvider",
        "SrvAdminRegisterSession",
        "SrvAdminRegisterTreeConnect",
        "SrvAdminRemapPipeName",
        "SrvAdminSetSessionIsCsvUser",
        "SrvAdminSetSessionName",
        "SrvAdminTakeActionToAllowPowerDown",
        "SrvAdminUpdateFileSessionID",
        "SrvAdminValidateSpn",
        "SrvLibAllocatePipeEa",
        "SrvLibApplySrvDeviceAcl",
        "SrvLibAuditForceAccess",
        "SrvLibAuditShareAccess",
        "SrvLibAuditShareConnect",
        "SrvLibAuditSuccessEnabled",
        "SrvLibCheckAccess",
        "SrvLibCleanupIdleLogic",
        "SrvLibCloseCredentialHandle",
        "SrvLibCreateCredentialHandle",
        "SrvLibCreateSelfSD",
        "SrvLibFilePowerManagementClose",
        "SrvLibFilePowerManagementPreventIdle",
        "SrvLibFreePipeEa",
        "SrvLibGetBaseFileName",
        "SrvLibGetBinary",
        "SrvLibGetDWord",
        "SrvLibGetSelfSid",
        "SrvLibHasClaimsSentinel",
        "SrvLibInitializeIdleLogic",
        "SrvLibIsAdmin",
        "SrvLibIsAnonymous",
        "SrvLibIsDosDeviceName",
        "SrvLibIsInteractive",
        "SrvLibIsNetwork",
        "SrvLibIsNetworkAddress",
        "SrvLibKeyExists",
        "SrvLibMarkServerAsIdle",
        "SrvLibMarkServerAsNotIdle",
        "SrvLibQueryCredentialHandle",
        "SrvLibQueryLicensingDWord",
        "SrvLibRetrieveMaximalAccessRightsForUser",
        "SrvLibS4U2SelfAuth",
        "SrvLibS4U2SelfCleanup",
        "SrvLibS4U2SelfInitialize",
        "SrvLibSeAccessCheck",
        "SrvLibStandardizeIpAddress",
        "SrvLibTruncateDnsName",
        "SrvLibUpdateIdleLogic",
        "SrvNetAllocateBuffer",
        "SrvNetAllocateBufferNoTransportHeader",
        "SrvNetAllocateStatisticsQueuesEx",
        "SrvNetCheckEndpointState",
        "SrvNetCloseConnection",
        "SrvNetConnectionWillSign",
        "SrvNetDecrementConnectionActiveCount",
        "SrvNetDeregisterClient",
        "SrvNetDisableStatisticsQueue",
        "SrvNetDisconnectConnection",
        "SrvNetFreeBuffer",
        "SrvNetFreePool",
        "SrvNetGetRdmaNicInfo",
        "SrvNetGetServerNameFlags",
        "SrvNetGetStatisticsAndLock",
        "SrvNetHostAddressAndPortToStringA",
        "SrvNetIncrementConnectionActiveCount",
        "SrvNetInitializeStatisticsQueues",
        "SrvNetIsDriverLoaded",
        "SrvNetIsRdmaConnection",
        "SrvNetIsTdiConnection",
        "SrvNetMarkConnectionAuthenticated",
        "SrvNetNotifyClientsUpdateNetname",
        "SrvNetQueryConnectionInformation",
        "SrvNetReadDirectData",
        "SrvNetRegisterClient",
        "SrvNetSendData",
        "SrvNetSetConnectionActiveCount",
        "SrvNetSetConnectionInboundMessageSizeLimit",
        "SrvNetSetConnectionInformation",
        "SrvNetSetConnectionInstanceId",
        "SrvNetSetConnectionServerName",
        "SrvNetStartClient",
        "SrvNetStopClient",
        "SrvNetValidateMemoryDescriptors",
        "SrvNetWriteDirectData",
        "SrvNotifyGroveler",
        "SrvXsAddPrintJob",
        "SrvXsClosePrinter",
        "SrvXsConnect",
        "SrvXsDisconnect",
        "SrvXsOpenPrinter",
        "SrvXsSchedulePrintJob"
      ]
    },
    {
      "lib": "tdi.sys",
      "count": 1,
      "functions": [
        "TdiCopyMdlToBuffer"
      ]
    }
  ],
  "hashes": {
    "sha2": "63471d58a01a5bc643a62b8c7d4eeaa694bf7848147a857ab4a6ff47f6dd4d60",
    "ssdeep": "12288:Px61ax6ZScUkCk0aciXM3c8qlcWsZqJnOeyzj:JUax6oJacDs8qlcWska/"
  },
  "intent": {
    "intentions": 2,
    "uniq_apis_matched": 10,
    "results": [
      {
        "intent": "Queries and Discovers General Attributes From The Target System",
        "tag": "Discovery:T1082 - System Information Discovery",
        "component": "---",
        "inputs": 3,
        "matches": 1,
        "apis": [
          "RtlGetVersion"
        ]
      },
      {
        "intent": "Can Conduct Cryptographic Operations",
        "tag": "Expert Input:IBO.0022 - Windows Cryptography Facilities",
        "component": "Crypto",
        "inputs": 71,
        "matches": 9,
        "apis": [
          "BCryptCloseAlgorithmProvider",
          "BCryptCreateHash",
          "BCryptDestroyHash",
          "BCryptDuplicateHash",
          "BCryptFinishHash",
          "BCryptGenRandom",
          "BCryptGetProperty",
          "BCryptHashData",
          "BCryptOpenAlgorithmProvider"
        ]
      }
    ]
  },
  "os": "win10"
}