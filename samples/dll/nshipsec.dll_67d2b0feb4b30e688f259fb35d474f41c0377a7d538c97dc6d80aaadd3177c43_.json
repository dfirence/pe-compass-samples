{
  "name": "nshipsec.dll",
  "path": "\\\\?\\C:\\Windows\\SysWOW64\\nshipsec.dll",
  "size": 333312,
  "type": "win-pe",
  "is_64": false,
  "is_lib": true,
  "is_dotnet": true,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "activeds.dll",
    "api-ms-win-core-datetime-l1-1-0.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-file-l1-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-string-l1-1-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-security-base-l1-1-0.dll",
    "api-ms-win-service-management-l1-1-0.dll",
    "api-ms-win-service-winsvc-l1-1-0.dll",
    "crypt32.dll",
    "dnsapi.dll",
    "firewallapi.dll",
    "kernel32.dll",
    "msvcrt.dll",
    "netsh.exe",
    "ntdll.dll",
    "ole32.dll",
    "oleaut32.dll",
    "polstore.dll",
    "rpcrt4.dll",
    "userenv.dll",
    "winipsec.dll",
    "wldap32.dll",
    "ws2_32.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-service-winsvc-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryServiceStatus"
      ]
    },
    {
      "lib": "ws2_32.dll",
      "count": 7,
      "functions": [
        "ORDINAL 11",
        "ORDINAL 12",
        "ORDINAL 14",
        "ORDINAL 51",
        "ORDINAL 8",
        "freeaddrinfo",
        "getaddrinfo"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "api-ms-win-security-base-l1-1-0.dll",
      "count": 1,
      "functions": [
        "AdjustTokenPrivileges"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 1,
      "functions": [
        "LoadStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetSystemTimeAsFileTime",
        "GetTickCount"
      ]
    },
    {
      "lib": "crypt32.dll",
      "count": 9,
      "functions": [
        "CertCloseStore",
        "CertEnumCertificatesInStore",
        "CertFindChainInStore",
        "CertFreeCertificateContext",
        "CertGetCertificateContextProperty",
        "CertGetEnhancedKeyUsage",
        "CertNameToStrW",
        "CertOpenStore",
        "CertStrToNameW"
      ]
    },
    {
      "lib": "api-ms-win-core-datetime-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetDateFormatW",
        "GetTimeFormatW"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 34,
      "functions": [
        "_CIpow",
        "_XcptFilter",
        "__dllonexit",
        "_amsg_exit",
        "_callnewh",
        "_except_handler4_common",
        "_initterm",
        "_lock",
        "_onexit",
        "_unlock",
        "_vsnprintf",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "_wremove",
        "calloc",
        "free",
        "isdigit",
        "iswdigit",
        "malloc",
        "memcpy",
        "memmove",
        "memset",
        "swscanf",
        "swscanf_s",
        "time",
        "wcschr",
        "wcsncmp",
        "wcsrchr",
        "wcsspn",
        "wcsstr",
        "wcstok",
        "wcstoul",
        "wprintf"
      ]
    },
    {
      "lib": "dnsapi.dll",
      "count": 1,
      "functions": [
        "DnsValidateName_W"
      ]
    },
    {
      "lib": "api-ms-win-service-management-l1-1-0.dll",
      "count": 3,
      "functions": [
        "CloseServiceHandle",
        "OpenSCManagerW",
        "OpenServiceW"
      ]
    },
    {
      "lib": "api-ms-win-core-file-l1-1-0.dll",
      "count": 1,
      "functions": [
        "FileTimeToLocalFileTime"
      ]
    },
    {
      "lib": "wldap32.dll",
      "count": 2,
      "functions": [
        "ORDINAL 122",
        "ORDINAL 224"
      ]
    },
    {
      "lib": "userenv.dll",
      "count": 2,
      "functions": [
        "FreeGPOListW",
        "GetAppliedGPOListW"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 3,
      "functions": [
        "ORDINAL 2",
        "ORDINAL 6",
        "ORDINAL 9"
      ]
    },
    {
      "lib": "polstore.dll",
      "count": 43,
      "functions": [
        "IPSecAssignPolicy",
        "IPSecClosePolicyStore",
        "IPSecCopyFilterData",
        "IPSecCopyNFAData",
        "IPSecCopyNegPolData",
        "IPSecCopyPolicyData",
        "IPSecCreateFilterData",
        "IPSecCreateISAKMPData",
        "IPSecCreateNFAData",
        "IPSecCreateNegPolData",
        "IPSecCreatePolicyData",
        "IPSecDeleteFilterData",
        "IPSecDeleteISAKMPData",
        "IPSecDeleteNFAData",
        "IPSecDeleteNegPolData",
        "IPSecDeletePolicyData",
        "IPSecEnumFilterData",
        "IPSecEnumNFAData",
        "IPSecEnumNegPolData",
        "IPSecEnumPolicyData",
        "IPSecExportPolicies",
        "IPSecFreeFilterData",
        "IPSecFreeFilterSpec",
        "IPSecFreeMulFilterData",
        "IPSecFreeMulNegPolData",
        "IPSecFreeMulPolicyData",
        "IPSecFreeNegPolData",
        "IPSecFreePolicyData",
        "IPSecGetAssignedPolicyData",
        "IPSecGetFilterData",
        "IPSecGetISAKMPData",
        "IPSecGetNegPolData",
        "IPSecImportPolicies",
        "IPSecIsDomainPolicyAssigned",
        "IPSecOpenPolicyStore",
        "IPSecSetFilterData",
        "IPSecSetISAKMPData",
        "IPSecSetNFAData",
        "IPSecSetNegPolData",
        "IPSecSetPolicyData",
        "IPSecUnassignPolicy",
        "RegCreateNFAData",
        "RegCreatePolicyData"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 6,
      "functions": [
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegOpenKeyExW",
        "RegQueryValueExW",
        "RegRestoreKeyW",
        "RegSetValueExW"
      ]
    },
    {
      "lib": "winipsec.dll",
      "count": 41,
      "functions": [
        "ORDINAL 22",
        "ORDINAL 24",
        "ORDINAL 28",
        "ORDINAL 29",
        "ORDINAL 30",
        "ORDINAL 31",
        "ORDINAL 32",
        "ORDINAL 33",
        "ORDINAL 34",
        "ORDINAL 35",
        "ORDINAL 36",
        "ORDINAL 37",
        "ORDINAL 39",
        "ORDINAL 45",
        "ORDINAL 46",
        "ORDINAL 47",
        "ORDINAL 48",
        "ORDINAL 49",
        "ORDINAL 51",
        "ORDINAL 55",
        "ORDINAL 57",
        "ORDINAL 61",
        "ORDINAL 62",
        "ORDINAL 63",
        "ORDINAL 64",
        "ORDINAL 65",
        "ORDINAL 66",
        "ORDINAL 70",
        "ORDINAL 72",
        "ORDINAL 73",
        "ORDINAL 74",
        "ORDINAL 78",
        "ORDINAL 79",
        "ORDINAL 84",
        "ORDINAL 85",
        "ORDINAL 86",
        "ORDINAL 87",
        "ORDINAL 90",
        "ORDINAL 91",
        "ORDINAL 92",
        "ORDINAL 93"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "firewallapi.dll",
      "count": 1,
      "functions": [
        "FwEmptyWFAddresses"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 6,
      "functions": [
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "OpenProcessToken",
        "OpenThreadToken",
        "TerminateProcess"
      ]
    },
    {
      "lib": "ole32.dll",
      "count": 5,
      "functions": [
        "CoCreateInstance",
        "CoInitialize",
        "CoTaskMemAlloc",
        "CoTaskMemFree",
        "StringFromGUID2"
      ]
    },
    {
      "lib": "api-ms-win-core-string-l1-1-0.dll",
      "count": 1,
      "functions": [
        "WideCharToMultiByte"
      ]
    },
    {
      "lib": "activeds.dll",
      "count": 5,
      "functions": [
        "ORDINAL 14",
        "ORDINAL 15",
        "ORDINAL 17",
        "ORDINAL 18",
        "ORDINAL 3"
      ]
    },
    {
      "lib": "netsh.exe",
      "count": 7,
      "functions": [
        "MatchEnumTag",
        "MatchTagsInCmdLine",
        "MatchToken",
        "PreprocessCommand",
        "PrintMessageFromModule",
        "RegisterContext",
        "RegisterHelper"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 15,
      "functions": [
        "CloseHandle",
        "DelayLoadFailureHook",
        "FileTimeToSystemTime",
        "FormatMessageW",
        "GetComputerNameW",
        "GetCurrentThread",
        "GetProcessHeap",
        "HeapAlloc",
        "HeapFree",
        "LocalAlloc",
        "LocalFree",
        "RegDeleteKeyExW",
        "RegEnumKeyExW",
        "ResolveDelayLoadedAPI",
        "Sleep"
      ]
    },
    {
      "lib": "rpcrt4.dll",
      "count": 5,
      "functions": [
        "UuidCompare",
        "UuidCreate",
        "UuidCreateNil",
        "UuidFromStringW",
        "UuidIsNil"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 12,
      "functions": [
        "EtwGetTraceEnableFlags",
        "EtwGetTraceEnableLevel",
        "EtwGetTraceLoggerHandle",
        "EtwRegisterTraceGuidsW",
        "EtwTraceMessage",
        "EtwUnregisterTraceGuids",
        "RtlCompareMemory",
        "RtlIpv4AddressToStringExW",
        "RtlIpv4StringToAddressW",
        "RtlIpv6AddressToStringExW",
        "RtlIpv6StringToAddressW",
        "RtlNtStatusToDosError"
      ]
    }
  ],
  "exports": {
    "count": 1,
    "functions": [
      "InitHelperDll"
    ]
  },
  "hashes": {
    "sha2": "67d2b0feb4b30e688f259fb35d474f41c0377a7d538c97dc6d80aaadd3177c43",
    "ssdeep": "6144:VKsiOqPqxII5IT+1yhY+BWiWP8Lb9xZO3UhyzyUmswnLTgVS:wqI7TEybPnLb9mEhyzL1wnwM"
  },
  "intent": {
    "intentions": 10,
    "uniq_apis_matched": 18,
    "results": [
      {
        "intent": "Can Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "Memory",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "AdjustTokenPrivileges"
        ]
      },
      {
        "intent": "Can Enumerate The Windows Registry",
        "tag": "Expert Input:IBO.0009 - Enumerate The Windows Registry",
        "component": "Registry",
        "inputs": 6,
        "matches": 1,
        "apis": [
          "RegEnumKeyExW"
        ]
      },
      {
        "intent": "Can Work With The TCP Network Protocol",
        "tag": "Expert Input:IBO.00012 - Network TCP Sockets",
        "component": "Networking",
        "inputs": 15,
        "matches": 1,
        "apis": [
          "freeaddrinfo"
        ]
      },
      {
        "intent": "Can Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 4,
        "apis": [
          "RegCreateKeyExW",
          "RegDeleteKeyExW",
          "RegOpenKeyExW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 1,
        "apis": [
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Can Conduct DNS Queries",
        "tag": "Expert Input:IBO.00014 - Network Layer-7 DNS Usage",
        "component": "Networking",
        "inputs": 31,
        "matches": 2,
        "apis": [
          "DnsValidateName_W",
          "getaddrinfo"
        ]
      },
      {
        "intent": "Can Enumerate/Discover System Services And Their Configuration Data",
        "tag": "Expert Input:IBO.0006 - Enumerate System Services",
        "component": "Services",
        "inputs": 28,
        "matches": 3,
        "apis": [
          "OpenSCManagerW",
          "OpenServiceW",
          "QueryServiceStatus"
        ]
      },
      {
        "intent": "Can Create/Manipulate System Services",
        "tag": "Expert Input:IBO.0007 - Create/Manipulate System Services",
        "component": "Services",
        "inputs": 19,
        "matches": 1,
        "apis": [
          "CloseServiceHandle"
        ]
      },
      {
        "intent": "Can Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      }
    ]
  }
}