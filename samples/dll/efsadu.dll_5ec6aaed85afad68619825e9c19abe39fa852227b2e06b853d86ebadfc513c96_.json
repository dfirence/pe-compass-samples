{
  "name": "efsadu.dll",
  "path": "\\\\?\\C:\\Windows\\SysWOW64\\efsadu.dll",
  "size": 109056,
  "is_64": false,
  "is_lib": true,
  "is_dotnet": true,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 2,
  "subsystem_caption": "The Windows Graphical User Interface (GUI) Subsystem",
  "libs": [
    "advapi32.dll",
    "api-ms-win-core-com-l1-1-0.dll",
    "api-ms-win-core-debug-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-1.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-file-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-libraryloader-l1-2-1.dll",
    "api-ms-win-core-localization-l1-2-0.dll",
    "api-ms-win-core-processenvironment-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-synch-l1-1-0.dll",
    "api-ms-win-core-synch-l1-2-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-eventing-provider-l1-1-0.dll",
    "api-ms-win-security-base-l1-1-0.dll",
    "api-ms-win-security-credentials-l1-1-0.dll",
    "api-ms-win-service-management-l1-1-0.dll",
    "api-ms-win-service-management-l2-1-0.dll",
    "credui.dll",
    "crypt32.dll",
    "cryptui.dll",
    "dsrole.dll",
    "efsutil.dll",
    "feclient.dll",
    "kernel32.dll",
    "logoncli.dll",
    "mfc42u.dll",
    "msvcrt.dll",
    "netutils.dll",
    "ntdll.dll",
    "ole32.dll",
    "oleaut32.dll",
    "rpcrt4.dll",
    "shell32.dll",
    "shlwapi.dll",
    "urlmon.dll",
    "user32.dll",
    "userenv.dll",
    "vaultcli.dll",
    "wldap32.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-1.dll",
      "count": 2,
      "functions": [
        "LoadLibraryA",
        "LoadLibraryW"
      ]
    },
    {
      "lib": "api-ms-win-core-processenvironment-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetCurrentDirectoryW",
        "SetCurrentDirectoryW"
      ]
    },
    {
      "lib": "credui.dll",
      "count": 3,
      "functions": [
        "CredPackAuthenticationBufferW",
        "CredUIPromptForWindowsCredentialsW",
        "CredUnPackAuthenticationBufferW"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 8,
      "functions": [
        "CreateThread",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "OpenProcessToken",
        "OpenThreadToken",
        "TerminateProcess"
      ]
    },
    {
      "lib": "rpcrt4.dll",
      "count": 5,
      "functions": [
        "RpcStringFreeW",
        "UuidCreate",
        "UuidCreateNil",
        "UuidFromStringW",
        "UuidToStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-localization-l1-2-0.dll",
      "count": 4,
      "functions": [
        "FormatMessageW",
        "GetLocaleInfoEx",
        "GetUserPreferredUILanguages",
        "IdnToAscii"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 29,
      "functions": [
        "??0exception@@QAE@ABV0@@Z",
        "??0exception@@QAE@XZ",
        "??1exception@@UAE@XZ",
        "??1type_info@@UAE@XZ",
        "??_V@YAXPAX@Z",
        "_CxxThrowException",
        "_XcptFilter",
        "__CxxFrameHandler3",
        "__dllonexit",
        "_amsg_exit",
        "_except_handler4_common",
        "_initterm",
        "_lock",
        "_ltow_s",
        "_onexit",
        "_unlock",
        "_vsnprintf_s",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "free",
        "malloc",
        "memcmp",
        "memcpy",
        "memcpy_s",
        "memmove",
        "memset",
        "toupper",
        "wcsncmp"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-1-0.dll",
      "count": 10,
      "functions": [
        "AcquireSRWLockExclusive",
        "CreateMutexExW",
        "CreateSemaphoreExW",
        "OpenEventW",
        "OpenSemaphoreW",
        "ReleaseMutex",
        "ReleaseSRWLockExclusive",
        "ReleaseSemaphore",
        "WaitForSingleObject",
        "WaitForSingleObjectEx"
      ]
    },
    {
      "lib": "api-ms-win-security-credentials-l1-1-0.dll",
      "count": 2,
      "functions": [
        "CredFree",
        "CredMarshalCredentialW"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-0.dll",
      "count": 1,
      "functions": [
        "Sleep"
      ]
    },
    {
      "lib": "dsrole.dll",
      "count": 2,
      "functions": [
        "DsRoleFreeMemory",
        "DsRoleGetPrimaryDomainInformation"
      ]
    },
    {
      "lib": "cryptui.dll",
      "count": 2,
      "functions": [
        "CryptUIDlgSelectCertificateW",
        "CryptUIWizExport"
      ]
    },
    {
      "lib": "ole32.dll",
      "count": 1,
      "functions": [
        "CoInitialize"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-1.dll",
      "count": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 3,
      "functions": [
        "ORDINAL 149",
        "ORDINAL 2",
        "ORDINAL 6"
      ]
    },
    {
      "lib": "api-ms-win-core-debug-l1-1-0.dll",
      "count": 4,
      "functions": [
        "DebugBreak",
        "IsDebuggerPresent",
        "OutputDebugStringA",
        "OutputDebugStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetProcessHeap",
        "HeapAlloc",
        "HeapFree"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 5,
      "functions": [
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegOpenKeyExW",
        "RegQueryValueExW",
        "RegSetValueExW"
      ]
    },
    {
      "lib": "api-ms-win-core-file-l1-1-0.dll",
      "count": 5,
      "functions": [
        "FindClose",
        "FindFirstFileExW",
        "FindNextFileW",
        "GetFileAttributesW",
        "GetFullPathNameW"
      ]
    },
    {
      "lib": "vaultcli.dll",
      "count": 4,
      "functions": [
        "VaultCloseVault",
        "VaultFree",
        "VaultGetItem",
        "VaultOpenVault"
      ]
    },
    {
      "lib": "feclient.dll",
      "count": 4,
      "functions": [
        "EfsClientFreeKeyInfo",
        "EfsClientFreeProtectorList",
        "EfsClientGetKeyInfo",
        "EfsClientQueryProtectors"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 8,
      "functions": [
        "DeleteCriticalSection",
        "EnterCriticalSection",
        "FreeLibrary",
        "GetComputerNameW",
        "InitializeCriticalSection",
        "LeaveCriticalSection",
        "LoadLibraryExW",
        "lstrlenW"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 1,
      "functions": [
        "CloseHandle"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "lib": "efsutil.dll",
      "count": 11,
      "functions": [
        "EfsUtilApplyGroupPolicy",
        "EfsUtilCheckCurrentKeyCapabilities",
        "EfsUtilCreateSelfSignedCertificate",
        "EfsUtilGetCertContextFromCertHash",
        "EfsUtilGetCurrentKey",
        "EfsUtilGetCurrentUserInformation",
        "EfsUtilGetSmartcardProviderName",
        "EfsUtilGetUserKey",
        "EfsUtilReleaseUserKey",
        "EfsUtilSetSmartcardPin",
        "EfsUtilSmartcardCredsNeededError"
      ]
    },
    {
      "lib": "urlmon.dll",
      "count": 1,
      "functions": [
        "CreateUri"
      ]
    },
    {
      "lib": "api-ms-win-service-management-l2-1-0.dll",
      "count": 1,
      "functions": [
        "ChangeServiceConfigW"
      ]
    },
    {
      "lib": "api-ms-win-security-base-l1-1-0.dll",
      "count": 5,
      "functions": [
        "CheckTokenMembership",
        "CopySid",
        "EqualSid",
        "GetLengthSid",
        "GetTokenInformation"
      ]
    },
    {
      "lib": "api-ms-win-service-management-l1-1-0.dll",
      "count": 3,
      "functions": [
        "CloseServiceHandle",
        "OpenSCManagerW",
        "OpenServiceW"
      ]
    },
    {
      "lib": "shell32.dll",
      "count": 6,
      "functions": [
        "ORDINAL 155",
        "ORDINAL 190",
        "SHChangeNotifySuspendResume",
        "SHCreateItemFromParsingName",
        "SHGetFolderPathW",
        "Shell_NotifyIconW"
      ]
    },
    {
      "lib": "wldap32.dll",
      "count": 10,
      "functions": [
        "ORDINAL 13",
        "ORDINAL 140",
        "ORDINAL 16",
        "ORDINAL 170",
        "ORDINAL 18",
        "ORDINAL 208",
        "ORDINAL 224",
        "ORDINAL 26",
        "ORDINAL 41",
        "ORDINAL 73"
      ]
    },
    {
      "lib": "shlwapi.dll",
      "count": 2,
      "functions": [
        "ORDINAL 278",
        "StrDupW"
      ]
    },
    {
      "lib": "api-ms-win-core-com-l1-1-0.dll",
      "count": 5,
      "functions": [
        "CoCreateInstance",
        "CoInitializeEx",
        "CoTaskMemAlloc",
        "CoTaskMemFree",
        "CoUninitialize"
      ]
    },
    {
      "lib": "crypt32.dll",
      "count": 21,
      "functions": [
        "CertAddCertificateContextToStore",
        "CertAddCertificateLinkToStore",
        "CertCloseStore",
        "CertCreateCertificateContext",
        "CertEnumCertificatesInStore",
        "CertFindCertificateInStore",
        "CertFindExtension",
        "CertFreeCertificateChain",
        "CertFreeCertificateContext",
        "CertGetCertificateChain",
        "CertGetCertificateContextProperty",
        "CertGetEnhancedKeyUsage",
        "CertGetNameStringW",
        "CertOpenStore",
        "CertSetCertificateContextProperty",
        "CertVerifyCertificateChainPolicy",
        "CertVerifyTimeValidity",
        "CryptBinaryToStringW",
        "CryptDecodeObject",
        "CryptEncodeObjectEx",
        "CryptStringToBinaryW"
      ]
    },
    {
      "lib": "user32.dll",
      "count": 14,
      "functions": [
        "DefWindowProcW",
        "DestroyWindow",
        "DispatchMessageW",
        "EnableWindow",
        "GetClientRect",
        "GetMessageW",
        "KillTimer",
        "LoadIconW",
        "MessageBoxW",
        "PostMessageW",
        "PostQuitMessage",
        "SendMessageW",
        "SetTimer",
        "TranslateMessage"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 7,
      "functions": [
        "GetModuleFileNameA",
        "GetModuleFileNameW",
        "GetModuleHandleA",
        "GetModuleHandleExW",
        "GetModuleHandleW",
        "GetProcAddress",
        "LoadStringW"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 4,
      "functions": [
        "NtQueryInformationToken",
        "RtlAllocateAndInitializeSid",
        "RtlFreeSid",
        "RtlNtStatusToDosError"
      ]
    },
    {
      "lib": "netutils.dll",
      "count": 1,
      "functions": [
        "NetApiBufferFree"
      ]
    },
    {
      "lib": "userenv.dll",
      "count": 1,
      "functions": [
        "RefreshPolicy"
      ]
    },
    {
      "lib": "mfc42u.dll",
      "count": 126,
      "functions": [
        "ORDINAL 1089",
        "ORDINAL 1115",
        "ORDINAL 1144",
        "ORDINAL 1165",
        "ORDINAL 1179",
        "ORDINAL 1194",
        "ORDINAL 1240",
        "ORDINAL 1248",
        "ORDINAL 1250",
        "ORDINAL 1563",
        "ORDINAL 1568",
        "ORDINAL 1570",
        "ORDINAL 1571",
        "ORDINAL 1720",
        "ORDINAL 1767",
        "ORDINAL 1768",
        "ORDINAL 2047",
        "ORDINAL 2116",
        "ORDINAL 2294",
        "ORDINAL 2377",
        "ORDINAL 2388",
        "ORDINAL 2438",
        "ORDINAL 2504",
        "ORDINAL 2506",
        "ORDINAL 2546",
        "ORDINAL 2567",
        "ORDINAL 2574",
        "ORDINAL 2606",
        "ORDINAL 2634",
        "ORDINAL 2640",
        "ORDINAL 269",
        "ORDINAL 2717",
        "ORDINAL 2859",
        "ORDINAL 2910",
        "ORDINAL 2971",
        "ORDINAL 2977",
        "ORDINAL 2980",
        "ORDINAL 3074",
        "ORDINAL 3076",
        "ORDINAL 3131",
        "ORDINAL 3142",
        "ORDINAL 324",
        "ORDINAL 3254",
        "ORDINAL 3257",
        "ORDINAL 3296",
        "ORDINAL 3341",
        "ORDINAL 3365",
        "ORDINAL 3397",
        "ORDINAL 342",
        "ORDINAL 3569",
        "ORDINAL 3592",
        "ORDINAL 3635",
        "ORDINAL 3733",
        "ORDINAL 3744",
        "ORDINAL 3793",
        "ORDINAL 3820",
        "ORDINAL 3825",
        "ORDINAL 3826",
        "ORDINAL 3917",
        "ORDINAL 3991",
        "ORDINAL 4073",
        "ORDINAL 4074",
        "ORDINAL 4075",
        "ORDINAL 4155",
        "ORDINAL 4219",
        "ORDINAL 4229",
        "ORDINAL 4269",
        "ORDINAL 4279",
        "ORDINAL 4347",
        "ORDINAL 4370",
        "ORDINAL 4390",
        "ORDINAL 4396",
        "ORDINAL 4401",
        "ORDINAL 4418",
        "ORDINAL 4419",
        "ORDINAL 4435",
        "ORDINAL 4459",
        "ORDINAL 4480",
        "ORDINAL 4616",
        "ORDINAL 4621",
        "ORDINAL 4692",
        "ORDINAL 4704",
        "ORDINAL 4831",
        "ORDINAL 4847",
        "ORDINAL 4992",
        "ORDINAL 5059",
        "ORDINAL 5157",
        "ORDINAL 5193",
        "ORDINAL 5237",
        "ORDINAL 5257",
        "ORDINAL 5261",
        "ORDINAL 5273",
        "ORDINAL 5276",
        "ORDINAL 5285",
        "ORDINAL 5286",
        "ORDINAL 5296",
        "ORDINAL 5298",
        "ORDINAL 5303",
        "ORDINAL 540",
        "ORDINAL 5568",
        "ORDINAL 561",
        "ORDINAL 567",
        "ORDINAL 5710",
        "ORDINAL 5727",
        "ORDINAL 5949",
        "ORDINAL 5977",
        "ORDINAL 600",
        "ORDINAL 6003",
        "ORDINAL 6048",
        "ORDINAL 6051",
        "ORDINAL 609",
        "ORDINAL 6195",
        "ORDINAL 6211",
        "ORDINAL 6370",
        "ORDINAL 6371",
        "ORDINAL 6372",
        "ORDINAL 641",
        "ORDINAL 6466",
        "ORDINAL 693",
        "ORDINAL 800",
        "ORDINAL 815",
        "ORDINAL 818",
        "ORDINAL 823",
        "ORDINAL 825",
        "ORDINAL 826",
        "ORDINAL 861"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetSystemTimeAsFileTime",
        "GetTickCount"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLastError",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "logoncli.dll",
      "count": 1,
      "functions": [
        "DsGetDcNameW"
      ]
    },
    {
      "lib": "api-ms-win-eventing-provider-l1-1-0.dll",
      "count": 6,
      "functions": [
        "EventEnabled",
        "EventProviderEnabled",
        "EventRegister",
        "EventSetInformation",
        "EventUnregister",
        "EventWrite"
      ]
    },
    {
      "lib": "advapi32.dll",
      "count": 16,
      "functions": [
        "AddUsersToEncryptedFile",
        "ConvertStringSidToSidW",
        "CryptSetProvParam",
        "EncryptFileW",
        "EventWriteTransfer",
        "FreeEncryptionCertificateHashList",
        "LsaClose",
        "LsaFreeMemory",
        "LsaLookupSids",
        "LsaOpenPolicy",
        "QueryRecoveryAgentsOnEncryptedFile",
        "QueryUsersOnEncryptedFile",
        "RegGetValueW",
        "RemoveUsersFromEncryptedFile",
        "SetUserFileEncryptionKeyEx",
        "UsePinForEncryptedFilesW"
      ]
    }
  ],
  "exports": {
    "count": 14,
    "functions": [
      "AddUserToObjectW",
      "BackCurrentEfsCert",
      "EfsDetail",
      "EfsUIUtilCheckScardStatus",
      "EfsUIUtilCreateSelfSignedCertificate",
      "EfsUIUtilEncryptMyDocuments",
      "EfsUIUtilEnrollEfsCertificate",
      "EfsUIUtilEnrollEfsCertificateEx",
      "EfsUIUtilInstallDra",
      "EfsUIUtilKeyBackup",
      "EfsUIUtilPromptForPin",
      "EfsUIUtilPromptForPinDialog",
      "EfsUIUtilSelectCard",
      "EfsUIUtilShowBalloonAndWait"
    ]
  },
  "hashes": {
    "sha2": "5ec6aaed85afad68619825e9c19abe39fa852227b2e06b853d86ebadfc513c96",
    "ssdeep": "1536:De9uFuQqBbkDQpr+37TVDvsegSM+8FjNeLT+B45cIUVax1Ix3DkvvvvvvvvvvvvV:DfFuQqBbkDQCvsoT+B45AUqxzBNv5w"
  },
  "intent": {
    "intentions": 8,
    "uniq_apis_matched": 16,
    "results": [
      {
        "intent": "Has Ability To Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "Memory",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate System Services",
        "tag": "Expert Input:IBO.0007 - Create/Manipulate System Services",
        "component": "Services",
        "inputs": 19,
        "matches": 1,
        "apis": [
          "CloseServiceHandle"
        ]
      },
      {
        "intent": "Has Ability To Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 3,
        "apis": [
          "CheckTokenMembership",
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 3,
        "apis": [
          "RegCreateKeyExW",
          "RegOpenKeyExW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Discovers Configuration Attributes of the Windows Enterprise Domain",
        "tag": "Reconnaissance:T1590.001 - Domain Properties (Windows Enterprise)",
        "component": "---",
        "inputs": 24,
        "matches": 2,
        "apis": [
          "DsGetDcNameW",
          "DsRoleGetPrimaryDomainInformation"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileExW"
        ]
      },
      {
        "intent": "Has Ability To Enumerate/Discover System Services And Their Configuration Data",
        "tag": "Expert Input:IBO.0006 - Enumerate System Services",
        "component": "Services",
        "inputs": 28,
        "matches": 2,
        "apis": [
          "OpenSCManagerW",
          "OpenServiceW"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 2,
        "apis": [
          "RegGetValueW",
          "RegQueryValueExW"
        ]
      }
    ]
  }
}