{
  "name": "winsta.dll",
  "path": "\\\\?\\C:\\Windows\\System32\\winsta.dll",
  "size": 351200,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "api-ms-win-core-debug-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-1.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-kernel32-legacy-l1-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-processenvironment-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-1.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-synch-l1-1-0.dll",
    "api-ms-win-core-synch-l1-2-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-core-threadpool-legacy-l1-1-0.dll",
    "api-ms-win-eventing-classicprovider-l1-1-0.dll",
    "api-ms-win-eventing-provider-l1-1-0.dll",
    "kernelbase.dll",
    "msvcrt.dll",
    "ntdll.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-core-delayload-l1-1-1.dll",
      "count": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "lib": "api-ms-win-eventing-provider-l1-1-0.dll",
      "count": 4,
      "functions": [
        "EventRegister",
        "EventSetInformation",
        "EventUnregister",
        "EventWriteTransfer"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 3,
      "functions": [
        "RegCloseKey",
        "RegOpenKeyExW",
        "RegQueryValueExW"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLastError",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "api-ms-win-core-threadpool-legacy-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueueUserWorkItem"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-1.dll",
      "count": 1,
      "functions": [
        "GetProcessMitigationPolicy"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 10,
      "functions": [
        "CreateThread",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "GetExitCodeThread",
        "OpenProcessToken",
        "OpenThreadToken",
        "ProcessIdToSessionId",
        "TerminateProcess"
      ]
    },
    {
      "lib": "api-ms-win-core-processenvironment-l1-1-0.dll",
      "count": 1,
      "functions": [
        "ExpandEnvironmentStringsW"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 7,
      "functions": [
        "DisableThreadLibraryCalls",
        "FreeLibrary",
        "GetModuleFileNameW",
        "GetModuleHandleExA",
        "GetModuleHandleExW",
        "GetProcAddress",
        "LoadLibraryExW"
      ]
    },
    {
      "lib": "api-ms-win-core-debug-l1-1-0.dll",
      "count": 1,
      "functions": [
        "OutputDebugStringA"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 2,
      "functions": [
        "CloseHandle",
        "DuplicateHandle"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 28,
      "functions": [
        "EtwEventUnregister",
        "NtClose",
        "NtOpenProcess",
        "NtOpenProcessToken",
        "NtQueryInformationProcess",
        "NtQueryInformationToken",
        "NtQuerySystemInformation",
        "NtQuerySystemTime",
        "NtTerminateProcess",
        "RtlAdjustPrivilege",
        "RtlAllocateAndInitializeSid",
        "RtlCaptureContext",
        "RtlCaptureStackBackTrace",
        "RtlCopySid",
        "RtlDeleteCriticalSection",
        "RtlEnterCriticalSection",
        "RtlFreeSid",
        "RtlGetSuiteMask",
        "RtlInitializeCriticalSection",
        "RtlLeaveCriticalSection",
        "RtlLengthSid",
        "RtlLookupFunctionEntry",
        "RtlMultiByteToUnicodeN",
        "RtlNtStatusToDosError",
        "RtlUnicodeToMultiByteN",
        "RtlUnicodeToMultiByteSize",
        "RtlValidSid",
        "RtlVirtualUnwind"
      ]
    },
    {
      "lib": "api-ms-win-core-kernel32-legacy-l1-1-0.dll",
      "count": 1,
      "functions": [
        "GetComputerNameW"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 33,
      "functions": [
        "??0exception@@QEAA@AEBQEBD@Z",
        "??0exception@@QEAA@AEBQEBDH@Z",
        "??0exception@@QEAA@AEBV0@@Z",
        "??1exception@@UEAA@XZ",
        "??1type_info@@UEAA@XZ",
        "??3@YAXPEAX@Z",
        "??_V@YAXPEAX@Z",
        "?what@exception@@UEBAPEBDXZ",
        "_CxxThrowException",
        "_XcptFilter",
        "__C_specific_handler",
        "__CxxFrameHandler3",
        "__dllonexit",
        "_amsg_exit",
        "_callnewh",
        "_initterm",
        "_lock",
        "_onexit",
        "_purecall",
        "_resetstkoflw",
        "_unlock",
        "_vsnprintf",
        "_vsnwprintf",
        "_wcsicmp",
        "free",
        "malloc",
        "memcpy",
        "memmove",
        "memset",
        "rand",
        "srand",
        "time",
        "wcscmp"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-1-0.dll",
      "count": 8,
      "functions": [
        "CreateEventW",
        "DeleteCriticalSection",
        "EnterCriticalSection",
        "InitializeCriticalSection",
        "LeaveCriticalSection",
        "OpenEventW",
        "SetEvent",
        "WaitForSingleObject"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetSystemTimeAsFileTime",
        "GetTickCount"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-0.dll",
      "count": 1,
      "functions": [
        "Sleep"
      ]
    },
    {
      "lib": "api-ms-win-eventing-classicprovider-l1-1-0.dll",
      "count": 1,
      "functions": [
        "TraceMessage"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetProcessHeap",
        "HeapAlloc",
        "HeapFree"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    },
    {
      "lib": "kernelbase.dll",
      "count": 1,
      "functions": [
        "WTSGetServiceSessionId"
      ]
    }
  ],
  "exports": {
    "count": 175,
    "functions": [
      "LogonIdFromWinStationNameA",
      "LogonIdFromWinStationNameW",
      "RemoteAssistancePrepareSystemRestore",
      "ServerGetInternetConnectorStatus",
      "ServerLicensingClose",
      "ServerLicensingDeactivateCurrentPolicy",
      "ServerLicensingFreePolicyInformation",
      "ServerLicensingGetAadInfo",
      "ServerLicensingGetAvailablePolicyIds",
      "ServerLicensingGetPolicy",
      "ServerLicensingGetPolicyInformationA",
      "ServerLicensingGetPolicyInformationW",
      "ServerLicensingLoadPolicy",
      "ServerLicensingOpenA",
      "ServerLicensingOpenW",
      "ServerLicensingSetAadInfo",
      "ServerLicensingSetPolicy",
      "ServerLicensingUnloadPolicy",
      "ServerQueryInetConnectorInformationA",
      "ServerQueryInetConnectorInformationW",
      "ServerSetInternetConnectorStatus",
      "WTSRegisterSessionNotificationEx",
      "WTSUnRegisterSessionNotificationEx",
      "WinStationActivateLicense",
      "WinStationAutoReconnect",
      "WinStationBroadcastSystemMessage",
      "WinStationCheckAccess",
      "WinStationCheckLoopBack",
      "WinStationCloseServer",
      "WinStationConnectA",
      "WinStationConnectAndLockDesktop",
      "WinStationConnectCallback",
      "WinStationConnectEx",
      "WinStationConnectW",
      "WinStationConsumeCacheSession",
      "WinStationCreateChildSessionTransport",
      "WinStationDisconnect",
      "WinStationEnableChildSessions",
      "WinStationEnumerateA",
      "WinStationEnumerateContainerSessions",
      "WinStationEnumerateExW",
      "WinStationEnumerateLicenses",
      "WinStationEnumerateProcesses",
      "WinStationEnumerateW",
      "WinStationEnumerate_IndexedA",
      "WinStationEnumerate_IndexedW",
      "WinStationFreeConsoleNotification",
      "WinStationFreeEXECENVDATAEX",
      "WinStationFreeGAPMemory",
      "WinStationFreeMemory",
      "WinStationFreePropertyValue",
      "WinStationFreeUserCertificates",
      "WinStationFreeUserCredentials",
      "WinStationFreeUserSessionInfo",
      "WinStationGenerateLicense",
      "WinStationGetAllProcesses",
      "WinStationGetAllSessionsEx",
      "WinStationGetAllSessionsW",
      "WinStationGetAllUserSessions",
      "WinStationGetChildSessionId",
      "WinStationGetConnectionProperty",
      "WinStationGetCurrentSessionCapabilities",
      "WinStationGetCurrentSessionConnectionProperty",
      "WinStationGetCurrentSessionTerminalName",
      "WinStationGetDeviceId",
      "WinStationGetInitialApplication",
      "WinStationGetLanAdapterNameA",
      "WinStationGetLanAdapterNameW",
      "WinStationGetLastWinlogonNotification",
      "WinStationGetLoggedOnCount",
      "WinStationGetMachinePolicy",
      "WinStationGetParentSessionId",
      "WinStationGetProcessSid",
      "WinStationGetRedirectAuthInfo",
      "WinStationGetRestrictedLogonInfo",
      "WinStationGetSessionIds",
      "WinStationGetTermSrvCountersValue",
      "WinStationGetUserCertificates",
      "WinStationGetUserCredentials",
      "WinStationGetUserProfile",
      "WinStationInstallLicense",
      "WinStationIsBoundToCacheTerminal",
      "WinStationIsChildSessionsEnabled",
      "WinStationIsCurrentSessionRemoteable",
      "WinStationIsHelpAssistantSession",
      "WinStationIsSessionPermitted",
      "WinStationIsSessionRemoteable",
      "WinStationNameFromLogonIdA",
      "WinStationNameFromLogonIdW",
      "WinStationNegotiateSession",
      "WinStationNtsdDebug",
      "WinStationOpenServerA",
      "WinStationOpenServerExA",
      "WinStationOpenServerExW",
      "WinStationOpenServerW",
      "WinStationPreCreateGlassReplacementSession",
      "WinStationPreCreateGlassReplacementSessionEx",
      "WinStationQueryAllowConcurrentConnections",
      "WinStationQueryCurrentSessionInformation",
      "WinStationQueryEnforcementCore",
      "WinStationQueryInformationA",
      "WinStationQueryInformationW",
      "WinStationQueryLicense",
      "WinStationQueryLogonCredentialsW",
      "WinStationQuerySessionVirtualIP",
      "WinStationQueryUpdateRequired",
      "WinStationRcmShadow2",
      "WinStationRedirectErrorMessage",
      "WinStationRedirectLogonBeginPainting",
      "WinStationRedirectLogonError",
      "WinStationRedirectLogonMessage",
      "WinStationRedirectLogonStatus",
      "WinStationRegisterConsoleNotification",
      "WinStationRegisterConsoleNotificationEx",
      "WinStationRegisterConsoleNotificationEx2",
      "WinStationRegisterCurrentSessionNotificationEvent",
      "WinStationRegisterNotificationEvent",
      "WinStationRemoveLicense",
      "WinStationRenameA",
      "WinStationRenameW",
      "WinStationReportLoggedOnCompleted",
      "WinStationReportUIResult",
      "WinStationReset",
      "WinStationRevertFromServicesSession",
      "WinStationSendMessageA",
      "WinStationSendMessageW",
      "WinStationSendWindowMessage",
      "WinStationServerPing",
      "WinStationSetAutologonPassword",
      "WinStationSetInformationA",
      "WinStationSetInformationW",
      "WinStationSetLastWinlogonNotification",
      "WinStationSetPoolCount",
      "WinStationSetRenderHint",
      "WinStationShadow",
      "WinStationShadowAccessCheck",
      "WinStationShadowStop",
      "WinStationShadowStop2",
      "WinStationShutdownSystem",
      "WinStationSwitchToServicesSession",
      "WinStationSystemShutdownStarted",
      "WinStationSystemShutdownWait",
      "WinStationTerminateGlassReplacementSession",
      "WinStationTerminateProcess",
      "WinStationUnRegisterConsoleNotification",
      "WinStationUnRegisterNotificationEvent",
      "WinStationUserLoginAccessCheck",
      "WinStationVerify",
      "WinStationVirtualOpen",
      "WinStationVirtualOpenEx",
      "WinStationWaitSystemEvent",
      "_NWLogonQueryAdmin",
      "_NWLogonSetAdmin",
      "_WinStationAnnoyancePopup",
      "_WinStationBeepOpen",
      "_WinStationBreakPoint",
      "_WinStationCallback",
      "_WinStationCheckForApplicationName",
      "_WinStationFUSCanRemoteUserDisconnect",
      "_WinStationGetApplicationInfo",
      "_WinStationNotifyDisconnectPipe",
      "_WinStationNotifyLogoff",
      "_WinStationNotifyLogon",
      "_WinStationNotifyNewSession",
      "_WinStationOpenSessionDirectory",
      "_WinStationReInitializeSecurity",
      "_WinStationReadRegistry",
      "_WinStationSessionInitialized",
      "_WinStationShadowTarget",
      "_WinStationShadowTarget2",
      "_WinStationShadowTargetSetup",
      "_WinStationUpdateClientCachedCredentials",
      "_WinStationUpdateSettings",
      "_WinStationUpdateUserConfig",
      "_WinStationWaitForConnect"
    ]
  },
  "hashes": {
    "sha2": "8d642d993b9dcb4b5b8227e21fec8d2a84a7c0bd012633678b65b57b7abb9a0b",
    "ssdeep": "6144:R5xOiKtD6uHBztqYkoXWGvS4oymlgX1LUrd21pOK6YtHt91HhX9d+K7:R63+GzHkoXWGvBoPgX2wHhKK7"
  },
  "intent": {
    "intentions": 4,
    "uniq_apis_matched": 6,
    "results": [
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 1,
        "apis": [
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Has Ability To Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      },
      {
        "intent": "Has Ability To Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "Memory",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 1,
        "apis": [
          "RegOpenKeyExW"
        ]
      }
    ]
  }
}