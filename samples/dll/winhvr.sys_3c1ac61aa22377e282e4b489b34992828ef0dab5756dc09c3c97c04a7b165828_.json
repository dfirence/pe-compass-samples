{
  "name": "winhvr.sys",
  "path": "\\\\?\\C:\\Windows\\System32\\drivers\\winhvr.sys",
  "size": 96056,
  "is_64": true,
  "is_lib": false,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 1,
  "subsystem_caption": "Device Drivers And Native Windows processes",
  "libs": [
    "ntoskrnl.exe"
  ],
  "imports": [
    {
      "lib": "ntoskrnl.exe",
      "count": 93,
      "functions": [
        "ExAcquireFastMutex",
        "ExAcquirePushLockExclusiveEx",
        "ExAcquireRundownProtection",
        "ExAcquireSpinLockExclusive",
        "ExAcquireSpinLockShared",
        "ExAllocatePoolWithTag",
        "ExAllocateTimer",
        "ExBlockOnAddressPushLock",
        "ExDeleteNPagedLookasideList",
        "ExDeleteTimer",
        "ExFreePoolWithTag",
        "ExInitializeNPagedLookasideList",
        "ExInitializeRundownProtection",
        "ExQueryDepthSList",
        "ExReleaseFastMutex",
        "ExReleasePushLockExclusiveEx",
        "ExReleaseRundownProtection",
        "ExReleaseSpinLockExclusive",
        "ExReleaseSpinLockShared",
        "ExRundownCompleted",
        "ExSetTimer",
        "ExTryAcquirePushLockExclusiveEx",
        "ExUnblockOnAddressPushLockEx",
        "ExWaitForRundownProtectionRelease",
        "ExpInterlockedPopEntrySList",
        "ExpInterlockedPushEntrySList",
        "HviGetHypervisorFeatures",
        "HviIsAnyHypervisorPresent",
        "HviIsHypervisorMicrosoftCompatible",
        "HvlInvokeFastExtendedHypercall",
        "HvlInvokeHypercall",
        "HvlRegisterInterruptCallback",
        "HvlUnregisterInterruptCallback",
        "IoCreateDriver",
        "IoDeleteDriver",
        "IoRegisterDriverReinitialization",
        "KeAcquireSpinLockAtDpcLevel",
        "KeAcquireSpinLockRaiseToDpc",
        "KeDelayExecutionThread",
        "KeGenericCallDpc",
        "KeGetProcessorIndexFromNumber",
        "KeGetProcessorNumberFromIndex",
        "KeInitializeDpc",
        "KeInitializeEvent",
        "KeInitializeSpinLock",
        "KeInsertQueueDpc",
        "KeLowerIrql",
        "KePrepareToDispatchVirtualProcessor",
        "KeQueryActiveProcessorCountEx",
        "KeQueryGroupAffinity",
        "KeQueryHighestNodeNumber",
        "KeQueryInterruptTimePrecise",
        "KeQueryMaximumProcessorCountEx",
        "KeQueryNodeActiveAffinity",
        "KeQueryPriorityThread",
        "KeQueryTimeIncrement",
        "KeQueryTotalCycleTimeThread",
        "KeReleaseSpinLock",
        "KeReleaseSpinLockFromDpcLevel",
        "KeRevertToUserGroupAffinityThread",
        "KeSetActualBasePriorityThread",
        "KeSetEvent",
        "KeSetSystemGroupAffinityThread",
        "KeSetTargetProcessorDpcEx",
        "KeSignalCallDpcDone",
        "KeWaitForMultipleObjects",
        "KfRaiseIrql",
        "MmAllocateContiguousNodeMemory",
        "MmAllocateNodePagesForMdlEx",
        "MmAllocatePagesForMdlEx",
        "MmFreeContiguousMemory",
        "MmFreePagesFromMdl",
        "MmGetPhysicalAddress",
        "MmMapIoSpaceEx",
        "MmUnmapIoSpace",
        "ORDINAL 6",
        "PsIsThreadTerminating",
        "RtlClearAllBits",
        "RtlCopyUnicodeString",
        "RtlDeleteElementGenericTable",
        "RtlGetVersion",
        "RtlInitializeBitMap",
        "RtlInitializeGenericTable",
        "RtlInsertElementGenericTable",
        "RtlSetBit",
        "RtlTestBit",
        "ZwClose",
        "ZwOpenKey",
        "ZwQuerySystemInformation",
        "ZwQueryValueKey",
        "ZwSetSystemInformation",
        "ZwYieldExecution",
        "__C_specific_handler"
      ]
    }
  ],
  "exports": {
    "count": 160,
    "functions": [
      "DllInitialize",
      "DllUnload",
      "DriverEntry",
      "WinHvAcceptGpaPages",
      "WinHvAcquireSparseGpaPageHostAccess",
      "WinHvAcquireSparseSpaPageHostAccess",
      "WinHvAllocateOverlayPages",
      "WinHvAllocatePartitionSintIndex",
      "WinHvAllocatePortId",
      "WinHvAllocateSingleSintIndex",
      "WinHvAssertDeviceInterrupt",
      "WinHvAssertVirtualInterrupt",
      "WinHvAttachDevice",
      "WinHvAttachDeviceRemote",
      "WinHvCancelRestorePartitionState",
      "WinHvCancelSavePartitionState",
      "WinHvCancelVpDispatchLoop",
      "WinHvCheckForIoIntercept",
      "WinHvCheckSparseGpaPageVtlAccess",
      "WinHvClearVirtualInterrupt",
      "WinHvCompleteIntercept",
      "WinHvConfigureProfiler",
      "WinHvConnectPort",
      "WinHvControlHypervisorIptTrace",
      "WinHvCreateCpuGroup",
      "WinHvCreateEventLogBuffer",
      "WinHvCreateIptBuffers",
      "WinHvCreatePartition",
      "WinHvCreatePartitionRemote",
      "WinHvCreatePort",
      "WinHvCreateVp",
      "WinHvDeleteCpuGroup",
      "WinHvDeleteEventLogBuffer",
      "WinHvDeleteIptBuffers",
      "WinHvDeletePartition",
      "WinHvDeletePartitionRemote",
      "WinHvDeletePort",
      "WinHvDeleteVp",
      "WinHvDepositMemory",
      "WinHvDepositMemoryFromMdl",
      "WinHvDepositMemoryFromMdlRemote",
      "WinHvDetachDevice",
      "WinHvDetachDeviceRemote",
      "WinHvDisablePartitionVtl",
      "WinHvDisableVpVtl",
      "WinHvDisconnectDoorbell",
      "WinHvDisconnectPort",
      "WinHvEnablePartitionVtl",
      "WinHvEnableVpVtl",
      "WinHvFinalizeEventLogBufferGroup",
      "WinHvFinalizePartition",
      "WinHvFlushEventLogBuffer",
      "WinHvForceSmallPages",
      "WinHvFreeOverlayPages",
      "WinHvFreePartitionSintIndex",
      "WinHvFreePortId",
      "WinHvFreeSingleSintIndex",
      "WinHvGetCpuGroupAffinity",
      "WinHvGetCpuGroupProperty",
      "WinHvGetCurrentVpIndex",
      "WinHvGetGpaPagesAccessState",
      "WinHvGetLocalInterruptControllerState",
      "WinHvGetLogicalProcessorProperty",
      "WinHvGetLogicalProcessorRegisters",
      "WinHvGetLogicalProcessorRunTime",
      "WinHvGetMemoryBalance",
      "WinHvGetNextChildPartition",
      "WinHvGetNextCpuGroup",
      "WinHvGetNextCpuGroupPartition",
      "WinHvGetNextQueuedPort",
      "WinHvGetPartitionId",
      "WinHvGetPartitionProperty",
      "WinHvGetPortProperty",
      "WinHvGetSintEventFlags",
      "WinHvGetSintMessage",
      "WinHvGetSystemInformation",
      "WinHvGetVpRegisters",
      "WinHvGetXsaveData",
      "WinHvInitializeEventLogBufferGroup",
      "WinHvInjectSyntheticMachineCheckEvent",
      "WinHvInstallIntercept",
      "WinHvLookupPortId",
      "WinHvLowMemoryPolicyAutoDeposit",
      "WinHvLowMemoryPolicyReturnStatus",
      "WinHvMapDeviceInterrupt",
      "WinHvMapDeviceInterruptEx",
      "WinHvMapEventLogBuffer",
      "WinHvMapGpaPages",
      "WinHvMapGpaPagesFromMbpArray",
      "WinHvMapGpaPagesFromMbpArrayScanLargePages",
      "WinHvMapGpaPagesFromMbpArrayScanLargePagesRemote",
      "WinHvMapGpaPagesScanLargePages",
      "WinHvMapGpaPagesScanLargePagesRemote",
      "WinHvMapGpaPagesSpecial",
      "WinHvMapSparseGpaPages",
      "WinHvMapStatsPage",
      "WinHvMapVpStatePage",
      "WinHvModifySparseGpaPages",
      "WinHvModifySparseGpaPagesFromMbpArray",
      "WinHvModifyVtlProtectionMask",
      "WinHvModifyVtlProtectionMaskRange",
      "WinHvNotifyStandbyTransition",
      "WinHvNtProcessorToVpIndex",
      "WinHvPostMessage",
      "WinHvPrecommitGpaPages",
      "WinHvProcessorIndexToLpIndex",
      "WinHvProcessorNumberToVpIndex",
      "WinHvQueryDeviceInterruptTarget",
      "WinHvQueryInterceptIrql",
      "WinHvQueryLoaderInterface",
      "WinHvQueryReferenceCounter",
      "WinHvQueryVtlProtectionMaskRange",
      "WinHvReadGpa",
      "WinHvRegisterInterceptResult",
      "WinHvReleaseEventLogBuffer",
      "WinHvReleaseSparseGpaPageHostAccess",
      "WinHvReleaseSparseSpaPageHostAccess",
      "WinHvReportPresentHypervisor",
      "WinHvReserveDeviceInterrupt",
      "WinHvReserveDeviceInterruptRemote",
      "WinHvRestorePartitionState",
      "WinHvRunVpDispatchLoop",
      "WinHvSavePartitionState",
      "WinHvScrubPartition",
      "WinHvSetCpuGroupProperty",
      "WinHvSetDispatchNotificationEvent",
      "WinHvSetEndOfMessage",
      "WinHvSetEventLogCompletedNotificationRoutine",
      "WinHvSetEventLogGranularSources",
      "WinHvSetEventLogGroupSources",
      "WinHvSetHvDebugProperty",
      "WinHvSetInterceptRoutine",
      "WinHvSetLocalInterruptControllerState",
      "WinHvSetLogicalProcessorProperty",
      "WinHvSetLogicalProcessorRegisters",
      "WinHvSetLowMemoryPolicyRoutine",
      "WinHvSetPartitionProperty",
      "WinHvSetPortProperty",
      "WinHvSetSchedulerAssistData",
      "WinHvSetSchedulerNotificationRoutine",
      "WinHvSetSint",
      "WinHvSetSintOnCurrentProcessor",
      "WinHvSetSyntheticInterruptHandler",
      "WinHvSetSystemInformation",
      "WinHvSetVpRegisters",
      "WinHvSetXsaveData",
      "WinHvSignalEvent",
      "WinHvTranslateVirtualAddress",
      "WinHvUncommitGpaPages",
      "WinHvUnlinkPreExistingPartition",
      "WinHvUnmapDeviceInterrupt",
      "WinHvUnmapEventLogBuffer",
      "WinHvUnmapGpaPages",
      "WinHvUnmapStatsPage",
      "WinHvUnmapVpStatePage",
      "WinHvUnregisterInterceptResult",
      "WinHvUpdateHvProcessorFeatures",
      "WinHvWithdrawAllMemory",
      "WinHvWithdrawMemory",
      "WinHvWriteGpa"
    ]
  },
  "hashes": {
    "sha2": "3c1ac61aa22377e282e4b489b34992828ef0dab5756dc09c3c97c04a7b165828",
    "ssdeep": "1536:AildDGF+Krg4DhKmiy5QVpRYAWlGDZ8cCsFoFZgXNe8JcMzRZRAbEW4tb91aJ7O4:AmNoDopmisJMzRZ2bEz27OMRp"
  },
  "intent": {
    "intentions": 1,
    "uniq_apis_matched": 1,
    "results": [
      {
        "intent": "Queries and Discovers General Attributes From The Target System",
        "tag": "Discovery:T1082 - System Information Discovery",
        "component": "---",
        "inputs": 3,
        "matches": 1,
        "apis": [
          "RtlGetVersion"
        ]
      }
    ]
  }
}