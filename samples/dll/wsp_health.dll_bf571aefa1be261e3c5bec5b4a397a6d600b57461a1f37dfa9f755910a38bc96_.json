{
  "name": "wsp_health.dll",
  "path": "\\\\?\\C:\\Windows\\WinSxS\\wow64_microsoft-windows-wsp-health_31bf3856ad364e35_10.0.19041.1889_none_d9b4ef7e69098b46\\wsp_health.dll",
  "size": 1345376,
  "is_64": false,
  "is_lib": true,
  "is_dotnet": true,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "api-ms-win-core-com-l1-1-0.dll",
    "api-ms-win-core-console-l1-1-0.dll",
    "api-ms-win-core-debug-l1-1-0.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-fibers-l1-1-0.dll",
    "api-ms-win-core-file-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-heap-obsolete-l1-1-0.dll",
    "api-ms-win-core-interlocked-l1-1-0.dll",
    "api-ms-win-core-io-l1-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-libraryloader-l1-2-1.dll",
    "api-ms-win-core-localization-l1-2-0.dll",
    "api-ms-win-core-processenvironment-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-1.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-rtlsupport-l1-1-0.dll",
    "api-ms-win-core-string-l1-1-0.dll",
    "api-ms-win-core-synch-l1-1-0.dll",
    "api-ms-win-core-synch-l1-2-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-core-threadpool-l1-2-0.dll",
    "api-ms-win-core-threadpool-legacy-l1-1-0.dll",
    "api-ms-win-core-timezone-l1-1-0.dll",
    "api-ms-win-core-util-l1-1-0.dll",
    "api-ms-win-eventing-provider-l1-1-0.dll",
    "api-ms-win-security-base-l1-1-0.dll",
    "api-ms-win-security-lsalookup-l2-1-0.dll",
    "api-ms-win-security-provider-l1-1-0.dll",
    "api-ms-win-security-sddl-l1-1-0.dll",
    "clusapi.dll",
    "crypt32.dll",
    "cryptsp.dll",
    "mi.dll",
    "mispace.dll",
    "ntdll.dll",
    "oleaut32.dll",
    "resutils.dll",
    "sscore.dll",
    "ws2_32.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-core-io-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DeviceIoControl"
      ]
    },
    {
      "lib": "api-ms-win-core-console-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetConsoleMode",
        "GetConsoleOutputCP",
        "WriteConsoleW"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 3,
      "functions": [
        "RegCloseKey",
        "RegOpenKeyExW",
        "RegQueryValueExW"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 2,
      "functions": [
        "ORDINAL 2",
        "ORDINAL 6"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-0.dll",
      "count": 3,
      "functions": [
        "InitOnceExecuteOnce",
        "InitOnceInitialize",
        "Sleep"
      ]
    },
    {
      "lib": "cryptsp.dll",
      "count": 3,
      "functions": [
        "CryptAcquireContextW",
        "CryptGenRandom",
        "CryptReleaseContext"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-1-0.dll",
      "count": 21,
      "functions": [
        "AcquireSRWLockExclusive",
        "AcquireSRWLockShared",
        "CreateEventW",
        "CreateMutexExW",
        "CreateSemaphoreExW",
        "DeleteCriticalSection",
        "EnterCriticalSection",
        "InitializeCriticalSection",
        "InitializeCriticalSectionAndSpinCount",
        "InitializeCriticalSectionEx",
        "InitializeSRWLock",
        "LeaveCriticalSection",
        "OpenSemaphoreW",
        "ReleaseMutex",
        "ReleaseSRWLockExclusive",
        "ReleaseSRWLockShared",
        "ReleaseSemaphore",
        "ResetEvent",
        "SetEvent",
        "WaitForSingleObject",
        "WaitForSingleObjectEx"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 14,
      "functions": [
        "ExitProcess",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "GetStartupInfoW",
        "OpenProcessToken",
        "OpenThreadToken",
        "SetThreadToken",
        "TerminateProcess",
        "TlsAlloc",
        "TlsFree",
        "TlsGetValue",
        "TlsSetValue"
      ]
    },
    {
      "lib": "api-ms-win-core-localization-l1-2-0.dll",
      "count": 12,
      "functions": [
        "EnumSystemLocalesW",
        "FormatMessageA",
        "FormatMessageW",
        "GetACP",
        "GetCPInfo",
        "GetLocaleInfoW",
        "GetOEMCP",
        "GetUserDefaultLCID",
        "IsValidCodePage",
        "IsValidLocale",
        "LCMapStringEx",
        "LCMapStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-threadpool-l1-2-0.dll",
      "count": 11,
      "functions": [
        "CloseThreadpoolCleanupGroup",
        "CloseThreadpoolCleanupGroupMembers",
        "CloseThreadpoolTimer",
        "CloseThreadpoolWork",
        "CreateThreadpoolCleanupGroup",
        "CreateThreadpoolTimer",
        "CreateThreadpoolWork",
        "SetThreadpoolTimer",
        "SubmitThreadpoolWork",
        "WaitForThreadpoolTimerCallbacks",
        "WaitForThreadpoolWorkCallbacks"
      ]
    },
    {
      "lib": "mi.dll",
      "count": 2,
      "functions": [
        "MI_Application_InitializeV1",
        "mi_clientFT_V1"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-obsolete-l1-1-0.dll",
      "count": 1,
      "functions": [
        "LocalSize"
      ]
    },
    {
      "lib": "sscore.dll",
      "count": 1,
      "functions": [
        "SsCoreUninitialize"
      ]
    },
    {
      "lib": "api-ms-win-eventing-provider-l1-1-0.dll",
      "count": 5,
      "functions": [
        "EventActivityIdControl",
        "EventRegister",
        "EventSetInformation",
        "EventUnregister",
        "EventWriteTransfer"
      ]
    },
    {
      "lib": "api-ms-win-core-interlocked-l1-1-0.dll",
      "count": 4,
      "functions": [
        "InitializeSListHead",
        "InterlockedFlushSList",
        "InterlockedPopEntrySList",
        "InterlockedPushEntrySList"
      ]
    },
    {
      "lib": "api-ms-win-security-sddl-l1-1-0.dll",
      "count": 1,
      "functions": [
        "ConvertSidToStringSidW"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l1-1-0.dll",
      "count": 5,
      "functions": [
        "GetProcessHeap",
        "HeapAlloc",
        "HeapFree",
        "HeapReAlloc",
        "HeapSize"
      ]
    },
    {
      "lib": "api-ms-win-core-threadpool-legacy-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DeleteTimerQueueEx"
      ]
    },
    {
      "lib": "api-ms-win-security-provider-l1-1-0.dll",
      "count": 1,
      "functions": [
        "GetSecurityInfo"
      ]
    },
    {
      "lib": "crypt32.dll",
      "count": 2,
      "functions": [
        "CryptProtectMemory",
        "CryptUnprotectMemory"
      ]
    },
    {
      "lib": "api-ms-win-core-util-l1-1-0.dll",
      "count": 2,
      "functions": [
        "DecodePointer",
        "EncodePointer"
      ]
    },
    {
      "lib": "api-ms-win-core-debug-l1-1-0.dll",
      "count": 3,
      "functions": [
        "DebugBreak",
        "IsDebuggerPresent",
        "OutputDebugStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetComputerNameExW",
        "GetSystemDirectoryW",
        "GetSystemTimeAsFileTime",
        "GetTickCount64"
      ]
    },
    {
      "lib": "api-ms-win-core-fibers-l1-1-0.dll",
      "count": 4,
      "functions": [
        "FlsAlloc",
        "FlsFree",
        "FlsGetValue",
        "FlsSetValue"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 9,
      "functions": [
        "DisableThreadLibraryCalls",
        "FreeLibrary",
        "GetModuleFileNameA",
        "GetModuleFileNameW",
        "GetModuleHandleExW",
        "GetModuleHandleW",
        "GetProcAddress",
        "LoadLibraryExW",
        "LoadStringW"
      ]
    },
    {
      "lib": "api-ms-win-security-base-l1-1-0.dll",
      "count": 6,
      "functions": [
        "CopySid",
        "DuplicateTokenEx",
        "GetLengthSid",
        "GetTokenInformation",
        "ImpersonateLoggedOnUser",
        "IsValidSid"
      ]
    },
    {
      "lib": "api-ms-win-core-file-l1-1-0.dll",
      "count": 9,
      "functions": [
        "CreateFileW",
        "FileTimeToLocalFileTime",
        "FindClose",
        "FindFirstFileExW",
        "FindNextFileW",
        "FlushFileBuffers",
        "GetFileType",
        "SetFilePointerEx",
        "WriteFile"
      ]
    },
    {
      "lib": "api-ms-win-core-rtlsupport-l1-1-0.dll",
      "count": 1,
      "functions": [
        "RtlUnwind"
      ]
    },
    {
      "lib": "resutils.dll",
      "count": 1,
      "functions": [
        "ResUtilGetResourceName"
      ]
    },
    {
      "lib": "api-ms-win-core-string-l1-1-0.dll",
      "count": 6,
      "functions": [
        "CompareStringEx",
        "CompareStringOrdinal",
        "CompareStringW",
        "GetStringTypeW",
        "MultiByteToWideChar",
        "WideCharToMultiByte"
      ]
    },
    {
      "lib": "api-ms-win-core-timezone-l1-1-0.dll",
      "count": 1,
      "functions": [
        "FileTimeToSystemTime"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 2,
      "functions": [
        "CloseHandle",
        "DuplicateHandle"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 5,
      "functions": [
        "GetLastError",
        "RaiseException",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 11,
      "functions": [
        "NtQuerySystemInformation",
        "RtlDeleteElementGenericTableAvl",
        "RtlEnumerateGenericTableAvl",
        "RtlEnumerateGenericTableWithoutSplayingAvl",
        "RtlInitializeGenericTableAvl",
        "RtlInsertElementGenericTableAvl",
        "RtlIpv4StringToAddressExW",
        "RtlIpv6StringToAddressExW",
        "RtlLookupElementGenericTableAvl",
        "RtlNtStatusToDosError",
        "RtlRemoveVectoredExceptionHandler"
      ]
    },
    {
      "lib": "api-ms-win-core-com-l1-1-0.dll",
      "count": 4,
      "functions": [
        "CoCreateInstance",
        "CoCreateInstanceEx",
        "CoInitializeEx",
        "CoUninitialize"
      ]
    },
    {
      "lib": "mispace.dll",
      "count": 13,
      "functions": [
        "WspCheckMinimumSubsystemVersion",
        "WspEnumerateRemoteInstances",
        "WspFreeString",
        "WspGetClassName",
        "WspGetRemoteInstance",
        "WspGetSubsystemFilter",
        "WspInvokeRemoteMethod",
        "WspIsRemoteInstance",
        "WspPackObjectId",
        "WspProviderEnter",
        "WspProviderExit",
        "WspReferencesOfRemoteInstance",
        "WspUnpackObjectId"
      ]
    },
    {
      "lib": "ws2_32.dll",
      "count": 4,
      "functions": [
        "ORDINAL 111",
        "ORDINAL 9",
        "WSAAddressToStringW",
        "WSAStringToAddressW"
      ]
    },
    {
      "lib": "api-ms-win-core-processthreads-l1-1-1.dll",
      "count": 1,
      "functions": [
        "IsProcessorFeaturePresent"
      ]
    },
    {
      "lib": "clusapi.dll",
      "count": 119,
      "functions": [
        "AddClusterNode",
        "AddClusterResourceDependency",
        "AddClusterResourceNode",
        "AddResourceToClusterSharedVolumes",
        "CCHlpAddNodeUpdateCluster",
        "CCHlpConfigureNode",
        "CCHlpCreateClusterNameInAD",
        "CCHlpGetClusterServiceSecret",
        "CCHlpGetDNSHostLabel",
        "CancelClusterGroupOperation",
        "ChangeClusterResourceGroup",
        "CloseCluster",
        "CloseClusterGroup",
        "CloseClusterNetInterface",
        "CloseClusterNetwork",
        "CloseClusterNode",
        "CloseClusterNotifyPort",
        "CloseClusterResource",
        "ClusterCloseEnum",
        "ClusterCloseEnumEx",
        "ClusterControl",
        "ClusterEnum",
        "ClusterEnumEx",
        "ClusterGetEnumCount",
        "ClusterGetEnumCountEx",
        "ClusterGroupCloseEnum",
        "ClusterGroupCloseEnumEx",
        "ClusterGroupControl",
        "ClusterGroupEnum",
        "ClusterGroupEnumEx",
        "ClusterGroupGetEnumCount",
        "ClusterGroupGetEnumCountEx",
        "ClusterGroupOpenEnum",
        "ClusterGroupOpenEnumEx",
        "ClusterNetInterfaceControl",
        "ClusterNetworkCloseEnum",
        "ClusterNetworkControl",
        "ClusterNetworkEnum",
        "ClusterNetworkGetEnumCount",
        "ClusterNetworkOpenEnum",
        "ClusterNodeCloseEnumEx",
        "ClusterNodeControl",
        "ClusterNodeEnumEx",
        "ClusterNodeGetEnumCountEx",
        "ClusterNodeOpenEnumEx",
        "ClusterOpenEnum",
        "ClusterOpenEnumEx",
        "ClusterRegCloseKey",
        "ClusterRegQueryValue",
        "ClusterRegSetValue",
        "ClusterResourceCloseEnum",
        "ClusterResourceCloseEnumEx",
        "ClusterResourceControl",
        "ClusterResourceEnum",
        "ClusterResourceEnumEx",
        "ClusterResourceGetEnumCount",
        "ClusterResourceGetEnumCountEx",
        "ClusterResourceOpenEnum",
        "ClusterResourceOpenEnumEx",
        "ClusterResourceTypeCloseEnum",
        "ClusterResourceTypeControl",
        "ClusterResourceTypeEnum",
        "ClusterResourceTypeGetEnumCount",
        "ClusterResourceTypeOpenEnum",
        "ClusterUpgradeFunctionalLevel",
        "CreateCluster",
        "CreateClusterGroupEx",
        "CreateClusterNotifyPortV2",
        "CreateClusterResource",
        "CreateClusterResourceType",
        "DeleteClusterGroup",
        "DeleteClusterResource",
        "DeleteClusterResourceType",
        "DestroyCluster",
        "DestroyClusterGroup",
        "EvictClusterNodeEx",
        "FailClusterResource",
        "GetClusterFromResource",
        "GetClusterGroupState",
        "GetClusterInformation",
        "GetClusterKey",
        "GetClusterNetInterfaceState",
        "GetClusterNetworkState",
        "GetClusterNodeKey",
        "GetClusterNodeState",
        "GetClusterNotifyV2",
        "GetClusterQuorumResource",
        "GetClusterResourceDependencyExpression",
        "GetClusterResourceKey",
        "GetClusterResourceState",
        "GetNodeClusterState",
        "MoveClusterGroup",
        "MoveClusterGroupEx",
        "OfflineClusterGroupEx",
        "OfflineClusterResourceEx",
        "OnlineClusterGroupEx",
        "OnlineClusterResourceEx",
        "OpenClusterEx",
        "OpenClusterGroupEx",
        "OpenClusterNetInterfaceEx",
        "OpenClusterNetworkEx",
        "OpenClusterNode",
        "OpenClusterNodeEx",
        "OpenClusterResource",
        "OpenClusterResourceEx",
        "PauseClusterNodeEx",
        "RegisterClusterResourceTypeNotifyV2",
        "RemoveClusterResourceDependency",
        "RemoveClusterResourceNode",
        "RemoveResourceFromClusterSharedVolumes",
        "RestartClusterResource",
        "ResumeClusterNodeEx",
        "SetClusterGroupName",
        "SetClusterGroupNodeList",
        "SetClusterName",
        "SetClusterNetworkName",
        "SetClusterQuorumResource",
        "SetClusterResourceDependencyExpression",
        "SetClusterResourceName"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-1.dll",
      "count": 1,
      "functions": [
        "LoadLibraryW"
      ]
    },
    {
      "lib": "api-ms-win-security-lsalookup-l2-1-0.dll",
      "count": 1,
      "functions": [
        "LookupAccountSidW"
      ]
    },
    {
      "lib": "api-ms-win-core-processenvironment-l1-1-0.dll",
      "count": 6,
      "functions": [
        "FreeEnvironmentStringsW",
        "GetCommandLineA",
        "GetCommandLineW",
        "GetEnvironmentStringsW",
        "GetStdHandle",
        "SetStdHandle"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 2,
      "functions": [
        "QueryPerformanceCounter",
        "QueryPerformanceFrequency"
      ]
    }
  ],
  "exports": {
    "count": 10,
    "functions": [
      "DllCanUnloadNow",
      "DllGetClassObject",
      "DllMain",
      "DllRegisterServer",
      "DllUnregisterServer",
      "GetProviderClassID",
      "MI_Main",
      "PreShutdown",
      "SetShutdownCallback",
      "SmpUnload"
    ]
  },
  "hashes": {
    "sha2": "bf571aefa1be261e3c5bec5b4a397a6d600b57461a1f37dfa9f755910a38bc96",
    "ssdeep": "24576:Xrf8a2n/TAi843zl4jaqTqoPGR2tI5cEEI:XrU2HaqGf2IGEEI"
  },
  "intent": {
    "intentions": 7,
    "uniq_apis_matched": 9,
    "results": [
      {
        "intent": "Creates Token To Impersonate",
        "tag": "Privilege Escalation:T1134.003 - Make and Impersonate Token",
        "component": "Privileges",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "SetThreadToken"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileExW"
        ]
      },
      {
        "intent": "Has Ability To Work With The TCP Network Protocol",
        "tag": "Expert Input:IBO.00012 - Network TCP Sockets",
        "component": "Networking",
        "inputs": 15,
        "matches": 2,
        "apis": [
          "WSAAddressToStringW",
          "WSAStringToAddressW"
        ]
      },
      {
        "intent": "Has Ability To Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 2,
        "apis": [
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      },
      {
        "intent": "Steals Tokens To Impersonate Windows Identities",
        "tag": "Privilege Escalation:T1134.001 - Token Impersonation/Theft",
        "component": "Privileges",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "ImpersonateLoggedOnUser"
        ]
      },
      {
        "intent": "Has Ability To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 1,
        "apis": [
          "RegOpenKeyExW"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 1,
        "apis": [
          "RegQueryValueExW"
        ]
      }
    ]
  }
}