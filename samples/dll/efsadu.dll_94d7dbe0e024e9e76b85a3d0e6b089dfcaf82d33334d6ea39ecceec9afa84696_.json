{
  "name": "efsadu.dll",
  "path": "\\\\?\\C:\\Windows\\System32\\efsadu.dll",
  "size": 133120,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 2,
  "subsystem_caption": "The Windows Graphical User Interface (GUI) Subsystem",
  "libs": [
    "advapi32.dll",
    "api-ms-win-core-com-l1-1-0.dll",
    "api-ms-win-core-debug-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-0.dll",
    "api-ms-win-core-delayload-l1-1-1.dll",
    "api-ms-win-core-errorhandling-l1-1-0.dll",
    "api-ms-win-core-file-l1-1-0.dll",
    "api-ms-win-core-handle-l1-1-0.dll",
    "api-ms-win-core-heap-l1-1-0.dll",
    "api-ms-win-core-heap-l2-1-0.dll",
    "api-ms-win-core-libraryloader-l1-2-0.dll",
    "api-ms-win-core-libraryloader-l1-2-1.dll",
    "api-ms-win-core-localization-l1-2-0.dll",
    "api-ms-win-core-processenvironment-l1-1-0.dll",
    "api-ms-win-core-processthreads-l1-1-0.dll",
    "api-ms-win-core-profile-l1-1-0.dll",
    "api-ms-win-core-registry-l1-1-0.dll",
    "api-ms-win-core-rtlsupport-l1-1-0.dll",
    "api-ms-win-core-synch-l1-1-0.dll",
    "api-ms-win-core-synch-l1-2-0.dll",
    "api-ms-win-core-sysinfo-l1-1-0.dll",
    "api-ms-win-eventing-provider-l1-1-0.dll",
    "api-ms-win-security-base-l1-1-0.dll",
    "api-ms-win-security-credentials-l1-1-0.dll",
    "api-ms-win-service-management-l1-1-0.dll",
    "api-ms-win-service-management-l2-1-0.dll",
    "credui.dll",
    "crypt32.dll",
    "cryptui.dll",
    "dsrole.dll",
    "efsutil.dll",
    "feclient.dll",
    "kernel32.dll",
    "logoncli.dll",
    "mfc42u.dll",
    "msvcrt.dll",
    "netutils.dll",
    "ntdll.dll",
    "ole32.dll",
    "oleaut32.dll",
    "rpcrt4.dll",
    "shell32.dll",
    "shlwapi.dll",
    "urlmon.dll",
    "user32.dll",
    "userenv.dll",
    "vaultcli.dll",
    "wldap32.dll"
  ],
  "imports": [
    {
      "lib": "api-ms-win-core-processthreads-l1-1-0.dll",
      "count": 8,
      "functions": [
        "CreateThread",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThread",
        "GetCurrentThreadId",
        "OpenProcessToken",
        "OpenThreadToken",
        "TerminateProcess"
      ]
    },
    {
      "lib": "api-ms-win-security-base-l1-1-0.dll",
      "count": 5,
      "functions": [
        "CheckTokenMembership",
        "CopySid",
        "EqualSid",
        "GetLengthSid",
        "GetTokenInformation"
      ]
    },
    {
      "lib": "urlmon.dll",
      "count": 1,
      "functions": [
        "CreateUri"
      ]
    },
    {
      "lib": "api-ms-win-core-com-l1-1-0.dll",
      "count": 5,
      "functions": [
        "CoCreateInstance",
        "CoInitializeEx",
        "CoTaskMemAlloc",
        "CoTaskMemFree",
        "CoUninitialize"
      ]
    },
    {
      "lib": "shlwapi.dll",
      "count": 2,
      "functions": [
        "ORDINAL 278",
        "StrDupW"
      ]
    },
    {
      "lib": "api-ms-win-service-management-l1-1-0.dll",
      "count": 3,
      "functions": [
        "CloseServiceHandle",
        "OpenSCManagerW",
        "OpenServiceW"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 30,
      "functions": [
        "??0exception@@QEAA@AEBV0@@Z",
        "??0exception@@QEAA@XZ",
        "??1exception@@UEAA@XZ",
        "??1type_info@@UEAA@XZ",
        "??_V@YAXPEAX@Z",
        "_CxxThrowException",
        "_XcptFilter",
        "__C_specific_handler",
        "__CxxFrameHandler3",
        "__dllonexit",
        "_amsg_exit",
        "_initterm",
        "_lock",
        "_ltow_s",
        "_onexit",
        "_unlock",
        "_vsnprintf_s",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "free",
        "malloc",
        "memcmp",
        "memcpy",
        "memcpy_s",
        "memmove",
        "memset",
        "strcmp",
        "toupper",
        "wcsncmp"
      ]
    },
    {
      "lib": "crypt32.dll",
      "count": 21,
      "functions": [
        "CertAddCertificateContextToStore",
        "CertAddCertificateLinkToStore",
        "CertCloseStore",
        "CertCreateCertificateContext",
        "CertEnumCertificatesInStore",
        "CertFindCertificateInStore",
        "CertFindExtension",
        "CertFreeCertificateChain",
        "CertFreeCertificateContext",
        "CertGetCertificateChain",
        "CertGetCertificateContextProperty",
        "CertGetEnhancedKeyUsage",
        "CertGetNameStringW",
        "CertOpenStore",
        "CertSetCertificateContextProperty",
        "CertVerifyCertificateChainPolicy",
        "CertVerifyTimeValidity",
        "CryptBinaryToStringW",
        "CryptDecodeObject",
        "CryptEncodeObjectEx",
        "CryptStringToBinaryW"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 4,
      "functions": [
        "NtQueryInformationToken",
        "RtlAllocateAndInitializeSid",
        "RtlFreeSid",
        "RtlNtStatusToDosError"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l1-1-0.dll",
      "count": 3,
      "functions": [
        "GetProcessHeap",
        "HeapAlloc",
        "HeapFree"
      ]
    },
    {
      "lib": "advapi32.dll",
      "count": 16,
      "functions": [
        "AddUsersToEncryptedFile",
        "ConvertStringSidToSidW",
        "CryptSetProvParam",
        "EncryptFileW",
        "EventWriteTransfer",
        "FreeEncryptionCertificateHashList",
        "LsaClose",
        "LsaFreeMemory",
        "LsaLookupSids",
        "LsaOpenPolicy",
        "QueryRecoveryAgentsOnEncryptedFile",
        "QueryUsersOnEncryptedFile",
        "RegGetValueW",
        "RemoveUsersFromEncryptedFile",
        "SetUserFileEncryptionKeyEx",
        "UsePinForEncryptedFilesW"
      ]
    },
    {
      "lib": "cryptui.dll",
      "count": 2,
      "functions": [
        "CryptUIDlgSelectCertificateW",
        "CryptUIWizExport"
      ]
    },
    {
      "lib": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetSystemTimeAsFileTime",
        "GetTickCount"
      ]
    },
    {
      "lib": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "count": 4,
      "functions": [
        "GetLastError",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "lib": "efsutil.dll",
      "count": 11,
      "functions": [
        "EfsUtilApplyGroupPolicy",
        "EfsUtilCheckCurrentKeyCapabilities",
        "EfsUtilCreateSelfSignedCertificate",
        "EfsUtilGetCertContextFromCertHash",
        "EfsUtilGetCurrentKey",
        "EfsUtilGetCurrentUserInformation",
        "EfsUtilGetSmartcardProviderName",
        "EfsUtilGetUserKey",
        "EfsUtilReleaseUserKey",
        "EfsUtilSetSmartcardPin",
        "EfsUtilSmartcardCredsNeededError"
      ]
    },
    {
      "lib": "api-ms-win-core-profile-l1-1-0.dll",
      "count": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "lib": "api-ms-win-core-heap-l2-1-0.dll",
      "count": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "lib": "logoncli.dll",
      "count": 1,
      "functions": [
        "DsGetDcNameW"
      ]
    },
    {
      "lib": "ole32.dll",
      "count": 1,
      "functions": [
        "CoInitialize"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-1-0.dll",
      "count": 10,
      "functions": [
        "AcquireSRWLockExclusive",
        "CreateMutexExW",
        "CreateSemaphoreExW",
        "OpenEventW",
        "OpenSemaphoreW",
        "ReleaseMutex",
        "ReleaseSRWLockExclusive",
        "ReleaseSemaphore",
        "WaitForSingleObject",
        "WaitForSingleObjectEx"
      ]
    },
    {
      "lib": "netutils.dll",
      "count": 1,
      "functions": [
        "NetApiBufferFree"
      ]
    },
    {
      "lib": "api-ms-win-core-file-l1-1-0.dll",
      "count": 5,
      "functions": [
        "FindClose",
        "FindFirstFileExW",
        "FindNextFileW",
        "GetFileAttributesW",
        "GetFullPathNameW"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 13,
      "functions": [
        "ActivateActCtx",
        "CreateActCtxW",
        "DeactivateActCtx",
        "DeleteCriticalSection",
        "EnterCriticalSection",
        "FindActCtxSectionStringW",
        "FreeLibrary",
        "GetComputerNameW",
        "InitializeCriticalSection",
        "LeaveCriticalSection",
        "LoadLibraryExW",
        "QueryActCtxW",
        "lstrlenW"
      ]
    },
    {
      "lib": "api-ms-win-service-management-l2-1-0.dll",
      "count": 1,
      "functions": [
        "ChangeServiceConfigW"
      ]
    },
    {
      "lib": "api-ms-win-core-handle-l1-1-0.dll",
      "count": 1,
      "functions": [
        "CloseHandle"
      ]
    },
    {
      "lib": "vaultcli.dll",
      "count": 4,
      "functions": [
        "VaultCloseVault",
        "VaultFree",
        "VaultGetItem",
        "VaultOpenVault"
      ]
    },
    {
      "lib": "rpcrt4.dll",
      "count": 5,
      "functions": [
        "RpcStringFreeW",
        "UuidCreate",
        "UuidCreateNil",
        "UuidFromStringW",
        "UuidToStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-debug-l1-1-0.dll",
      "count": 4,
      "functions": [
        "DebugBreak",
        "IsDebuggerPresent",
        "OutputDebugStringA",
        "OutputDebugStringW"
      ]
    },
    {
      "lib": "api-ms-win-eventing-provider-l1-1-0.dll",
      "count": 6,
      "functions": [
        "EventEnabled",
        "EventProviderEnabled",
        "EventRegister",
        "EventSetInformation",
        "EventUnregister",
        "EventWrite"
      ]
    },
    {
      "lib": "api-ms-win-core-localization-l1-2-0.dll",
      "count": 4,
      "functions": [
        "FormatMessageW",
        "GetLocaleInfoEx",
        "GetUserPreferredUILanguages",
        "IdnToAscii"
      ]
    },
    {
      "lib": "user32.dll",
      "count": 14,
      "functions": [
        "DefWindowProcW",
        "DestroyWindow",
        "DispatchMessageW",
        "EnableWindow",
        "GetClientRect",
        "GetMessageW",
        "KillTimer",
        "LoadIconW",
        "MessageBoxW",
        "PostMessageW",
        "PostQuitMessage",
        "SendMessageW",
        "SetTimer",
        "TranslateMessage"
      ]
    },
    {
      "lib": "api-ms-win-core-processenvironment-l1-1-0.dll",
      "count": 2,
      "functions": [
        "GetCurrentDirectoryW",
        "SetCurrentDirectoryW"
      ]
    },
    {
      "lib": "shell32.dll",
      "count": 6,
      "functions": [
        "ORDINAL 155",
        "ORDINAL 190",
        "SHChangeNotifySuspendResume",
        "SHCreateItemFromParsingName",
        "SHGetFolderPathW",
        "Shell_NotifyIconW"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-0.dll",
      "count": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    },
    {
      "lib": "credui.dll",
      "count": 3,
      "functions": [
        "CredPackAuthenticationBufferW",
        "CredUIPromptForWindowsCredentialsW",
        "CredUnPackAuthenticationBufferW"
      ]
    },
    {
      "lib": "dsrole.dll",
      "count": 2,
      "functions": [
        "DsRoleFreeMemory",
        "DsRoleGetPrimaryDomainInformation"
      ]
    },
    {
      "lib": "userenv.dll",
      "count": 1,
      "functions": [
        "RefreshPolicy"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 3,
      "functions": [
        "ORDINAL 149",
        "ORDINAL 2",
        "ORDINAL 6"
      ]
    },
    {
      "lib": "api-ms-win-core-delayload-l1-1-1.dll",
      "count": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "count": 6,
      "functions": [
        "GetModuleFileNameA",
        "GetModuleFileNameW",
        "GetModuleHandleExW",
        "GetModuleHandleW",
        "GetProcAddress",
        "LoadStringW"
      ]
    },
    {
      "lib": "api-ms-win-core-registry-l1-1-0.dll",
      "count": 5,
      "functions": [
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegOpenKeyExW",
        "RegQueryValueExW",
        "RegSetValueExW"
      ]
    },
    {
      "lib": "api-ms-win-security-credentials-l1-1-0.dll",
      "count": 2,
      "functions": [
        "CredFree",
        "CredMarshalCredentialW"
      ]
    },
    {
      "lib": "feclient.dll",
      "count": 4,
      "functions": [
        "EfsClientFreeKeyInfo",
        "EfsClientFreeProtectorList",
        "EfsClientGetKeyInfo",
        "EfsClientQueryProtectors"
      ]
    },
    {
      "lib": "api-ms-win-core-libraryloader-l1-2-1.dll",
      "count": 1,
      "functions": [
        "LoadLibraryW"
      ]
    },
    {
      "lib": "api-ms-win-core-rtlsupport-l1-1-0.dll",
      "count": 3,
      "functions": [
        "RtlCaptureContext",
        "RtlLookupFunctionEntry",
        "RtlVirtualUnwind"
      ]
    },
    {
      "lib": "wldap32.dll",
      "count": 10,
      "functions": [
        "ORDINAL 13",
        "ORDINAL 140",
        "ORDINAL 16",
        "ORDINAL 170",
        "ORDINAL 18",
        "ORDINAL 208",
        "ORDINAL 224",
        "ORDINAL 26",
        "ORDINAL 41",
        "ORDINAL 73"
      ]
    },
    {
      "lib": "mfc42u.dll",
      "count": 126,
      "functions": [
        "ORDINAL 1040",
        "ORDINAL 1063",
        "ORDINAL 1067",
        "ORDINAL 1082",
        "ORDINAL 1126",
        "ORDINAL 1388",
        "ORDINAL 1416",
        "ORDINAL 1442",
        "ORDINAL 1463",
        "ORDINAL 1477",
        "ORDINAL 1491",
        "ORDINAL 1544",
        "ORDINAL 1553",
        "ORDINAL 1555",
        "ORDINAL 1577",
        "ORDINAL 1583",
        "ORDINAL 1585",
        "ORDINAL 1586",
        "ORDINAL 1736",
        "ORDINAL 1777",
        "ORDINAL 1778",
        "ORDINAL 2060",
        "ORDINAL 2140",
        "ORDINAL 2329",
        "ORDINAL 2399",
        "ORDINAL 2412",
        "ORDINAL 2457",
        "ORDINAL 2515",
        "ORDINAL 2517",
        "ORDINAL 2559",
        "ORDINAL 2586",
        "ORDINAL 2593",
        "ORDINAL 2629",
        "ORDINAL 2661",
        "ORDINAL 2670",
        "ORDINAL 2752",
        "ORDINAL 287",
        "ORDINAL 288",
        "ORDINAL 2906",
        "ORDINAL 2975",
        "ORDINAL 3046",
        "ORDINAL 3049",
        "ORDINAL 3052",
        "ORDINAL 3164",
        "ORDINAL 3166",
        "ORDINAL 3231",
        "ORDINAL 3243",
        "ORDINAL 3362",
        "ORDINAL 3366",
        "ORDINAL 337",
        "ORDINAL 3417",
        "ORDINAL 3468",
        "ORDINAL 3501",
        "ORDINAL 3535",
        "ORDINAL 355",
        "ORDINAL 3743",
        "ORDINAL 3761",
        "ORDINAL 3806",
        "ORDINAL 3916",
        "ORDINAL 3933",
        "ORDINAL 4017",
        "ORDINAL 4077",
        "ORDINAL 4082",
        "ORDINAL 4083",
        "ORDINAL 4191",
        "ORDINAL 4257",
        "ORDINAL 4365",
        "ORDINAL 4368",
        "ORDINAL 4371",
        "ORDINAL 4473",
        "ORDINAL 4548",
        "ORDINAL 4557",
        "ORDINAL 4598",
        "ORDINAL 4609",
        "ORDINAL 4694",
        "ORDINAL 4721",
        "ORDINAL 4741",
        "ORDINAL 4747",
        "ORDINAL 4752",
        "ORDINAL 4770",
        "ORDINAL 4771",
        "ORDINAL 4789",
        "ORDINAL 4815",
        "ORDINAL 4836",
        "ORDINAL 4983",
        "ORDINAL 4988",
        "ORDINAL 5065",
        "ORDINAL 5077",
        "ORDINAL 5229",
        "ORDINAL 5245",
        "ORDINAL 5406",
        "ORDINAL 5484",
        "ORDINAL 5586",
        "ORDINAL 5615",
        "ORDINAL 5663",
        "ORDINAL 5683",
        "ORDINAL 5687",
        "ORDINAL 5699",
        "ORDINAL 5702",
        "ORDINAL 5711",
        "ORDINAL 5712",
        "ORDINAL 5722",
        "ORDINAL 5724",
        "ORDINAL 5730",
        "ORDINAL 5887",
        "ORDINAL 6053",
        "ORDINAL 6071",
        "ORDINAL 626",
        "ORDINAL 6328",
        "ORDINAL 6351",
        "ORDINAL 6385",
        "ORDINAL 6437",
        "ORDINAL 6440",
        "ORDINAL 659",
        "ORDINAL 6614",
        "ORDINAL 6632",
        "ORDINAL 665",
        "ORDINAL 6812",
        "ORDINAL 6813",
        "ORDINAL 6814",
        "ORDINAL 6886",
        "ORDINAL 6887",
        "ORDINAL 812",
        "ORDINAL 822",
        "ORDINAL 852",
        "ORDINAL 912"
      ]
    },
    {
      "lib": "api-ms-win-core-synch-l1-2-0.dll",
      "count": 1,
      "functions": [
        "Sleep"
      ]
    }
  ],
  "exports": {
    "count": 14,
    "functions": [
      "AddUserToObjectW",
      "BackCurrentEfsCert",
      "EfsDetail",
      "EfsUIUtilCheckScardStatus",
      "EfsUIUtilCreateSelfSignedCertificate",
      "EfsUIUtilEncryptMyDocuments",
      "EfsUIUtilEnrollEfsCertificate",
      "EfsUIUtilEnrollEfsCertificateEx",
      "EfsUIUtilInstallDra",
      "EfsUIUtilKeyBackup",
      "EfsUIUtilPromptForPin",
      "EfsUIUtilPromptForPinDialog",
      "EfsUIUtilSelectCard",
      "EfsUIUtilShowBalloonAndWait"
    ]
  },
  "hashes": {
    "sha2": "94d7dbe0e024e9e76b85a3d0e6b089dfcaf82d33334d6ea39ecceec9afa84696",
    "ssdeep": "3072:bn5vQE4kVvGZ24kcx66/uNvERk3AXVUSaT6VhGqYNdaxzBNv:bn5vPuZ+cx66/uNvERWAXV71VhGqmezv"
  },
  "intent": {
    "intentions": 8,
    "uniq_apis_matched": 16,
    "results": [
      {
        "intent": "Discovers Configuration Attributes of the Windows Enterprise Domain",
        "tag": "Reconnaissance:T1590.001 - Domain Properties (Windows Enterprise)",
        "component": "---",
        "inputs": 24,
        "matches": 2,
        "apis": [
          "DsGetDcNameW",
          "DsRoleGetPrimaryDomainInformation"
        ]
      },
      {
        "intent": "Enumerates Files or Directories on the Target System",
        "tag": "Discovery:T1083 - File and Directory Discovery",
        "component": "Filesystem",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "FindFirstFileExW"
        ]
      },
      {
        "intent": "Can Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "---",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Can Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 3,
        "apis": [
          "RegCreateKeyExW",
          "RegOpenKeyExW",
          "RegSetValueExW"
        ]
      },
      {
        "intent": "Can Enumerate/Discover System Services And Their Configuration Data",
        "tag": "Expert Input:IBO.0006 - Enumerate System Services",
        "component": "Services",
        "inputs": 28,
        "matches": 2,
        "apis": [
          "OpenSCManagerW",
          "OpenServiceW"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 2,
        "apis": [
          "RegGetValueW",
          "RegQueryValueExW"
        ]
      },
      {
        "intent": "Can Access And Read Windows Tokens",
        "tag": "Expert Input:IBO.00020 - Windows Token Access",
        "component": "Privileges",
        "inputs": 4,
        "matches": 3,
        "apis": [
          "CheckTokenMembership",
          "OpenProcessToken",
          "OpenThreadToken"
        ]
      },
      {
        "intent": "Can Create/Manipulate System Services",
        "tag": "Expert Input:IBO.0007 - Create/Manipulate System Services",
        "component": "Services",
        "inputs": 19,
        "matches": 1,
        "apis": [
          "CloseServiceHandle"
        ]
      }
    ]
  }
}