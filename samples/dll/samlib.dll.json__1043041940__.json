{
  "pe_name": "samlib.dll",
  "pe_type": 523,
  "pe_size": 137728,
  "pe_subsystem": 3,
  "pe_subsystem_caption": "The Windows character (Cosole UI) subsystem",
  "pe_path": "c:\\Windows\\WinSxS\\amd64_microsoft-windows-directory-services-sam_31bf3856ad364e35_10.0.19041.1566_none_2693bd1f563e3860\\samlib.dll",
  "pe_timedate_stamp": 3522081054,
  "pe_timedate_human": "2081-08-10T19:50:54.000Z",
  "ImageDLLImports": [
    {
      "name": "api-ms-win-crt-string-l1-1-0.dll",
      "imports": 3,
      "functions": [
        "memset",
        "wcsncmp",
        "wcspbrk"
      ]
    },
    {
      "name": "api-ms-win-crt-runtime-l1-1-0.dll",
      "imports": 2,
      "functions": [
        "_initterm",
        "_initterm_e"
      ]
    },
    {
      "name": "api-ms-win-crt-private-l1-1-0.dll",
      "imports": 16,
      "functions": [
        "__C_specific_handler",
        "_o___std_type_info_destroy_list",
        "_o___stdio_common_vfwprintf",
        "_o__cexit",
        "_o__configure_narrow_argv",
        "_o__execute_onexit_table",
        "_o__initialize_narrow_environment",
        "_o__initialize_onexit_table",
        "_o__seh_filter_dll",
        "_o__wcsicmp",
        "_o__wcsnicmp",
        "_o__wfopen",
        "_o_fclose",
        "_o_fflush",
        "memcpy",
        "memmove"
      ]
    },
    {
      "name": "api-ms-win-eventing-classicprovider-l1-1-0.dll",
      "imports": 5,
      "functions": [
        "GetTraceEnableFlags",
        "GetTraceEnableLevel",
        "GetTraceLoggerHandle",
        "TraceMessage",
        "UnregisterTraceGuids"
      ]
    },
    {
      "name": "api-ms-win-core-libraryloader-l1-2-0.dll",
      "imports": 2,
      "functions": [
        "DisableThreadLibraryCalls",
        "GetModuleFileNameW"
      ]
    },
    {
      "name": "api-ms-win-core-errorhandling-l1-1-0.dll",
      "imports": 4,
      "functions": [
        "GetLastError",
        "SetLastError",
        "SetUnhandledExceptionFilter",
        "UnhandledExceptionFilter"
      ]
    },
    {
      "name": "api-ms-win-core-heap-l2-1-0.dll",
      "imports": 2,
      "functions": [
        "LocalAlloc",
        "LocalFree"
      ]
    },
    {
      "name": "api-ms-win-core-processthreads-l1-1-0.dll",
      "imports": 8,
      "functions": [
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "TerminateProcess",
        "TlsAlloc",
        "TlsFree",
        "TlsGetValue",
        "TlsSetValue"
      ]
    },
    {
      "name": "api-ms-win-core-sysinfo-l1-1-0.dll",
      "imports": 4,
      "functions": [
        "GetComputerNameExW",
        "GetLocalTime",
        "GetSystemTimeAsFileTime",
        "GetWindowsDirectoryW"
      ]
    },
    {
      "name": "api-ms-win-core-localization-l1-2-0.dll",
      "imports": 1,
      "functions": [
        "GetSystemPreferredUILanguages"
      ]
    },
    {
      "name": "api-ms-win-core-registry-l1-1-0.dll",
      "imports": 10,
      "functions": [
        "RegCloseKey",
        "RegCreateKeyExA",
        "RegCreateKeyExW",
        "RegDeleteKeyExA",
        "RegGetValueW",
        "RegOpenKeyExA",
        "RegOpenKeyExW",
        "RegQueryInfoKeyA",
        "RegQueryValueExW",
        "RegSetValueExA"
      ]
    },
    {
      "name": "api-ms-win-security-base-l1-1-0.dll",
      "imports": 4,
      "functions": [
        "GetLengthSid",
        "IsValidSid",
        "IsWellKnownSid",
        "RevertToSelf"
      ]
    },
    {
      "name": "api-ms-win-core-handle-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "CloseHandle"
      ]
    },
    {
      "name": "api-ms-win-core-string-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "GetStringTypeW"
      ]
    },
    {
      "name": "api-ms-win-core-profile-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "QueryPerformanceCounter"
      ]
    },
    {
      "name": "api-ms-win-core-interlocked-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "InitializeSListHead"
      ]
    },
    {
      "name": "api-ms-win-core-rtlsupport-l1-1-0.dll",
      "imports": 3,
      "functions": [
        "RtlCaptureContext",
        "RtlLookupFunctionEntry",
        "RtlVirtualUnwind"
      ]
    },
    {
      "name": "api-ms-win-core-debug-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "IsDebuggerPresent"
      ]
    },
    {
      "name": "api-ms-win-core-processthreads-l1-1-1.dll",
      "imports": 1,
      "functions": [
        "IsProcessorFeaturePresent"
      ]
    },
    {
      "name": "api-ms-win-eventing-obsolete-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "RegisterTraceGuidsA"
      ]
    },
    {
      "name": "ntdll.dll",
      "imports": 23,
      "functions": [
        "NtOpenThreadToken",
        "NtQueryInformationToken",
        "NtSetInformationThread",
        "RtlAllocateAndInitializeSid",
        "RtlCopySid",
        "RtlDeleteCriticalSection",
        "RtlEnterCriticalSection",
        "RtlEqualComputerName",
        "RtlEqualUnicodeString",
        "RtlFreeHeap",
        "RtlGetNtProductType",
        "RtlInitUnicodeString",
        "RtlInitializeCriticalSection",
        "RtlLeaveCriticalSection",
        "RtlLengthRequiredSid",
        "RtlLengthSid",
        "RtlMakeSelfRelativeSD",
        "RtlNtStatusToDosError",
        "RtlSubAuthorityCountSid",
        "RtlSubAuthoritySid",
        "RtlUnicodeStringToInteger",
        "RtlUpcaseUnicodeStringToOemString",
        "RtlValidSid"
      ]
    },
    {
      "name": "api-ms-win-core-delayload-l1-1-1.dll",
      "imports": 1,
      "functions": [
        "ResolveDelayLoadedAPI"
      ]
    },
    {
      "name": "api-ms-win-core-delayload-l1-1-0.dll",
      "imports": 1,
      "functions": [
        "DelayLoadFailureHook"
      ]
    }
  ],
  "ImageDLLExports": {
    "exports": 70,
    "functions": [
      "OnMachineUILanguageInit",
      "SamAddMemberToAlias",
      "SamAddMemberToGroup",
      "SamAddMultipleMembersToAlias",
      "SamChangePasswordUser",
      "SamChangePasswordUser2",
      "SamCloseHandle",
      "SamConnect",
      "SamConnectWithCreds",
      "SamCreateAliasInDomain",
      "SamCreateGroupInDomain",
      "SamCreateUser2InDomain",
      "SamCreateUserInDomain",
      "SamDeleteAlias",
      "SamDeleteGroup",
      "SamDeleteUser",
      "SamEnumerateAliasesInDomain",
      "SamEnumerateDomainsInSamServer",
      "SamEnumerateGroupsInDomain",
      "SamEnumerateUsersInDomain",
      "SamEnumerateUsersInDomain2",
      "SamFreeMemory",
      "SamGetAliasMembership",
      "SamGetCompatibilityMode",
      "SamGetDisplayEnumerationIndex",
      "SamGetGroupsForUser",
      "SamGetMembersInAlias",
      "SamGetMembersInGroup",
      "SamLookupDomainInSamServer",
      "SamLookupIdsInDomain",
      "SamLookupNamesInDomain",
      "SamLookupNamesInDomain2",
      "SamOpenAlias",
      "SamOpenDomain",
      "SamOpenGroup",
      "SamOpenUser",
      "SamPerformGenericOperation",
      "SamQueryDisplayInformation",
      "SamQueryInformationAlias",
      "SamQueryInformationDomain",
      "SamQueryInformationGroup",
      "SamQueryInformationUser",
      "SamQueryLocalizableAccountsInDomain",
      "SamQuerySecurityObject",
      "SamRegisterObjectChangeNotification",
      "SamRemoveMemberFromAlias",
      "SamRemoveMemberFromForeignDomain",
      "SamRemoveMemberFromGroup",
      "SamRemoveMultipleMembersFromAlias",
      "SamRidToSid",
      "SamSetInformationAlias",
      "SamSetInformationDomain",
      "SamSetInformationGroup",
      "SamSetInformationUser",
      "SamSetMemberAttributesOfGroup",
      "SamSetSecurityObject",
      "SamShutdownSamServer",
      "SamTestPrivateFunctionsDomain",
      "SamTestPrivateFunctionsUser",
      "SamUnregisterObjectChangeNotification",
      "SamValidatePassword",
      "SamiChangeKeys",
      "SamiChangePasswordUser",
      "SamiChangePasswordUser2",
      "SamiEncryptPasswords",
      "SamiLmChangePasswordUser",
      "SamiSetBootKeyInformation",
      "SamiSetDSRMPassword",
      "SamiSetDSRMPasswordOWF",
      "SamiSyncDSRMPasswordFromAccount"
    ]
  },
  "ImageHashSignatures": {
    "sha2": "23d4ab264e36e19ae1da7cfd7c98c85a6dd2de036a5af976a7177486df02906a"
  },
  "scan": {
    "intentions": 4,
    "uniq_apis_matched": 12,
    "results": [
      {
        "intent": "Query and Discovery General Attributes From The Target System",
        "tag": "Discovery:T1082 - System Information Discovery",
        "component": "---",
        "inputs": 3,
        "matches": 1,
        "apis": [
          "RtlGetNtProductType"
        ]
      },
      {
        "intent": "Implements Delayed Loads of DLL Resources",
        "tag": "Expert Input:IBO.0005 - Load DLL Resources With Delay During Runtime",
        "component": "---",
        "inputs": 2,
        "matches": 2,
        "apis": [
          "DelayLoadFailureHook",
          "ResolveDelayLoadedAPI"
        ]
      },
      {
        "intent": "Implements Features To Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.0008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 6,
        "apis": [
          "RegCreateKeyExA",
          "RegCreateKeyExW",
          "RegDeleteKeyExA",
          "RegOpenKeyExA",
          "RegOpenKeyExW",
          "RegSetValueExA"
        ]
      },
      {
        "intent": "Query And Discover Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 3,
        "apis": [
          "RegGetValueW",
          "RegQueryInfoKeyA",
          "RegQueryValueExW"
        ]
      }
    ]
  }
}