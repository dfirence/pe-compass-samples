{
  "name": "dafmigplugin.dll",
  "path": "\\\\?\\C:\\Windows\\System32\\migration\\dafmigplugin.dll",
  "size": 252240,
  "is_64": true,
  "is_lib": true,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 3,
  "subsystem_caption": "The Windows Character (Console UI) Subsystem",
  "libs": [
    "advapi32.dll",
    "kernel32.dll",
    "msvcrt.dll",
    "ntdll.dll",
    "ole32.dll",
    "oleaut32.dll",
    "shell32.dll",
    "user32.dll"
  ],
  "imports": [
    {
      "lib": "ole32.dll",
      "count": 7,
      "functions": [
        "CoCreateInstance",
        "CoTaskMemAlloc",
        "CoTaskMemFree",
        "CoTaskMemRealloc",
        "PropVariantClear",
        "StringFromCLSID",
        "StringFromGUID2"
      ]
    },
    {
      "lib": "oleaut32.dll",
      "count": 22,
      "functions": [
        "ORDINAL 149",
        "ORDINAL 150",
        "ORDINAL 16",
        "ORDINAL 161",
        "ORDINAL 162",
        "ORDINAL 163",
        "ORDINAL 17",
        "ORDINAL 18",
        "ORDINAL 186",
        "ORDINAL 19",
        "ORDINAL 2",
        "ORDINAL 20",
        "ORDINAL 200",
        "ORDINAL 23",
        "ORDINAL 24",
        "ORDINAL 25",
        "ORDINAL 26",
        "ORDINAL 277",
        "ORDINAL 411",
        "ORDINAL 6",
        "ORDINAL 7",
        "ORDINAL 77"
      ]
    },
    {
      "lib": "msvcrt.dll",
      "count": 36,
      "functions": [
        "??1type_info@@UEAA@XZ",
        "_CxxThrowException",
        "_XcptFilter",
        "__C_specific_handler",
        "__dllonexit",
        "_amsg_exit",
        "_callnewh",
        "_errno",
        "_initterm",
        "_lock",
        "_onexit",
        "_purecall",
        "_ultow_s",
        "_unlock",
        "_vsnwprintf",
        "_wcsicmp",
        "_wcsnicmp",
        "_wtoi64",
        "free",
        "malloc",
        "memcmp",
        "memcpy",
        "memcpy_s",
        "memmove",
        "memmove_s",
        "memset",
        "realloc",
        "swprintf_s",
        "wcscat_s",
        "wcschr",
        "wcscmp",
        "wcscpy_s",
        "wcsncmp",
        "wcsncpy_s",
        "wcsrchr",
        "wcstoul"
      ]
    },
    {
      "lib": "shell32.dll",
      "count": 1,
      "functions": [
        "SHGetFileInfoW"
      ]
    },
    {
      "lib": "kernel32.dll",
      "count": 50,
      "functions": [
        "CloseHandle",
        "CreateEventW",
        "CreateFileW",
        "DelayLoadFailureHook",
        "DeleteCriticalSection",
        "DeleteFileW",
        "EnterCriticalSection",
        "FindResourceExW",
        "FreeLibrary",
        "GetCurrentProcess",
        "GetCurrentProcessId",
        "GetCurrentThreadId",
        "GetFileSize",
        "GetLastError",
        "GetModuleFileNameW",
        "GetModuleHandleExW",
        "GetModuleHandleW",
        "GetProcAddress",
        "GetProcessHeap",
        "GetSystemTimeAsFileTime",
        "GetThreadLocale",
        "GetTickCount",
        "HeapAlloc",
        "HeapDestroy",
        "HeapFree",
        "HeapReAlloc",
        "HeapSize",
        "InitializeCriticalSection",
        "LeaveCriticalSection",
        "LoadLibraryExA",
        "LoadLibraryExW",
        "LoadResource",
        "LocalFree",
        "LockResource",
        "MultiByteToWideChar",
        "OutputDebugStringA",
        "QueryPerformanceCounter",
        "RaiseException",
        "ReadFile",
        "ResetEvent",
        "SetEvent",
        "SetThreadLocale",
        "SetUnhandledExceptionFilter",
        "SizeofResource",
        "Sleep",
        "TerminateProcess",
        "UnhandledExceptionFilter",
        "WaitForSingleObject",
        "WriteFile",
        "lstrcmpiW"
      ]
    },
    {
      "lib": "advapi32.dll",
      "count": 15,
      "functions": [
        "ConvertSecurityDescriptorToStringSecurityDescriptorW",
        "ConvertStringSecurityDescriptorToSecurityDescriptorW",
        "EventRegister",
        "EventUnregister",
        "EventWriteTransfer",
        "RegCloseKey",
        "RegCreateKeyExW",
        "RegDeleteValueW",
        "RegEnumKeyExW",
        "RegEnumKeyW",
        "RegGetValueW",
        "RegOpenKeyExW",
        "RegQueryInfoKeyW",
        "RegSetValueExW",
        "TraceMessage"
      ]
    },
    {
      "lib": "user32.dll",
      "count": 2,
      "functions": [
        "CharNextW",
        "UnregisterClassA"
      ]
    },
    {
      "lib": "ntdll.dll",
      "count": 66,
      "functions": [
        "LdrGetDllHandle",
        "LdrGetProcedureAddress",
        "NtAdjustPrivilegesToken",
        "NtClose",
        "NtCreateKey",
        "NtDeleteKey",
        "NtDeleteValueKey",
        "NtDuplicateToken",
        "NtEnumerateKey",
        "NtEnumerateValueKey",
        "NtOpenKey",
        "NtOpenProcessToken",
        "NtOpenProcessTokenEx",
        "NtOpenThreadToken",
        "NtOpenThreadTokenEx",
        "NtQueryInformationToken",
        "NtQueryKey",
        "NtQuerySecurityObject",
        "NtQueryValueKey",
        "NtSetInformationThread",
        "NtSetSecurityObject",
        "NtSetValueKey",
        "RtlAbsoluteToSelfRelativeSD",
        "RtlAcquireSRWLockExclusive",
        "RtlAddAccessAllowedAceEx",
        "RtlAddAce",
        "RtlAllocateHeap",
        "RtlAppendUnicodeStringToString",
        "RtlCaptureContext",
        "RtlCompareMemory",
        "RtlConvertSidToUnicodeString",
        "RtlCopySid",
        "RtlCreateAcl",
        "RtlCreateSecurityDescriptor",
        "RtlCreateUnicodeString",
        "RtlEqualSid",
        "RtlEqualUnicodeString",
        "RtlFormatCurrentUserKeyPath",
        "RtlFreeHeap",
        "RtlFreeUnicodeString",
        "RtlGUIDFromString",
        "RtlGetDaclSecurityDescriptor",
        "RtlGetGroupSecurityDescriptor",
        "RtlGetOwnerSecurityDescriptor",
        "RtlGetSaclSecurityDescriptor",
        "RtlGetVersion",
        "RtlInitAnsiString",
        "RtlInitUnicodeString",
        "RtlInitUnicodeStringEx",
        "RtlInitializeSRWLock",
        "RtlInitializeSid",
        "RtlLengthSecurityDescriptor",
        "RtlLengthSid",
        "RtlLookupFunctionEntry",
        "RtlPrefixUnicodeString",
        "RtlReleaseSRWLockExclusive",
        "RtlSetDaclSecurityDescriptor",
        "RtlSetGroupSecurityDescriptor",
        "RtlSetOwnerSecurityDescriptor",
        "RtlSubAuthoritySid",
        "RtlTimeToTimeFields",
        "RtlUnicodeStringToInteger",
        "RtlValidRelativeSecurityDescriptor",
        "RtlValidSecurityDescriptor",
        "RtlValidSid",
        "RtlVirtualUnwind"
      ]
    }
  ],
  "exports": {
    "count": 5,
    "functions": [
      "DllCanUnloadNow",
      "DllGetClassObject",
      "DllMain",
      "DllRegisterServer",
      "DllUnregisterServer"
    ]
  },
  "hashes": {
    "sha2": "834959e961544368b678d2789d17d853db6641d5a25c1c88d08ba90aeabe1ab2",
    "ssdeep": "6144:NVK/WGzz+XLrMDrJFhgFNxyp3v1c4x7hx8A:NV2zzoAJFhg9SUA"
  },
  "intent": {
    "intentions": 9,
    "uniq_apis_matched": 14,
    "results": [
      {
        "intent": "Can Delay Loading of DLLs Until Runtime/Process Execution",
        "tag": "Expert Input:IBO.005 - Load DLL Resources With Delay During Runtime",
        "component": "Memory",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DelayLoadFailureHook"
        ]
      },
      {
        "intent": "Can Enumerate The Windows Registry",
        "tag": "Expert Input:IBO.009 - Enumerate The Windows Registry",
        "component": "Registry",
        "inputs": 6,
        "matches": 2,
        "apis": [
          "RegEnumKeyExW",
          "RegEnumKeyW"
        ]
      },
      {
        "intent": "Queries and Discovers General Attributes From The Target System",
        "tag": "Discovery:T1082 - System Information Discovery",
        "component": "---",
        "inputs": 3,
        "matches": 1,
        "apis": [
          "RtlGetVersion"
        ]
      },
      {
        "intent": "Manipulates Windows Tokens",
        "tag": "Defense Evasion:T1134 - Access Token Manipulation",
        "component": "Privileges",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "NtAdjustPrivilegesToken"
        ]
      },
      {
        "intent": "Deletes Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity",
        "tag": "Defense Evasion:T1070.004 - File Deletion",
        "component": "Filesystem",
        "inputs": 2,
        "matches": 1,
        "apis": [
          "DeleteFileW"
        ]
      },
      {
        "intent": "Queries And Discovers Windows Registry Configuration Settings",
        "tag": "Discovery:T1012 - Query Registry",
        "component": "Registry",
        "inputs": 11,
        "matches": 2,
        "apis": [
          "RegGetValueW",
          "RegQueryInfoKeyW"
        ]
      },
      {
        "intent": "Can Terminate Processes On The Target System",
        "tag": "Expert Input:IBO.0025",
        "component": "Processes",
        "inputs": 1,
        "matches": 1,
        "apis": [
          "TerminateProcess"
        ]
      },
      {
        "intent": "Steals Tokens To Impersonate Windows Identities",
        "tag": "Privilege Escalation:T1134.001 - Token Impersonation/Theft",
        "component": "Privileges",
        "inputs": 5,
        "matches": 1,
        "apis": [
          "NtDuplicateToken"
        ]
      },
      {
        "intent": "Can Create/Manipulate The Windows Registry",
        "tag": "Expert Input:IBO.008 - Create/Manipulate The Windows Registry",
        "component": "Registry",
        "inputs": 33,
        "matches": 4,
        "apis": [
          "RegCreateKeyExW",
          "RegDeleteValueW",
          "RegOpenKeyExW",
          "RegSetValueExW"
        ]
      }
    ]
  }
}