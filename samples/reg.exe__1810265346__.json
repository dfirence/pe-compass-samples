{"pe_name":"reg.exe","pe_type":523,"pe_size":77312,"pe_subsystem":3,"pe_subsystem_caption":"The Windows Character (Console UI) Subsystem","pe_path":"pe-samples/lolbas/reg.exe","pe_timedate_stamp":3694933746,"pe_timedate_human":"2087-02-01T10:29:06.000Z","ImageDLLImports":[{"name":"msvcrt.dll","imports":27,"functions":["?terminate@@YAXXZ","_XcptFilter","__C_specific_handler","__iob_func","__set_app_type","__setusermatherr","__wgetmainargs","_amsg_exit","_cexit","_commode","_errno","_exit","_fileno","_fmode","_get_osfhandle","_initterm","_memicmp","_resetstkoflw","_vsnwprintf","_wcstoui64","exit","fflush","fgetwc","fprintf","memset","wcstol","wcstoul"]},{"name":"api-ms-win-core-registry-l1-1-0.dll","imports":17,"functions":["RegCloseKey","RegCreateKeyExW","RegDeleteKeyExW","RegDeleteValueW","RegEnumKeyExW","RegEnumValueW","RegFlushKey","RegGetValueW","RegLoadKeyW","RegOpenKeyExW","RegQueryInfoKeyW","RegQueryValueExW","RegRestoreKeyW","RegSaveKeyExW","RegSetValueExA","RegSetValueExW","RegUnLoadKeyW"]},{"name":"api-ms-win-core-errorhandling-l1-1-0.dll","imports":4,"functions":["GetLastError","SetLastError","SetUnhandledExceptionFilter","UnhandledExceptionFilter"]},{"name":"api-ms-win-core-file-l1-2-0.dll","imports":1,"functions":["GetTempPathW"]},{"name":"api-ms-win-core-file-l1-1-0.dll","imports":8,"functions":["CreateFileW","DeleteFileW","GetFileSize","GetFileType","GetTempFileNameW","ReadFile","SetFilePointer","WriteFile"]},{"name":"api-ms-win-core-heap-l2-1-0.dll","imports":3,"functions":["LocalAlloc","LocalFree","LocalReAlloc"]},{"name":"api-ms-win-core-processthreads-l1-1-0.dll","imports":6,"functions":["ExitProcess","GetCurrentProcess","GetCurrentProcessId","GetCurrentThreadId","OpenProcessToken","TerminateProcess"]},{"name":"api-ms-win-core-handle-l1-1-0.dll","imports":1,"functions":["CloseHandle"]},{"name":"api-ms-win-core-file-l2-1-2.dll","imports":1,"functions":["CopyFileW"]},{"name":"api-ms-win-security-base-l1-1-0.dll","imports":1,"functions":["AdjustTokenPrivileges"]},{"name":"api-ms-win-security-lsalookup-l2-1-0.dll","imports":1,"functions":["LookupPrivilegeValueW"]},{"name":"api-ms-win-core-processenvironment-l1-1-0.dll","imports":2,"functions":["GetStdHandle","SearchPathW"]},{"name":"api-ms-win-core-string-l2-1-0.dll","imports":3,"functions":["CharNextW","CharUpperW","IsCharAlphaNumericW"]},{"name":"api-ms-win-core-string-l1-1-0.dll","imports":3,"functions":["CompareStringW","MultiByteToWideChar","WideCharToMultiByte"]},{"name":"api-ms-win-core-debug-l1-1-0.dll","imports":1,"functions":["OutputDebugStringW"]},{"name":"api-ms-win-core-synch-l1-2-0.dll","imports":1,"functions":["Sleep"]},{"name":"api-ms-win-core-rtlsupport-l1-1-0.dll","imports":3,"functions":["RtlCaptureContext","RtlLookupFunctionEntry","RtlVirtualUnwind"]},{"name":"api-ms-win-core-libraryloader-l1-2-0.dll","imports":2,"functions":["GetModuleHandleW","LoadStringW"]},{"name":"api-ms-win-core-profile-l1-1-0.dll","imports":1,"functions":["QueryPerformanceCounter"]},{"name":"api-ms-win-core-sysinfo-l1-1-0.dll","imports":2,"functions":["GetSystemTimeAsFileTime","GetTickCount"]},{"name":"api-ms-win-core-registry-l2-1-0.dll","imports":5,"functions":["RegConnectRegistryW","RegEnumKeyW","RegOpenKeyW","RegSaveKeyW","RegSetValueW"]},{"name":"api-ms-win-core-shlwapi-obsolete-l1-1-0.dll","imports":5,"functions":["StrChrIW","StrChrW","StrDupW","StrStrIW","StrToIntW"]},{"name":"api-ms-win-core-string-obsolete-l1-1-0.dll","imports":2,"functions":["lstrcmpW","lstrlenW"]},{"name":"ntdll.dll","imports":2,"functions":["NtQueryKey","NtSetInformationKey"]},{"name":"api-ms-win-core-localization-l1-2-0.dll","imports":3,"functions":["FormatMessageW","GetThreadLocale","SetThreadUILanguage"]},{"name":"ws2_32.dll","imports":0,"functions":[]},{"name":"api-ms-win-core-console-l1-1-0.dll","imports":3,"functions":["GetConsoleMode","GetConsoleOutputCP","WriteConsoleW"]},{"name":"api-ms-win-core-heap-l1-1-0.dll","imports":6,"functions":["GetProcessHeap","HeapAlloc","HeapFree","HeapReAlloc","HeapSize","HeapValidate"]}],"ImageDLLExports":{"exports":0,"functions":[]},"ImageHashSignatures":{"sha2":"c0e25b1f9b22de445298c1e96ddfcead265ca030fa6626f61a4a4786cc4a3b7d","ssdeep":"1536:/ZsKjopjN/cYXsuMdCAOznsA5q+oxxhRO+sAg9RyTVZiJXpnvo/vrK:FW5nspdCbzpq+iLcqjWXpvo/vm"},"scan":{"intentions":7,"uniq_apis_matched":19,"results":[{"intent":"Implements Features For User CLI Experience","tag":"Expert Input:IBO.0001 - Accepts CommandLine Arguments","component":"Processes","inputs":3,"matches":1,"apis":["__wgetmainargs"]},{"intent":"Implements Features To Enumerate The Windows Registry","tag":"Expert Input:IBO.0009 - Enumerate The Windows Registry","component":"Registry","inputs":6,"matches":3,"apis":["RegEnumKeyExW","RegEnumKeyW","RegEnumValueW"]},{"intent":"Delete Files From Disk Potentially Erasing Important Evidence To Cover Attack Activity","tag":"Defense Evasion:T1070.004 - File Deletion","component":"Filesystem","inputs":2,"matches":1,"apis":["DeleteFileW"]},{"intent":"Implements Features To Remotely Connect To A Target System And Access Its Windows Registry","tag":"Expert Input:IBO.00010 - Connect To Remote Windows Registry","component":"Networking","inputs":2,"matches":1,"apis":["RegConnectRegistryW"]},{"intent":"Implements Features To Create/Manipulate The Windows Registry","tag":"Expert Input:IBO.0008 - Create/Manipulate The Windows Registry","component":"Registry","inputs":33,"matches":8,"apis":["RegCreateKeyExW","RegDeleteKeyExW","RegDeleteValueW","RegOpenKeyExW","RegOpenKeyW","RegSetValueExA","RegSetValueExW","RegSetValueW"]},{"intent":"Query And Discover Windows Registry Configuration Settings","tag":"Discovery:T1012 - Query Registry","component":"Registry","inputs":11,"matches":3,"apis":["RegGetValueW","RegQueryInfoKeyW","RegQueryValueExW"]},{"intent":"Manipulate Windows Tokens","tag":"Defense Evasion:T1134 - Access Token Manipulation","component":"Privileges","inputs":10,"matches":2,"apis":["AdjustTokenPrivileges","OpenProcessToken"]}]},"paths":["pe-samples/lolbas/reg.exe"]}